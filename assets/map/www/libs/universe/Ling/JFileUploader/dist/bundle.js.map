{"version":3,"file":"bundle.js","sources":["../../../../../../node_modules/svelte/internal/index.mjs","../../../../../../node_modules/js-extension-ling/index.js","../../../../../../node_modules/panda-headers/index.js","../src/modules/Validator.js","../src/modules/GlobalProgressTracker.js","../../../../../../node_modules/translatee/index.js","../../../../../../node_modules/js-dropzone-handler/index.js","../../../../../../node_modules/chunk-uploader/index.js","../../../../../../node_modules/atoa/atoa.js","../../../../../../node_modules/ticky/ticky-browser.js","../../../../../../node_modules/contra/debounce.js","../../../../../../node_modules/contra/emitter.js","../../../../../../node_modules/custom-event/index.js","../../../../../../node_modules/crossvent/src/eventmap.js","../../../../../../node_modules/crossvent/src/crossvent.js","../../../../../../node_modules/dragula/classes.js","../../../../../../node_modules/dragula/dragula.js","../../../../../../node_modules/svelte/transition/index.mjs","../../../../../../node_modules/svelte/store/index.mjs","../../../../../../node_modules/svelte-action-draggable/draggable.js","../../../../../../node_modules/svelte-mymodal/src/Component.svelte","../../../../../../node_modules/cropperjs/dist/cropper.js","../src/components/DefaultFileEditor.svelte","../src/DefaultFileUploader.svelte","../src/index.js"],"sourcesContent":["function noop() { }\nconst identity = x => x;\nfunction assign(tar, src) {\n    // @ts-ignore\n    for (const k in src)\n        tar[k] = src[k];\n    return tar;\n}\nfunction is_promise(value) {\n    return value && typeof value === 'object' && typeof value.then === 'function';\n}\nfunction add_location(element, file, line, column, char) {\n    element.__svelte_meta = {\n        loc: { file, line, column, char }\n    };\n}\nfunction run(fn) {\n    return fn();\n}\nfunction blank_object() {\n    return Object.create(null);\n}\nfunction run_all(fns) {\n    fns.forEach(run);\n}\nfunction is_function(thing) {\n    return typeof thing === 'function';\n}\nfunction safe_not_equal(a, b) {\n    return a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');\n}\nfunction not_equal(a, b) {\n    return a != a ? b == b : a !== b;\n}\nfunction validate_store(store, name) {\n    if (store != null && typeof store.subscribe !== 'function') {\n        throw new Error(`'${name}' is not a store with a 'subscribe' method`);\n    }\n}\nfunction subscribe(store, ...callbacks) {\n    if (store == null) {\n        return noop;\n    }\n    const unsub = store.subscribe(...callbacks);\n    return unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\nfunction get_store_value(store) {\n    let value;\n    subscribe(store, _ => value = _)();\n    return value;\n}\nfunction component_subscribe(component, store, callback) {\n    component.$$.on_destroy.push(subscribe(store, callback));\n}\nfunction create_slot(definition, ctx, $$scope, fn) {\n    if (definition) {\n        const slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n        return definition[0](slot_ctx);\n    }\n}\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n    return definition[1] && fn\n        ? assign($$scope.ctx.slice(), definition[1](fn(ctx)))\n        : $$scope.ctx;\n}\nfunction get_slot_changes(definition, $$scope, dirty, fn) {\n    if (definition[2] && fn) {\n        const lets = definition[2](fn(dirty));\n        if ($$scope.dirty === undefined) {\n            return lets;\n        }\n        if (typeof lets === 'object') {\n            const merged = [];\n            const len = Math.max($$scope.dirty.length, lets.length);\n            for (let i = 0; i < len; i += 1) {\n                merged[i] = $$scope.dirty[i] | lets[i];\n            }\n            return merged;\n        }\n        return $$scope.dirty | lets;\n    }\n    return $$scope.dirty;\n}\nfunction exclude_internal_props(props) {\n    const result = {};\n    for (const k in props)\n        if (k[0] !== '$')\n            result[k] = props[k];\n    return result;\n}\nfunction compute_rest_props(props, keys) {\n    const rest = {};\n    keys = new Set(keys);\n    for (const k in props)\n        if (!keys.has(k) && k[0] !== '$')\n            rest[k] = props[k];\n    return rest;\n}\nfunction once(fn) {\n    let ran = false;\n    return function (...args) {\n        if (ran)\n            return;\n        ran = true;\n        fn.call(this, ...args);\n    };\n}\nfunction null_to_empty(value) {\n    return value == null ? '' : value;\n}\nfunction set_store_value(store, ret, value = ret) {\n    store.set(value);\n    return ret;\n}\nconst has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\nfunction action_destroyer(action_result) {\n    return action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\n\nconst is_client = typeof window !== 'undefined';\nlet now = is_client\n    ? () => window.performance.now()\n    : () => Date.now();\nlet raf = is_client ? cb => requestAnimationFrame(cb) : noop;\n// used internally for testing\nfunction set_now(fn) {\n    now = fn;\n}\nfunction set_raf(fn) {\n    raf = fn;\n}\n\nconst tasks = new Set();\nfunction run_tasks(now) {\n    tasks.forEach(task => {\n        if (!task.c(now)) {\n            tasks.delete(task);\n            task.f();\n        }\n    });\n    if (tasks.size !== 0)\n        raf(run_tasks);\n}\n/**\n * For testing purposes only!\n */\nfunction clear_loops() {\n    tasks.clear();\n}\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n */\nfunction loop(callback) {\n    let task;\n    if (tasks.size === 0)\n        raf(run_tasks);\n    return {\n        promise: new Promise(fulfill => {\n            tasks.add(task = { c: callback, f: fulfill });\n        }),\n        abort() {\n            tasks.delete(task);\n        }\n    };\n}\n\nfunction append(target, node) {\n    target.appendChild(node);\n}\nfunction insert(target, node, anchor) {\n    target.insertBefore(node, anchor || null);\n}\nfunction detach(node) {\n    node.parentNode.removeChild(node);\n}\nfunction destroy_each(iterations, detaching) {\n    for (let i = 0; i < iterations.length; i += 1) {\n        if (iterations[i])\n            iterations[i].d(detaching);\n    }\n}\nfunction element(name) {\n    return document.createElement(name);\n}\nfunction element_is(name, is) {\n    return document.createElement(name, { is });\n}\nfunction object_without_properties(obj, exclude) {\n    const target = {};\n    for (const k in obj) {\n        if (has_prop(obj, k)\n            // @ts-ignore\n            && exclude.indexOf(k) === -1) {\n            // @ts-ignore\n            target[k] = obj[k];\n        }\n    }\n    return target;\n}\nfunction svg_element(name) {\n    return document.createElementNS('http://www.w3.org/2000/svg', name);\n}\nfunction text(data) {\n    return document.createTextNode(data);\n}\nfunction space() {\n    return text(' ');\n}\nfunction empty() {\n    return text('');\n}\nfunction listen(node, event, handler, options) {\n    node.addEventListener(event, handler, options);\n    return () => node.removeEventListener(event, handler, options);\n}\nfunction prevent_default(fn) {\n    return function (event) {\n        event.preventDefault();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction stop_propagation(fn) {\n    return function (event) {\n        event.stopPropagation();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction self(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.target === this)\n            fn.call(this, event);\n    };\n}\nfunction attr(node, attribute, value) {\n    if (value == null)\n        node.removeAttribute(attribute);\n    else if (node.getAttribute(attribute) !== value)\n        node.setAttribute(attribute, value);\n}\nfunction set_attributes(node, attributes) {\n    // @ts-ignore\n    const descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n    for (const key in attributes) {\n        if (attributes[key] == null) {\n            node.removeAttribute(key);\n        }\n        else if (key === 'style') {\n            node.style.cssText = attributes[key];\n        }\n        else if (key === '__value' || descriptors[key] && descriptors[key].set) {\n            node[key] = attributes[key];\n        }\n        else {\n            attr(node, key, attributes[key]);\n        }\n    }\n}\nfunction set_svg_attributes(node, attributes) {\n    for (const key in attributes) {\n        attr(node, key, attributes[key]);\n    }\n}\nfunction set_custom_element_data(node, prop, value) {\n    if (prop in node) {\n        node[prop] = value;\n    }\n    else {\n        attr(node, prop, value);\n    }\n}\nfunction xlink_attr(node, attribute, value) {\n    node.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\nfunction get_binding_group_value(group) {\n    const value = [];\n    for (let i = 0; i < group.length; i += 1) {\n        if (group[i].checked)\n            value.push(group[i].__value);\n    }\n    return value;\n}\nfunction to_number(value) {\n    return value === '' ? undefined : +value;\n}\nfunction time_ranges_to_array(ranges) {\n    const array = [];\n    for (let i = 0; i < ranges.length; i += 1) {\n        array.push({ start: ranges.start(i), end: ranges.end(i) });\n    }\n    return array;\n}\nfunction children(element) {\n    return Array.from(element.childNodes);\n}\nfunction claim_element(nodes, name, attributes, svg) {\n    for (let i = 0; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeName === name) {\n            let j = 0;\n            while (j < node.attributes.length) {\n                const attribute = node.attributes[j];\n                if (attributes[attribute.name]) {\n                    j++;\n                }\n                else {\n                    node.removeAttribute(attribute.name);\n                }\n            }\n            return nodes.splice(i, 1)[0];\n        }\n    }\n    return svg ? svg_element(name) : element(name);\n}\nfunction claim_text(nodes, data) {\n    for (let i = 0; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeType === 3) {\n            node.data = '' + data;\n            return nodes.splice(i, 1)[0];\n        }\n    }\n    return text(data);\n}\nfunction claim_space(nodes) {\n    return claim_text(nodes, ' ');\n}\nfunction set_data(text, data) {\n    data = '' + data;\n    if (text.data !== data)\n        text.data = data;\n}\nfunction set_input_value(input, value) {\n    if (value != null || input.value) {\n        input.value = value;\n    }\n}\nfunction set_input_type(input, type) {\n    try {\n        input.type = type;\n    }\n    catch (e) {\n        // do nothing\n    }\n}\nfunction set_style(node, key, value, important) {\n    node.style.setProperty(key, value, important ? 'important' : '');\n}\nfunction select_option(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        if (option.__value === value) {\n            option.selected = true;\n            return;\n        }\n    }\n}\nfunction select_options(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        option.selected = ~value.indexOf(option.__value);\n    }\n}\nfunction select_value(select) {\n    const selected_option = select.querySelector(':checked') || select.options[0];\n    return selected_option && selected_option.__value;\n}\nfunction select_multiple_value(select) {\n    return [].map.call(select.querySelectorAll(':checked'), option => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\nlet crossorigin;\nfunction is_crossorigin() {\n    if (crossorigin === undefined) {\n        crossorigin = false;\n        try {\n            if (typeof window !== 'undefined' && window.parent) {\n                void window.parent.document;\n            }\n        }\n        catch (error) {\n            crossorigin = true;\n        }\n    }\n    return crossorigin;\n}\nfunction add_resize_listener(node, fn) {\n    const computed_style = getComputedStyle(node);\n    const z_index = (parseInt(computed_style.zIndex) || 0) - 1;\n    if (computed_style.position === 'static') {\n        node.style.position = 'relative';\n    }\n    const iframe = element('iframe');\n    iframe.setAttribute('style', `display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ` +\n        `overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: ${z_index};`);\n    iframe.setAttribute('aria-hidden', 'true');\n    iframe.tabIndex = -1;\n    let unsubscribe;\n    if (is_crossorigin()) {\n        iframe.src = `data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>`;\n        unsubscribe = listen(window, 'message', (event) => {\n            if (event.source === iframe.contentWindow)\n                fn();\n        });\n    }\n    else {\n        iframe.src = 'about:blank';\n        iframe.onload = () => {\n            unsubscribe = listen(iframe.contentWindow, 'resize', fn);\n        };\n    }\n    append(node, iframe);\n    return () => {\n        detach(iframe);\n        if (unsubscribe)\n            unsubscribe();\n    };\n}\nfunction toggle_class(element, name, toggle) {\n    element.classList[toggle ? 'add' : 'remove'](name);\n}\nfunction custom_event(type, detail) {\n    const e = document.createEvent('CustomEvent');\n    e.initCustomEvent(type, false, false, detail);\n    return e;\n}\nfunction query_selector_all(selector, parent = document.body) {\n    return Array.from(parent.querySelectorAll(selector));\n}\nclass HtmlTag {\n    constructor(html, anchor = null) {\n        this.e = element('div');\n        this.a = anchor;\n        this.u(html);\n    }\n    m(target, anchor = null) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert(target, this.n[i], anchor);\n        }\n        this.t = target;\n    }\n    u(html) {\n        this.e.innerHTML = html;\n        this.n = Array.from(this.e.childNodes);\n    }\n    p(html) {\n        this.d();\n        this.u(html);\n        this.m(this.t, this.a);\n    }\n    d() {\n        this.n.forEach(detach);\n    }\n}\n\nconst active_docs = new Set();\nlet active = 0;\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\nfunction hash(str) {\n    let hash = 5381;\n    let i = str.length;\n    while (i--)\n        hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n    return hash >>> 0;\n}\nfunction create_rule(node, a, b, duration, delay, ease, fn, uid = 0) {\n    const step = 16.666 / duration;\n    let keyframes = '{\\n';\n    for (let p = 0; p <= 1; p += step) {\n        const t = a + (b - a) * ease(p);\n        keyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n    }\n    const rule = keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n    const name = `__svelte_${hash(rule)}_${uid}`;\n    const doc = node.ownerDocument;\n    active_docs.add(doc);\n    const stylesheet = doc.__svelte_stylesheet || (doc.__svelte_stylesheet = doc.head.appendChild(element('style')).sheet);\n    const current_rules = doc.__svelte_rules || (doc.__svelte_rules = {});\n    if (!current_rules[name]) {\n        current_rules[name] = true;\n        stylesheet.insertRule(`@keyframes ${name} ${rule}`, stylesheet.cssRules.length);\n    }\n    const animation = node.style.animation || '';\n    node.style.animation = `${animation ? `${animation}, ` : ``}${name} ${duration}ms linear ${delay}ms 1 both`;\n    active += 1;\n    return name;\n}\nfunction delete_rule(node, name) {\n    const previous = (node.style.animation || '').split(', ');\n    const next = previous.filter(name\n        ? anim => anim.indexOf(name) < 0 // remove specific animation\n        : anim => anim.indexOf('__svelte') === -1 // remove all Svelte animations\n    );\n    const deleted = previous.length - next.length;\n    if (deleted) {\n        node.style.animation = next.join(', ');\n        active -= deleted;\n        if (!active)\n            clear_rules();\n    }\n}\nfunction clear_rules() {\n    raf(() => {\n        if (active)\n            return;\n        active_docs.forEach(doc => {\n            const stylesheet = doc.__svelte_stylesheet;\n            let i = stylesheet.cssRules.length;\n            while (i--)\n                stylesheet.deleteRule(i);\n            doc.__svelte_rules = {};\n        });\n        active_docs.clear();\n    });\n}\n\nfunction create_animation(node, from, fn, params) {\n    if (!from)\n        return noop;\n    const to = node.getBoundingClientRect();\n    if (from.left === to.left && from.right === to.right && from.top === to.top && from.bottom === to.bottom)\n        return noop;\n    const { delay = 0, duration = 300, easing = identity, \n    // @ts-ignore todo: should this be separated from destructuring? Or start/end added to public api and documentation?\n    start: start_time = now() + delay, \n    // @ts-ignore todo:\n    end = start_time + duration, tick = noop, css } = fn(node, { from, to }, params);\n    let running = true;\n    let started = false;\n    let name;\n    function start() {\n        if (css) {\n            name = create_rule(node, 0, 1, duration, delay, easing, css);\n        }\n        if (!delay) {\n            started = true;\n        }\n    }\n    function stop() {\n        if (css)\n            delete_rule(node, name);\n        running = false;\n    }\n    loop(now => {\n        if (!started && now >= start_time) {\n            started = true;\n        }\n        if (started && now >= end) {\n            tick(1, 0);\n            stop();\n        }\n        if (!running) {\n            return false;\n        }\n        if (started) {\n            const p = now - start_time;\n            const t = 0 + 1 * easing(p / duration);\n            tick(t, 1 - t);\n        }\n        return true;\n    });\n    start();\n    tick(0, 1);\n    return stop;\n}\nfunction fix_position(node) {\n    const style = getComputedStyle(node);\n    if (style.position !== 'absolute' && style.position !== 'fixed') {\n        const { width, height } = style;\n        const a = node.getBoundingClientRect();\n        node.style.position = 'absolute';\n        node.style.width = width;\n        node.style.height = height;\n        add_transform(node, a);\n    }\n}\nfunction add_transform(node, a) {\n    const b = node.getBoundingClientRect();\n    if (a.left !== b.left || a.top !== b.top) {\n        const style = getComputedStyle(node);\n        const transform = style.transform === 'none' ? '' : style.transform;\n        node.style.transform = `${transform} translate(${a.left - b.left}px, ${a.top - b.top}px)`;\n    }\n}\n\nlet current_component;\nfunction set_current_component(component) {\n    current_component = component;\n}\nfunction get_current_component() {\n    if (!current_component)\n        throw new Error(`Function called outside component initialization`);\n    return current_component;\n}\nfunction beforeUpdate(fn) {\n    get_current_component().$$.before_update.push(fn);\n}\nfunction onMount(fn) {\n    get_current_component().$$.on_mount.push(fn);\n}\nfunction afterUpdate(fn) {\n    get_current_component().$$.after_update.push(fn);\n}\nfunction onDestroy(fn) {\n    get_current_component().$$.on_destroy.push(fn);\n}\nfunction createEventDispatcher() {\n    const component = get_current_component();\n    return (type, detail) => {\n        const callbacks = component.$$.callbacks[type];\n        if (callbacks) {\n            // TODO are there situations where events could be dispatched\n            // in a server (non-DOM) environment?\n            const event = custom_event(type, detail);\n            callbacks.slice().forEach(fn => {\n                fn.call(component, event);\n            });\n        }\n    };\n}\nfunction setContext(key, context) {\n    get_current_component().$$.context.set(key, context);\n}\nfunction getContext(key) {\n    return get_current_component().$$.context.get(key);\n}\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\nfunction bubble(component, event) {\n    const callbacks = component.$$.callbacks[event.type];\n    if (callbacks) {\n        callbacks.slice().forEach(fn => fn(event));\n    }\n}\n\nconst dirty_components = [];\nconst intros = { enabled: false };\nconst binding_callbacks = [];\nconst render_callbacks = [];\nconst flush_callbacks = [];\nconst resolved_promise = Promise.resolve();\nlet update_scheduled = false;\nfunction schedule_update() {\n    if (!update_scheduled) {\n        update_scheduled = true;\n        resolved_promise.then(flush);\n    }\n}\nfunction tick() {\n    schedule_update();\n    return resolved_promise;\n}\nfunction add_render_callback(fn) {\n    render_callbacks.push(fn);\n}\nfunction add_flush_callback(fn) {\n    flush_callbacks.push(fn);\n}\nlet flushing = false;\nconst seen_callbacks = new Set();\nfunction flush() {\n    if (flushing)\n        return;\n    flushing = true;\n    do {\n        // first, call beforeUpdate functions\n        // and update components\n        for (let i = 0; i < dirty_components.length; i += 1) {\n            const component = dirty_components[i];\n            set_current_component(component);\n            update(component.$$);\n        }\n        dirty_components.length = 0;\n        while (binding_callbacks.length)\n            binding_callbacks.pop()();\n        // then, once components are updated, call\n        // afterUpdate functions. This may cause\n        // subsequent updates...\n        for (let i = 0; i < render_callbacks.length; i += 1) {\n            const callback = render_callbacks[i];\n            if (!seen_callbacks.has(callback)) {\n                // ...so guard against infinite loops\n                seen_callbacks.add(callback);\n                callback();\n            }\n        }\n        render_callbacks.length = 0;\n    } while (dirty_components.length);\n    while (flush_callbacks.length) {\n        flush_callbacks.pop()();\n    }\n    update_scheduled = false;\n    flushing = false;\n    seen_callbacks.clear();\n}\nfunction update($$) {\n    if ($$.fragment !== null) {\n        $$.update();\n        run_all($$.before_update);\n        const dirty = $$.dirty;\n        $$.dirty = [-1];\n        $$.fragment && $$.fragment.p($$.ctx, dirty);\n        $$.after_update.forEach(add_render_callback);\n    }\n}\n\nlet promise;\nfunction wait() {\n    if (!promise) {\n        promise = Promise.resolve();\n        promise.then(() => {\n            promise = null;\n        });\n    }\n    return promise;\n}\nfunction dispatch(node, direction, kind) {\n    node.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\nconst outroing = new Set();\nlet outros;\nfunction group_outros() {\n    outros = {\n        r: 0,\n        c: [],\n        p: outros // parent group\n    };\n}\nfunction check_outros() {\n    if (!outros.r) {\n        run_all(outros.c);\n    }\n    outros = outros.p;\n}\nfunction transition_in(block, local) {\n    if (block && block.i) {\n        outroing.delete(block);\n        block.i(local);\n    }\n}\nfunction transition_out(block, local, detach, callback) {\n    if (block && block.o) {\n        if (outroing.has(block))\n            return;\n        outroing.add(block);\n        outros.c.push(() => {\n            outroing.delete(block);\n            if (callback) {\n                if (detach)\n                    block.d(1);\n                callback();\n            }\n        });\n        block.o(local);\n    }\n}\nconst null_transition = { duration: 0 };\nfunction create_in_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = false;\n    let animation_name;\n    let task;\n    let uid = 0;\n    function cleanup() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n        tick(0, 1);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        if (task)\n            task.abort();\n        running = true;\n        add_render_callback(() => dispatch(node, true, 'start'));\n        task = loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(1, 0);\n                    dispatch(node, true, 'end');\n                    cleanup();\n                    return running = false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(t, 1 - t);\n                }\n            }\n            return running;\n        });\n    }\n    let started = false;\n    return {\n        start() {\n            if (started)\n                return;\n            delete_rule(node);\n            if (is_function(config)) {\n                config = config();\n                wait().then(go);\n            }\n            else {\n                go();\n            }\n        },\n        invalidate() {\n            started = false;\n        },\n        end() {\n            if (running) {\n                cleanup();\n                running = false;\n            }\n        }\n    };\n}\nfunction create_out_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = true;\n    let animation_name;\n    const group = outros;\n    group.r += 1;\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        add_render_callback(() => dispatch(node, false, 'start'));\n        loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(0, 1);\n                    dispatch(node, false, 'end');\n                    if (!--group.r) {\n                        // this will result in `end()` being called,\n                        // so we don't need to clean up here\n                        run_all(group.c);\n                    }\n                    return false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(1 - t, t);\n                }\n            }\n            return running;\n        });\n    }\n    if (is_function(config)) {\n        wait().then(() => {\n            // @ts-ignore\n            config = config();\n            go();\n        });\n    }\n    else {\n        go();\n    }\n    return {\n        end(reset) {\n            if (reset && config.tick) {\n                config.tick(1, 0);\n            }\n            if (running) {\n                if (animation_name)\n                    delete_rule(node, animation_name);\n                running = false;\n            }\n        }\n    };\n}\nfunction create_bidirectional_transition(node, fn, params, intro) {\n    let config = fn(node, params);\n    let t = intro ? 0 : 1;\n    let running_program = null;\n    let pending_program = null;\n    let animation_name = null;\n    function clear_animation() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function init(program, duration) {\n        const d = program.b - t;\n        duration *= Math.abs(d);\n        return {\n            a: t,\n            b: program.b,\n            d,\n            duration,\n            start: program.start,\n            end: program.start + duration,\n            group: program.group\n        };\n    }\n    function go(b) {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        const program = {\n            start: now() + delay,\n            b\n        };\n        if (!b) {\n            // @ts-ignore todo: improve typings\n            program.group = outros;\n            outros.r += 1;\n        }\n        if (running_program) {\n            pending_program = program;\n        }\n        else {\n            // if this is an intro, and there's a delay, we need to do\n            // an initial tick and/or apply CSS animation immediately\n            if (css) {\n                clear_animation();\n                animation_name = create_rule(node, t, b, duration, delay, easing, css);\n            }\n            if (b)\n                tick(0, 1);\n            running_program = init(program, duration);\n            add_render_callback(() => dispatch(node, b, 'start'));\n            loop(now => {\n                if (pending_program && now > pending_program.start) {\n                    running_program = init(pending_program, duration);\n                    pending_program = null;\n                    dispatch(node, running_program.b, 'start');\n                    if (css) {\n                        clear_animation();\n                        animation_name = create_rule(node, t, running_program.b, running_program.duration, 0, easing, config.css);\n                    }\n                }\n                if (running_program) {\n                    if (now >= running_program.end) {\n                        tick(t = running_program.b, 1 - t);\n                        dispatch(node, running_program.b, 'end');\n                        if (!pending_program) {\n                            // we're done\n                            if (running_program.b) {\n                                // intro — we can tidy up immediately\n                                clear_animation();\n                            }\n                            else {\n                                // outro — needs to be coordinated\n                                if (!--running_program.group.r)\n                                    run_all(running_program.group.c);\n                            }\n                        }\n                        running_program = null;\n                    }\n                    else if (now >= running_program.start) {\n                        const p = now - running_program.start;\n                        t = running_program.a + running_program.d * easing(p / running_program.duration);\n                        tick(t, 1 - t);\n                    }\n                }\n                return !!(running_program || pending_program);\n            });\n        }\n    }\n    return {\n        run(b) {\n            if (is_function(config)) {\n                wait().then(() => {\n                    // @ts-ignore\n                    config = config();\n                    go(b);\n                });\n            }\n            else {\n                go(b);\n            }\n        },\n        end() {\n            clear_animation();\n            running_program = pending_program = null;\n        }\n    };\n}\n\nfunction handle_promise(promise, info) {\n    const token = info.token = {};\n    function update(type, index, key, value) {\n        if (info.token !== token)\n            return;\n        info.resolved = value;\n        let child_ctx = info.ctx;\n        if (key !== undefined) {\n            child_ctx = child_ctx.slice();\n            child_ctx[key] = value;\n        }\n        const block = type && (info.current = type)(child_ctx);\n        let needs_flush = false;\n        if (info.block) {\n            if (info.blocks) {\n                info.blocks.forEach((block, i) => {\n                    if (i !== index && block) {\n                        group_outros();\n                        transition_out(block, 1, 1, () => {\n                            info.blocks[i] = null;\n                        });\n                        check_outros();\n                    }\n                });\n            }\n            else {\n                info.block.d(1);\n            }\n            block.c();\n            transition_in(block, 1);\n            block.m(info.mount(), info.anchor);\n            needs_flush = true;\n        }\n        info.block = block;\n        if (info.blocks)\n            info.blocks[index] = block;\n        if (needs_flush) {\n            flush();\n        }\n    }\n    if (is_promise(promise)) {\n        const current_component = get_current_component();\n        promise.then(value => {\n            set_current_component(current_component);\n            update(info.then, 1, info.value, value);\n            set_current_component(null);\n        }, error => {\n            set_current_component(current_component);\n            update(info.catch, 2, info.error, error);\n            set_current_component(null);\n        });\n        // if we previously had a then/catch block, destroy it\n        if (info.current !== info.pending) {\n            update(info.pending, 0);\n            return true;\n        }\n    }\n    else {\n        if (info.current !== info.then) {\n            update(info.then, 1, info.value, promise);\n            return true;\n        }\n        info.resolved = promise;\n    }\n}\n\nconst globals = (typeof window !== 'undefined'\n    ? window\n    : typeof globalThis !== 'undefined'\n        ? globalThis\n        : global);\n\nfunction destroy_block(block, lookup) {\n    block.d(1);\n    lookup.delete(block.key);\n}\nfunction outro_and_destroy_block(block, lookup) {\n    transition_out(block, 1, 1, () => {\n        lookup.delete(block.key);\n    });\n}\nfunction fix_and_destroy_block(block, lookup) {\n    block.f();\n    destroy_block(block, lookup);\n}\nfunction fix_and_outro_and_destroy_block(block, lookup) {\n    block.f();\n    outro_and_destroy_block(block, lookup);\n}\nfunction update_keyed_each(old_blocks, dirty, get_key, dynamic, ctx, list, lookup, node, destroy, create_each_block, next, get_context) {\n    let o = old_blocks.length;\n    let n = list.length;\n    let i = o;\n    const old_indexes = {};\n    while (i--)\n        old_indexes[old_blocks[i].key] = i;\n    const new_blocks = [];\n    const new_lookup = new Map();\n    const deltas = new Map();\n    i = n;\n    while (i--) {\n        const child_ctx = get_context(ctx, list, i);\n        const key = get_key(child_ctx);\n        let block = lookup.get(key);\n        if (!block) {\n            block = create_each_block(key, child_ctx);\n            block.c();\n        }\n        else if (dynamic) {\n            block.p(child_ctx, dirty);\n        }\n        new_lookup.set(key, new_blocks[i] = block);\n        if (key in old_indexes)\n            deltas.set(key, Math.abs(i - old_indexes[key]));\n    }\n    const will_move = new Set();\n    const did_move = new Set();\n    function insert(block) {\n        transition_in(block, 1);\n        block.m(node, next, lookup.has(block.key));\n        lookup.set(block.key, block);\n        next = block.first;\n        n--;\n    }\n    while (o && n) {\n        const new_block = new_blocks[n - 1];\n        const old_block = old_blocks[o - 1];\n        const new_key = new_block.key;\n        const old_key = old_block.key;\n        if (new_block === old_block) {\n            // do nothing\n            next = new_block.first;\n            o--;\n            n--;\n        }\n        else if (!new_lookup.has(old_key)) {\n            // remove old block\n            destroy(old_block, lookup);\n            o--;\n        }\n        else if (!lookup.has(new_key) || will_move.has(new_key)) {\n            insert(new_block);\n        }\n        else if (did_move.has(old_key)) {\n            o--;\n        }\n        else if (deltas.get(new_key) > deltas.get(old_key)) {\n            did_move.add(new_key);\n            insert(new_block);\n        }\n        else {\n            will_move.add(old_key);\n            o--;\n        }\n    }\n    while (o--) {\n        const old_block = old_blocks[o];\n        if (!new_lookup.has(old_block.key))\n            destroy(old_block, lookup);\n    }\n    while (n)\n        insert(new_blocks[n - 1]);\n    return new_blocks;\n}\nfunction validate_each_keys(ctx, list, get_context, get_key) {\n    const keys = new Set();\n    for (let i = 0; i < list.length; i++) {\n        const key = get_key(get_context(ctx, list, i));\n        if (keys.has(key)) {\n            throw new Error(`Cannot have duplicate keys in a keyed each`);\n        }\n        keys.add(key);\n    }\n}\n\nfunction get_spread_update(levels, updates) {\n    const update = {};\n    const to_null_out = {};\n    const accounted_for = { $$scope: 1 };\n    let i = levels.length;\n    while (i--) {\n        const o = levels[i];\n        const n = updates[i];\n        if (n) {\n            for (const key in o) {\n                if (!(key in n))\n                    to_null_out[key] = 1;\n            }\n            for (const key in n) {\n                if (!accounted_for[key]) {\n                    update[key] = n[key];\n                    accounted_for[key] = 1;\n                }\n            }\n            levels[i] = n;\n        }\n        else {\n            for (const key in o) {\n                accounted_for[key] = 1;\n            }\n        }\n    }\n    for (const key in to_null_out) {\n        if (!(key in update))\n            update[key] = undefined;\n    }\n    return update;\n}\nfunction get_spread_object(spread_props) {\n    return typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n\n// source: https://html.spec.whatwg.org/multipage/indices.html\nconst boolean_attributes = new Set([\n    'allowfullscreen',\n    'allowpaymentrequest',\n    'async',\n    'autofocus',\n    'autoplay',\n    'checked',\n    'controls',\n    'default',\n    'defer',\n    'disabled',\n    'formnovalidate',\n    'hidden',\n    'ismap',\n    'loop',\n    'multiple',\n    'muted',\n    'nomodule',\n    'novalidate',\n    'open',\n    'playsinline',\n    'readonly',\n    'required',\n    'reversed',\n    'selected'\n]);\n\nconst invalid_attribute_name_character = /[\\s'\">/=\\u{FDD0}-\\u{FDEF}\\u{FFFE}\\u{FFFF}\\u{1FFFE}\\u{1FFFF}\\u{2FFFE}\\u{2FFFF}\\u{3FFFE}\\u{3FFFF}\\u{4FFFE}\\u{4FFFF}\\u{5FFFE}\\u{5FFFF}\\u{6FFFE}\\u{6FFFF}\\u{7FFFE}\\u{7FFFF}\\u{8FFFE}\\u{8FFFF}\\u{9FFFE}\\u{9FFFF}\\u{AFFFE}\\u{AFFFF}\\u{BFFFE}\\u{BFFFF}\\u{CFFFE}\\u{CFFFF}\\u{DFFFE}\\u{DFFFF}\\u{EFFFE}\\u{EFFFF}\\u{FFFFE}\\u{FFFFF}\\u{10FFFE}\\u{10FFFF}]/u;\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\n// https://infra.spec.whatwg.org/#noncharacter\nfunction spread(args, classes_to_add) {\n    const attributes = Object.assign({}, ...args);\n    if (classes_to_add) {\n        if (attributes.class == null) {\n            attributes.class = classes_to_add;\n        }\n        else {\n            attributes.class += ' ' + classes_to_add;\n        }\n    }\n    let str = '';\n    Object.keys(attributes).forEach(name => {\n        if (invalid_attribute_name_character.test(name))\n            return;\n        const value = attributes[name];\n        if (value === true)\n            str += \" \" + name;\n        else if (boolean_attributes.has(name.toLowerCase())) {\n            if (value)\n                str += \" \" + name;\n        }\n        else if (value != null) {\n            str += ` ${name}=\"${String(value).replace(/\"/g, '&#34;').replace(/'/g, '&#39;')}\"`;\n        }\n    });\n    return str;\n}\nconst escaped = {\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;'\n};\nfunction escape(html) {\n    return String(html).replace(/[\"'&<>]/g, match => escaped[match]);\n}\nfunction each(items, fn) {\n    let str = '';\n    for (let i = 0; i < items.length; i += 1) {\n        str += fn(items[i], i);\n    }\n    return str;\n}\nconst missing_component = {\n    $$render: () => ''\n};\nfunction validate_component(component, name) {\n    if (!component || !component.$$render) {\n        if (name === 'svelte:component')\n            name += ' this={...}';\n        throw new Error(`<${name}> is not a valid SSR component. You may need to review your build config to ensure that dependencies are compiled, rather than imported as pre-compiled modules`);\n    }\n    return component;\n}\nfunction debug(file, line, column, values) {\n    console.log(`{@debug} ${file ? file + ' ' : ''}(${line}:${column})`); // eslint-disable-line no-console\n    console.log(values); // eslint-disable-line no-console\n    return '';\n}\nlet on_destroy;\nfunction create_ssr_component(fn) {\n    function $$render(result, props, bindings, slots) {\n        const parent_component = current_component;\n        const $$ = {\n            on_destroy,\n            context: new Map(parent_component ? parent_component.$$.context : []),\n            // these will be immediately discarded\n            on_mount: [],\n            before_update: [],\n            after_update: [],\n            callbacks: blank_object()\n        };\n        set_current_component({ $$ });\n        const html = fn(result, props, bindings, slots);\n        set_current_component(parent_component);\n        return html;\n    }\n    return {\n        render: (props = {}, options = {}) => {\n            on_destroy = [];\n            const result = { title: '', head: '', css: new Set() };\n            const html = $$render(result, props, {}, options);\n            run_all(on_destroy);\n            return {\n                html,\n                css: {\n                    code: Array.from(result.css).map(css => css.code).join('\\n'),\n                    map: null // TODO\n                },\n                head: result.title + result.head\n            };\n        },\n        $$render\n    };\n}\nfunction add_attribute(name, value, boolean) {\n    if (value == null || (boolean && !value))\n        return '';\n    return ` ${name}${value === true ? '' : `=${typeof value === 'string' ? JSON.stringify(escape(value)) : `\"${value}\"`}`}`;\n}\nfunction add_classes(classes) {\n    return classes ? ` class=\"${classes}\"` : ``;\n}\n\nfunction bind(component, name, callback) {\n    const index = component.$$.props[name];\n    if (index !== undefined) {\n        component.$$.bound[index] = callback;\n        callback(component.$$.ctx[index]);\n    }\n}\nfunction create_component(block) {\n    block && block.c();\n}\nfunction claim_component(block, parent_nodes) {\n    block && block.l(parent_nodes);\n}\nfunction mount_component(component, target, anchor) {\n    const { fragment, on_mount, on_destroy, after_update } = component.$$;\n    fragment && fragment.m(target, anchor);\n    // onMount happens before the initial afterUpdate\n    add_render_callback(() => {\n        const new_on_destroy = on_mount.map(run).filter(is_function);\n        if (on_destroy) {\n            on_destroy.push(...new_on_destroy);\n        }\n        else {\n            // Edge case - component was destroyed immediately,\n            // most likely as a result of a binding initialising\n            run_all(new_on_destroy);\n        }\n        component.$$.on_mount = [];\n    });\n    after_update.forEach(add_render_callback);\n}\nfunction destroy_component(component, detaching) {\n    const $$ = component.$$;\n    if ($$.fragment !== null) {\n        run_all($$.on_destroy);\n        $$.fragment && $$.fragment.d(detaching);\n        // TODO null out other refs, including component.$$ (but need to\n        // preserve final state?)\n        $$.on_destroy = $$.fragment = null;\n        $$.ctx = [];\n    }\n}\nfunction make_dirty(component, i) {\n    if (component.$$.dirty[0] === -1) {\n        dirty_components.push(component);\n        schedule_update();\n        component.$$.dirty.fill(0);\n    }\n    component.$$.dirty[(i / 31) | 0] |= (1 << (i % 31));\n}\nfunction init(component, options, instance, create_fragment, not_equal, props, dirty = [-1]) {\n    const parent_component = current_component;\n    set_current_component(component);\n    const prop_values = options.props || {};\n    const $$ = component.$$ = {\n        fragment: null,\n        ctx: null,\n        // state\n        props,\n        update: noop,\n        not_equal,\n        bound: blank_object(),\n        // lifecycle\n        on_mount: [],\n        on_destroy: [],\n        before_update: [],\n        after_update: [],\n        context: new Map(parent_component ? parent_component.$$.context : []),\n        // everything else\n        callbacks: blank_object(),\n        dirty\n    };\n    let ready = false;\n    $$.ctx = instance\n        ? instance(component, prop_values, (i, ret, ...rest) => {\n            const value = rest.length ? rest[0] : ret;\n            if ($$.ctx && not_equal($$.ctx[i], $$.ctx[i] = value)) {\n                if ($$.bound[i])\n                    $$.bound[i](value);\n                if (ready)\n                    make_dirty(component, i);\n            }\n            return ret;\n        })\n        : [];\n    $$.update();\n    ready = true;\n    run_all($$.before_update);\n    // `false` as a special case of no DOM component\n    $$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n    if (options.target) {\n        if (options.hydrate) {\n            const nodes = children(options.target);\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.l(nodes);\n            nodes.forEach(detach);\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.c();\n        }\n        if (options.intro)\n            transition_in(component.$$.fragment);\n        mount_component(component, options.target, options.anchor);\n        flush();\n    }\n    set_current_component(parent_component);\n}\nlet SvelteElement;\nif (typeof HTMLElement === 'function') {\n    SvelteElement = class extends HTMLElement {\n        constructor() {\n            super();\n            this.attachShadow({ mode: 'open' });\n        }\n        connectedCallback() {\n            // @ts-ignore todo: improve typings\n            for (const key in this.$$.slotted) {\n                // @ts-ignore todo: improve typings\n                this.appendChild(this.$$.slotted[key]);\n            }\n        }\n        attributeChangedCallback(attr, _oldValue, newValue) {\n            this[attr] = newValue;\n        }\n        $destroy() {\n            destroy_component(this, 1);\n            this.$destroy = noop;\n        }\n        $on(type, callback) {\n            // TODO should this delegate to addEventListener?\n            const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n            callbacks.push(callback);\n            return () => {\n                const index = callbacks.indexOf(callback);\n                if (index !== -1)\n                    callbacks.splice(index, 1);\n            };\n        }\n        $set() {\n            // overridden by instance, if it has props\n        }\n    };\n}\nclass SvelteComponent {\n    $destroy() {\n        destroy_component(this, 1);\n        this.$destroy = noop;\n    }\n    $on(type, callback) {\n        const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n        callbacks.push(callback);\n        return () => {\n            const index = callbacks.indexOf(callback);\n            if (index !== -1)\n                callbacks.splice(index, 1);\n        };\n    }\n    $set() {\n        // overridden by instance, if it has props\n    }\n}\n\nfunction dispatch_dev(type, detail) {\n    document.dispatchEvent(custom_event(type, Object.assign({ version: '3.22.2' }, detail)));\n}\nfunction append_dev(target, node) {\n    dispatch_dev(\"SvelteDOMInsert\", { target, node });\n    append(target, node);\n}\nfunction insert_dev(target, node, anchor) {\n    dispatch_dev(\"SvelteDOMInsert\", { target, node, anchor });\n    insert(target, node, anchor);\n}\nfunction detach_dev(node) {\n    dispatch_dev(\"SvelteDOMRemove\", { node });\n    detach(node);\n}\nfunction detach_between_dev(before, after) {\n    while (before.nextSibling && before.nextSibling !== after) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction detach_before_dev(after) {\n    while (after.previousSibling) {\n        detach_dev(after.previousSibling);\n    }\n}\nfunction detach_after_dev(before) {\n    while (before.nextSibling) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction listen_dev(node, event, handler, options, has_prevent_default, has_stop_propagation) {\n    const modifiers = options === true ? [\"capture\"] : options ? Array.from(Object.keys(options)) : [];\n    if (has_prevent_default)\n        modifiers.push('preventDefault');\n    if (has_stop_propagation)\n        modifiers.push('stopPropagation');\n    dispatch_dev(\"SvelteDOMAddEventListener\", { node, event, handler, modifiers });\n    const dispose = listen(node, event, handler, options);\n    return () => {\n        dispatch_dev(\"SvelteDOMRemoveEventListener\", { node, event, handler, modifiers });\n        dispose();\n    };\n}\nfunction attr_dev(node, attribute, value) {\n    attr(node, attribute, value);\n    if (value == null)\n        dispatch_dev(\"SvelteDOMRemoveAttribute\", { node, attribute });\n    else\n        dispatch_dev(\"SvelteDOMSetAttribute\", { node, attribute, value });\n}\nfunction prop_dev(node, property, value) {\n    node[property] = value;\n    dispatch_dev(\"SvelteDOMSetProperty\", { node, property, value });\n}\nfunction dataset_dev(node, property, value) {\n    node.dataset[property] = value;\n    dispatch_dev(\"SvelteDOMSetDataset\", { node, property, value });\n}\nfunction set_data_dev(text, data) {\n    data = '' + data;\n    if (text.data === data)\n        return;\n    dispatch_dev(\"SvelteDOMSetData\", { node: text, data });\n    text.data = data;\n}\nfunction validate_each_argument(arg) {\n    if (typeof arg !== 'string' && !(arg && typeof arg === 'object' && 'length' in arg)) {\n        let msg = '{#each} only iterates over array-like objects.';\n        if (typeof Symbol === 'function' && arg && Symbol.iterator in arg) {\n            msg += ' You can use a spread to convert this iterable into an array.';\n        }\n        throw new Error(msg);\n    }\n}\nfunction validate_slots(name, slot, keys) {\n    for (const slot_key of Object.keys(slot)) {\n        if (!~keys.indexOf(slot_key)) {\n            console.warn(`<${name}> received an unexpected slot \"${slot_key}\".`);\n        }\n    }\n}\nclass SvelteComponentDev extends SvelteComponent {\n    constructor(options) {\n        if (!options || (!options.target && !options.$$inline)) {\n            throw new Error(`'target' is a required option`);\n        }\n        super();\n    }\n    $destroy() {\n        super.$destroy();\n        this.$destroy = () => {\n            console.warn(`Component was already destroyed`); // eslint-disable-line no-console\n        };\n    }\n    $capture_state() { }\n    $inject_state() { }\n}\nfunction loop_guard(timeout) {\n    const start = Date.now();\n    return () => {\n        if (Date.now() - start > timeout) {\n            throw new Error(`Infinite loop detected`);\n        }\n    };\n}\n\nexport { HtmlTag, SvelteComponent, SvelteComponentDev, SvelteElement, action_destroyer, add_attribute, add_classes, add_flush_callback, add_location, add_render_callback, add_resize_listener, add_transform, afterUpdate, append, append_dev, assign, attr, attr_dev, beforeUpdate, bind, binding_callbacks, blank_object, bubble, check_outros, children, claim_component, claim_element, claim_space, claim_text, clear_loops, component_subscribe, compute_rest_props, createEventDispatcher, create_animation, create_bidirectional_transition, create_component, create_in_transition, create_out_transition, create_slot, create_ssr_component, current_component, custom_event, dataset_dev, debug, destroy_block, destroy_component, destroy_each, detach, detach_after_dev, detach_before_dev, detach_between_dev, detach_dev, dirty_components, dispatch_dev, each, element, element_is, empty, escape, escaped, exclude_internal_props, fix_and_destroy_block, fix_and_outro_and_destroy_block, fix_position, flush, getContext, get_binding_group_value, get_current_component, get_slot_changes, get_slot_context, get_spread_object, get_spread_update, get_store_value, globals, group_outros, handle_promise, has_prop, identity, init, insert, insert_dev, intros, invalid_attribute_name_character, is_client, is_crossorigin, is_function, is_promise, listen, listen_dev, loop, loop_guard, missing_component, mount_component, noop, not_equal, now, null_to_empty, object_without_properties, onDestroy, onMount, once, outro_and_destroy_block, prevent_default, prop_dev, query_selector_all, raf, run, run_all, safe_not_equal, schedule_update, select_multiple_value, select_option, select_options, select_value, self, setContext, set_attributes, set_current_component, set_custom_element_data, set_data, set_data_dev, set_input_type, set_input_value, set_now, set_raf, set_store_value, set_style, set_svg_attributes, space, spread, stop_propagation, subscribe, svg_element, text, tick, time_ranges_to_array, to_number, toggle_class, transition_in, transition_out, update_keyed_each, validate_component, validate_each_argument, validate_each_keys, validate_slots, validate_store, xlink_attr };\n","var jsx = {\n\n    arrayKeyExists: function (key, object) {\n        return (key in object);\n    },\n\n\n    //https://gist.github.com/jdnichollsc/78a6eb093731cf3e8dfd536dbe4befb3\n    b64toBlob: function (b64Data, contentType, sliceSize) {\n        contentType = contentType || 'image/png';\n        sliceSize = sliceSize || 512;\n\n        var byteCharacters = atob(b64Data);\n        var byteArrays = [];\n\n        for (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {\n            var slice = byteCharacters.slice(offset, offset + sliceSize);\n\n            var byteNumbers = new Array(slice.length);\n            for (var i = 0; i < slice.length; i++) {\n                byteNumbers[i] = slice.charCodeAt(i);\n            }\n\n            var byteArray = new Uint8Array(byteNumbers);\n\n            byteArrays.push(byteArray);\n        }\n\n        var blob = new Blob(byteArrays, {type: contentType});\n        return blob;\n    },\n\n\n    basename: function (path, returnExtension = true) {\n        let basename = path.split(/[\\\\/]/).pop();\n        if (false === returnExtension) {\n            if (false === this.str_contains(basename, \".\")) {\n                return basename;\n            }\n            let p = basename.split('.');\n            p.pop();\n            return p.join(\".\");\n        }\n        return basename;\n    },\n\n\n    compareBlobs: async function (blob1, blob2, useTrick = true) {\n        if (blob1.size !== blob2.size) {\n            return false;\n        }\n\n        /**\n         * I use the trick below for performances sake.\n         * From my test, comparing a 172M file to itself without the trick took about 8 seconds,\n         * which was unacceptable for my needs.\n         * So with this trick, the comparison is almost instant.\n         *\n         *\n         * If the size is more than 1M (more than 1 million bytes), then\n         * it's likely than no difference in size means no difference in the blob,\n         * unless you create some kind of blocks of data that have exactly the same size, in which case this function\n         * might not be appropriate for your needs.\n         *\n         * My original case is a file uploader, I just want to see if the user has uploaded a different file or not.\n         *\n         *\n         *\n         */\n        if (true === useTrick) {\n            if (blob1.size > 1024 * 1024) {\n                return true;\n            }\n        }\n\n\n        let buffer = await blob1.arrayBuffer();\n        let buffer2 = await blob2.arrayBuffer();\n        return this._compareBuffers(buffer, buffer2);\n    },\n\n    // https://stackoverflow.com/questions/201183/how-to-determine-equality-for-two-javascript-objects\n    compareObjects: function (x, y) {\n\n        if (x === null || x === undefined || y === null || y === undefined) {\n            return x === y;\n        }\n        // after this just checking type of one would be enough\n        if (x.constructor !== y.constructor) {\n            return false;\n        }\n        // if they are functions, they should exactly refer to same one (because of closures)\n        if (x instanceof Function) {\n            return x === y;\n        }\n        // if they are regexps, they should exactly refer to same one (it is hard to better equality check on current ES)\n        if (x instanceof RegExp) {\n            return x === y;\n        }\n        if (x === y || x.valueOf() === y.valueOf()) {\n            return true;\n        }\n        if (Array.isArray(x) && x.length !== y.length) {\n            return false;\n        }\n\n        // if they are dates, they must had equal valueOf\n        if (x instanceof Date) {\n            return false;\n        }\n\n        // if they are strictly equal, they both need to be object at least\n        if (!(x instanceof Object)) {\n            return false;\n        }\n        if (!(y instanceof Object)) {\n            return false;\n        }\n\n        // recursive object equality check\n        var p = Object.keys(x);\n        return Object.keys(y).every((i) => {\n                return p.indexOf(i) !== -1;\n            }) &&\n            p.every((i) => {\n                return this.compareObjects(x[i], y[i]);\n            });\n    },\n    convertHumanSizeToBytes: function(){\n\n    },\n    cssId: function (prefix = 'jsx') {\n        return prefix + '-' + this.getRandomNumber(0, 1000000);\n    },\n\n    // adapted from https://locutus.io/php/filesystem/dirname/\n    dirname: function (path) {\n        var ret = path.replace(/\\\\/g, '/').replace(/\\/[^/]*\\/?$/, '');\n        if ('/' === ret.charAt(ret.length - 1)) {\n            ret = ret.substr(0, ret.length - 1);\n        }\n        return ret;\n    },\n\n    // https://stackoverflow.com/questions/1787322/htmlspecialchars-equivalent-in-javascript\n    escapeHtml: function (text) {\n        var map = {\n            '&': '&amp;',\n            '<': '&lt;',\n            '>': '&gt;',\n            '\"': '&quot;',\n            \"'\": '&#039;'\n        };\n        return text.replace(/[&<>\"']/g, function (m) {\n            return map[m];\n        });\n    },\n\n\n    // adapted from https://gomakethings.com/vanilla-javascript-version-of-jquery-extend/\n    extend: function () {\n\n\n        // Variables\n        var extended = {};\n        var deep = false;\n        var i = 0;\n        var length = arguments.length;\n\n        // Check if a deep merge\n        if (Object.prototype.toString.call(arguments[0]) === '[object Boolean]') {\n            deep = arguments[0];\n            i++;\n        }\n\n        // Merge the object into the extended object\n        var merge = obj => {\n            for (var prop in obj) {\n                if (Object.prototype.hasOwnProperty.call(obj, prop)) {\n                    // If deep merge and property is an object, merge properties\n                    if (deep && Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n                        extended[prop] = this.extend(true, extended[prop], obj[prop]);\n                    } else {\n                        extended[prop] = obj[prop];\n                    }\n                }\n            }\n        };\n\n        // Loop through each object and conduct a merge\n        for (; i < length; i++) {\n            var obj = arguments[i];\n            merge(obj);\n        }\n\n        return extended;\n    },\n\n\n    fetchBlob: async function (url, fetchInit = {}) {\n        let response = await fetch(url, fetchInit);\n        if (false === response.ok) {\n            throw new Error(`Unexpected response with status ${response.status}: ${response.statusText}.`);\n        }\n        return await response.blob();\n    },\n    fetchJson: async function (url, fetchInit = {}) {\n        let response = await fetch(url, fetchInit);\n        if (false === response.ok) {\n            throw new Error(`Unexpected response with status ${response.status}: ${response.statusText}.`);\n        }\n        return await response.json();\n    },\n\n    getFileExtension: function (path) {\n        if (false === this.str_contains(path, \".\")) {\n            return \"\";\n        }\n        return path.split('.').pop();\n    },\n\n\n    getRandomNumber: function (min, max) {\n        return Math.floor(Math.random() * max) + min;\n    },\n\n    // https://stackoverflow.com/questions/15900485/correct-way-to-convert-size-in-bytes-to-kb-mb-gb-in-javascript\n    humanSize: function (bytes, decimals) {\n        if (0 === bytes) {\n            return \"0 Bytes\";\n        }\n        var c = 1024, d = decimals || 2, e = [\"B\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\", \"ZB\", \"YB\"],\n            f = Math.floor(Math.log(bytes) / Math.log(c));\n        return parseFloat((bytes / Math.pow(c, f)).toFixed(d)) + \" \" + e[f]\n    },\n\n    inArray: function (needle, haystack) {\n        var length = haystack.length;\n        for (var i = 0; i < length; i++) {\n            if (needle === haystack[i]) {\n                return true;\n            }\n        }\n        return false;\n    },\n    isArray: function (thing) {\n        return '[object Array]' === Object.prototype.toString.call(thing);\n    },\n\n\n    // https://code.jquery.com/jquery-3.4.1.js\n    isEmptyObject: function (obj) {\n        var name;\n        for (name in obj) {\n            return false;\n        }\n        return true;\n    },\n    isPlainObject: function (thing) {\n        return '[object Object]' === Object.prototype.toString.call(thing);\n    },\n\n    isFunction: function (thing) {\n        return '[object Function]' === Object.prototype.toString.call(thing);\n    },\n\n    mimeIsImage: function (mime) {\n        if (!mime.match(/^image\\//)) {\n            return false;\n        }\n        return true;\n    },\n    objectToQueryString: function (obj, encodeParams) {\n        return this._serialize(obj, encodeParams);\n    },\n\n    /**\n     * An asynchronous wrapper around fetch that posts data so that you can access them via $_POST, $_FILES (and $_GET) in a php server.\n     *\n     * The payload argument can be many things:\n     *\n     * - a js FormData\n     * - a plain object (aka map) containing key/value pairs (will be passed via POST).\n     * - a mixed object containing the following properties (all 3 must be declared, even if empty):\n     *      - post: the map to send to $_POST\n     *      - get: the map to send to $_GET\n     *      - files: the map to send to $_FILES, it's a map of name => File (js object)\n     *\n     *\n     *\n     * @param url\n     * @param payload\n     * @returns {Promise<Response>}\n     */\n    async post(url, payload) {\n\n\n        var body = null;\n        if (payload instanceof FormData) {\n            body = payload;\n        } else if (this.isPlainObject(payload)) {\n\n            if (\n                true === payload.hasOwnProperty(\"post\") &&\n                true === payload.hasOwnProperty(\"get\") &&\n                true === payload.hasOwnProperty(\"files\")\n            ) {\n\n                var post = payload.post;\n                var get = payload.get;\n                var files = payload.files;\n\n                if (false === this.isEmptyObject(get)) {\n                    url = this.url_merge_params(url, get);\n                }\n\n                body = new FormData();\n                this.toFormData(post, body);\n                this.toFormData(files, body);\n\n            } else {\n                body = this.toFormData(payload);\n            }\n        } else {\n            console.error(payload);\n            throw new Error(\"Unknown payload case.\");\n        }\n\n\n        return await fetch(url, {\n            method: \"POST\",\n            body: body,\n        });\n    },\n\n\n    // https://stackoverflow.com/questions/8648892/how-to-convert-url-parameters-to-a-javascript-object\n    queryStringToObject: function (queryString) {\n        let q = queryString.split(\"?\").pop();\n        let ret = {};\n        this._parse_str(q, ret)\n        return ret;\n    },\n\n\n    // https://stackoverflow.com/questions/4759745/javascript-reindexing-an-array\n    reindex: function (array) {\n        return array.filter(function (item) {\n            return item !== undefined\n        });\n    },\n\n\n    removeEntryByIndex: function (array, index) {\n        array.splice(index, 1);\n    },\n\n    startsWith: function (haystack, needle) {\n        return haystack.substring(0, needle.length) === needle;\n    },\n\n\n    str_contains: function (haystack, needle) {\n        return haystack.indexOf(needle) !== -1;\n    },\n\n\n    toBool: function (thing) {\n        if (\"0\" === thing) {\n            return false;\n        }\n        return !!thing;\n    },\n\n    /**\n     * Note: this function requires a environment with the FormData object\n     * available (i.e. a web browser) to work properly.\n     */\n    toFormData: function (obj, fd = null) {\n\n        if (null === fd) {\n            fd = new FormData();\n        }\n\n        // https://stackoverflow.com/questions/22783108/convert-js-object-to-form-data\n        let toFormData = (f => f(f))(h => f => f(x => h(h)(f)(x)))(f => fd => pk => d => {\n            if (d instanceof Object) {\n                Object.keys(d).forEach(k => {\n                    const v = d[k]\n                    if (pk) k = `${pk}[${k}]`\n                    if (v instanceof Object && !(v instanceof Date) && !(v instanceof File)) {\n                        return f(fd)(k)(v)\n                    } else {\n                        fd.append(k, v)\n                    }\n                })\n            }\n            return fd\n        })(fd)();\n\n        return toFormData(obj);\n    },\n\n    toInt: function (thing) {\n        if (true === thing) {\n            return 1;\n        }\n        if (false === thing) {\n            return 0;\n        }\n        let res = parseInt(thing);\n        if (isNaN(res)) {\n            return 0;\n        }\n        return res;\n    },\n\n    /**\n     * Note: at the time of writing (2020-04-06), the growing fetch api doesn't have a support\n     * for upload progress monitoring yet (at least not that I know of), so this method uses\n     * the older XMLHttpRequest api.\n     */\n    uploadFileProgress: async function (url, data, onProgress, decorator) {\n\n\n        return new Promise((resolve, reject) => {\n\n\n            let formdata;\n\n            if (data instanceof FormData) {\n                formdata = data;\n            } else {\n                formdata = new FormData();\n                for (let i in data) {\n                    formdata.append(i, data[i]);\n                }\n            }\n\n\n            var ajax = new XMLHttpRequest();\n            // ajax.overrideMimeType(\"application/json\");\n\n            if (this.isFunction(decorator)) {\n                decorator(ajax);\n            }\n\n            ajax.upload.addEventListener(\"progress\", function (e) {\n                var percent = Math.round((e.loaded / e.total) * 100, 2);\n                onProgress(e, percent, e.loaded, e.total);\n            }, false);\n\n\n            ajax.addEventListener(\"load\", function (e) {\n                e.stopPropagation();\n                e.preventDefault();\n            }, false);\n            ajax.addEventListener(\"error\", function (e) {\n                e.stopPropagation();\n                e.preventDefault();\n                if (\"onError\" in options) {\n                    reject(e);\n                }\n            }, false);\n            ajax.addEventListener(\"abort\", function (e) {\n                e.stopPropagation();\n                e.preventDefault();\n                if (\"onAbort\" in options) {\n                    reject(e);\n                }\n            }, false);\n\n\n            ajax.open(\"POST\", url);\n            ajax.onreadystatechange = function () {\n                if (ajax.readyState === 4) {\n                    resolve(ajax);\n                }\n            };\n            ajax.send(formdata);\n\n        });\n    },\n\n\n    url_merge_params: function (url, params, encodeParams = true) {\n        let split = url.split('?', 2);\n        let qs = '';\n        let baseUrl = split.shift();\n        if (1 === split.length) {\n            qs = split.shift();\n        }\n        let urlParams = this.queryStringToObject(qs);\n        let allParams = this.extend(urlParams, params);\n        let q = this.objectToQueryString(allParams, encodeParams);\n        if (q.length > 0) {\n            baseUrl += '?' + q;\n        }\n        return baseUrl;\n    },\n\n\n    //----------------------------------------\n    // PRIVATE\n    //----------------------------------------\n    // adapted from https://stackoverflow.com/questions/1714786/query-string-encoding-of-a-javascript-object\n    _serialize: function (obj, useEncoder, prefix) {\n        var str = [],\n            p;\n        for (p in obj) {\n            if (obj.hasOwnProperty(p)) {\n                var k = prefix ? prefix + \"[\" + p + \"]\" : p,\n                    v = obj[p];\n\n                if (v !== null && typeof v === \"object\") {\n                    str.push(this._serialize(v, useEncoder, k));\n                } else {\n                    if (true === useEncoder) {\n                        str.push(encodeURIComponent(k) + \"=\" + encodeURIComponent(v));\n                    } else {\n                        str.push(k + \"=\" + v);\n                    }\n                }\n            }\n        }\n        return str.join(\"&\");\n    },\n    _testTypes: function () {\n        // https://ultimatecourses.com/blog/understanding-javascript-types-and-reliable-type-checking\n\n        // last tested in node (v8) and firefox 2020-04-03\n\n        // check from times to times to see if implementation has changed.\n        console.log(Object.prototype.toString.call([])); // [object Array]\n        console.log(Object.prototype.toString.call({})); // [object Object]\n        console.log(Object.prototype.toString.call('')); // [object String]\n        console.log(Object.prototype.toString.call(new Date())); // [object Date]\n        console.log(Object.prototype.toString.call(1)); // [object Number]\n        console.log(Object.prototype.toString.call(function () {\n        })); // [object Function]\n        console.log(Object.prototype.toString.call(/test/i)); // [object RegExp]\n        console.log(Object.prototype.toString.call(true)); // [object Boolean]\n        console.log(Object.prototype.toString.call(null)); // [object Null]\n        console.log(Object.prototype.toString.call()); // [object Undefined]\n    },\n\n    _compareBuffers: function (buf1, buf2) {\n        if (buf1 === buf2) {\n            return true;\n        }\n        if (buf1.byteLength !== buf2.byteLength) {\n            return false;\n        }\n        const d1 = new DataView(buf1), d2 = new DataView(buf2);\n        var i = buf1.byteLength;\n        while (i--) {\n            if (d1.getUint8(i) !== d2.getUint8(i)) {\n                return false;\n            }\n        }\n        return true;\n    },\n    // https://locutus.io/php/strings/parse_str/\n    _parse_str: function (str, array) { // eslint-disable-line camelcase\n        //       discuss at: https://locutus.io/php/parse_str/\n        //      original by: Cagri Ekin\n        //      improved by: Michael White (https://getsprink.com)\n        //      improved by: Jack\n        //      improved by: Brett Zamir (https://brett-zamir.me)\n        //      bugfixed by: Onno Marsman (https://twitter.com/onnomarsman)\n        //      bugfixed by: Brett Zamir (https://brett-zamir.me)\n        //      bugfixed by: stag019\n        //      bugfixed by: Brett Zamir (https://brett-zamir.me)\n        //      bugfixed by: MIO_KODUKI (https://mio-koduki.blogspot.com/)\n        // reimplemented by: stag019\n        //         input by: Dreamer\n        //         input by: Zaide (https://zaidesthings.com/)\n        //         input by: David Pesta (https://davidpesta.com/)\n        //         input by: jeicquest\n        //      bugfixed by: Rafał Kukawski\n        //           note 1: When no argument is specified, will put variables in global scope.\n        //           note 1: When a particular argument has been passed, and the\n        //           note 1: returned value is different parse_str of PHP.\n        //           note 1: For example, a=b=c&d====c\n        //        example 1: var $arr = {}\n        //        example 1: parse_str('first=foo&second=bar', $arr)\n        //        example 1: var $result = $arr\n        //        returns 1: { first: 'foo', second: 'bar' }\n        //        example 2: var $arr = {}\n        //        example 2: parse_str('str_a=Jack+and+Jill+didn%27t+see+the+well.', $arr)\n        //        example 2: var $result = $arr\n        //        returns 2: { str_a: \"Jack and Jill didn't see the well.\" }\n        //        example 3: var $abc = {3:'a'}\n        //        example 3: parse_str('a[b][\"c\"]=def&a[q]=t+5', $abc)\n        //        example 3: var $result = $abc\n        //        returns 3: {\"3\":\"a\",\"a\":{\"b\":{\"c\":\"def\"},\"q\":\"t 5\"}}\n        //        example 4: var $arr = {}\n        //        example 4: parse_str('a[][]=value', $arr)\n        //        example 4: var $result = $arr\n        //        returns 4: {\"a\":{\"0\":{\"0\":\"value\"}}}\n        //        example 5: var $arr = {}\n        //        example 5: parse_str('a=1&a[]=2', $arr)\n        //        example 5: var $result = $arr\n        //        returns 5: {\"a\":{\"0\":\"2\"}}\n\n        var strArr = String(str).replace(/^&/, '').replace(/&$/, '').split('&')\n        var sal = strArr.length\n        var i\n        var j\n        var ct\n        var p\n        var lastObj\n        var obj\n        var chr\n        var tmp\n        var key\n        var value\n        var postLeftBracketPos\n        var keys\n        var keysLen\n\n        var _fixStr = function (str) {\n            return decodeURIComponent(str.replace(/\\+/g, '%20'))\n        }\n\n        var $global = (typeof window !== 'undefined' ? window : global)\n        $global.$locutus = $global.$locutus || {}\n        var $locutus = $global.$locutus\n        $locutus.php = $locutus.php || {}\n\n        if (!array) {\n            array = $global\n        }\n\n        for (i = 0; i < sal; i++) {\n            tmp = strArr[i].split('=')\n            key = _fixStr(tmp[0])\n            value = (tmp.length < 2) ? '' : _fixStr(tmp[1])\n\n            while (key.charAt(0) === ' ') {\n                key = key.slice(1)\n            }\n\n            if (key.indexOf('\\x00') > -1) {\n                key = key.slice(0, key.indexOf('\\x00'))\n            }\n\n            if (key && key.charAt(0) !== '[') {\n                keys = []\n                postLeftBracketPos = 0\n\n                for (j = 0; j < key.length; j++) {\n                    if (key.charAt(j) === '[' && !postLeftBracketPos) {\n                        postLeftBracketPos = j + 1\n                    } else if (key.charAt(j) === ']') {\n                        if (postLeftBracketPos) {\n                            if (!keys.length) {\n                                keys.push(key.slice(0, postLeftBracketPos - 1))\n                            }\n\n                            keys.push(key.substr(postLeftBracketPos, j - postLeftBracketPos))\n                            postLeftBracketPos = 0\n\n                            if (key.charAt(j + 1) !== '[') {\n                                break\n                            }\n                        }\n                    }\n                }\n\n                if (!keys.length) {\n                    keys = [key]\n                }\n\n                for (j = 0; j < keys[0].length; j++) {\n                    chr = keys[0].charAt(j)\n\n                    if (chr === ' ' || chr === '.' || chr === '[') {\n                        keys[0] = keys[0].substr(0, j) + '_' + keys[0].substr(j + 1)\n                    }\n\n                    if (chr === '[') {\n                        break\n                    }\n                }\n\n                obj = array\n\n                for (j = 0, keysLen = keys.length; j < keysLen; j++) {\n                    key = keys[j].replace(/^['\"]/, '').replace(/['\"]$/, '')\n                    lastObj = obj\n\n                    if ((key === '' || key === ' ') && j !== 0) {\n                        // Insert new dimension\n                        ct = -1\n\n                        for (p in obj) {\n                            if (obj.hasOwnProperty(p)) {\n                                if (+p > ct && p.match(/^\\d+$/g)) {\n                                    ct = +p\n                                }\n                            }\n                        }\n\n                        key = ct + 1\n                    }\n\n                    // if primitive value, replace with object\n                    if (Object(obj[key]) !== obj[key]) {\n                        obj[key] = {}\n                    }\n\n                    obj = obj[key]\n                }\n\n                lastObj[key] = value\n            }\n        }\n    },\n\n\n};\n\n\nmodule.exports = jsx;","const jsx = require('js-extension-ling');\n\n\nvar escapeCommaAndTrim = function (str) {\n    return str.replace(/__panda_comma__/g, \",\", str).trim();\n};\n\n\nfunction _getPandaHeaders(headers, arrays) {\n    var ret = {};\n    for (let v of headers) {\n        var [key, value] = v;\n        if (\"panda__arrays\" === key) {\n            continue;\n        }\n\n        if (jsx.startsWith(key, \"panda_\")) {\n            key = key.substr(6);\n\n\n            if (jsx.inArray(key, arrays)) {\n                if (false === jsx.arrayKeyExists(key, ret)) {\n                    ret[key] = [];\n                }\n                let values = value.split(\",\");\n                for (let j in values) {\n                    let val = escapeCommaAndTrim(values[j]);\n                    ret[key].push(val);\n                }\n            } else {\n                value = escapeCommaAndTrim(value);\n                ret[key] = value;\n            }\n        }\n\n    }\n    return ret;\n}\n\nvar pandaHeaders = {\n\n    getPandaHeaders: function (headers) {\n        var arrays = [];\n        if (headers.has(\"panda__arrays\")) {\n            arrays = headers.get('panda__arrays').split(\",\");\n        }\n\n        return _getPandaHeaders(headers, arrays);\n    },\n    getPandaHeadersByXMLHttpRequest: function (request) {\n\n\n        // Get the raw header string\n        var headers = request.getAllResponseHeaders();\n\n        // Convert the header string into an array\n        // of individual headers\n        var arr = headers.trim().split(/[\\r\\n]+/);\n\n        // Create a map of header names to values\n        var headerMap = {};\n        arr.forEach(function (line) {\n            let parts = line.split(': ');\n            let header = parts.shift();\n            let value = parts.join(': ');\n            headerMap[header] = value;\n        });\n\n\n\n        var arrays = [];\n        if (\"panda__arrays\" in headerMap) {\n            arrays = headerMap['panda__arrays'].split(\",\");\n        }\n        return _getPandaHeaders(Object.entries(headerMap), arrays);\n    }\n};\n\n\nmodule.exports = pandaHeaders;","import jsx from 'js-extension-ling';\n\n\nexport default class Validator {\n\n    constructor() {\n        this.events = null;\n        this.rules = [];\n        this.translatee = null;\n    }\n\n    addRule(cb) {\n        this.rules.push(cb);\n    }\n\n\n    setTranslator(translator) {\n        this.translatee = translator;\n    }\n\n\n    /**\n     * Tests the given file against the rules, and returns either true (if all rules passed) or an error message.\n     */\n    test(oFile) {\n\n        var errMsg;\n        for (var i in this.rules) {\n            var rule = this.rules[i];\n            errMsg = rule(oFile);\n            if (true !== errMsg) {\n                return errMsg;\n            }\n        }\n        return true;\n    }\n\n\n    init(options) {\n\n        // adding maxFileSize rule\n        if (options.hasOwnProperty(\"maxFileSize\")) {\n            if (options.maxFileSize !== -1) {\n                var bytesMaxFileSize = jsx.convertHumanSizeToBytes(options.maxFileSize);\n\n                this.addRule(oFile => {\n                    if (oFile.size > bytesMaxFileSize) {\n                        var tags = {\n                            \"fileName\": '<strong>' + oFile.name + '</strong>',\n                            \"maxSize\": jsx.humanSize(bytesMaxFileSize),\n                            \"fileSize\": jsx.humanSize(oFile.size),\n                        };\n                        return this.translatee._(\"err.maxFileExceeded\", tags);\n                    }\n                    return true;\n                });\n            }\n        }\n\n        // adding maxFileNameLength rule\n        if (options.hasOwnProperty(\"maxFileNameLength\")) {\n            this.addRule(oFile => {\n                if (oFile.name.length > options.maxFileNameLength) {\n                    var tags = {\n                        \"fileName\": '<strong>' + oFile.name + '</strong>',\n                        \"maxLength\": options.maxFileNameLength,\n                        \"length\": oFile.name.length,\n                    };\n                    return this.translatee._(\"err.maxFileNameLength\", tags);\n                }\n                return true;\n            });\n        }\n\n\n        // adding mime type rule\n        if (options.hasOwnProperty(\"mimeType\")) {\n            if (options.mimeType !== null) {\n                var allowedMimeTypes = options.mimeType;\n                if ('string' === typeof allowedMimeTypes) {\n                    allowedMimeTypes = [allowedMimeTypes];\n                }\n\n                this.addRule(oFile => {\n                    if (-1 === allowedMimeTypes.indexOf(oFile.type)) {\n                        var tags = {\n                            \"fileName\": '<strong>' + oFile.name + '</strong>',\n                            \"fileMimeType\": '<strong>' + oFile.type + '</strong>',\n                            \"allowedMimeTypes\": allowedMimeTypes.join(', '),\n                        };\n                        return this.translatee._(\"err.wrongMimeType\", tags);\n                    }\n                    return true;\n                });\n            }\n\n        }\n\n\n        // adding file extension rule\n        if (options.hasOwnProperty(\"allowedFileExtension\")) {\n\n            if (options.allowedFileExtension !== null) {\n                var allowedFileExtensions = options.allowedFileExtension;\n                if ('string' === typeof allowedFileExtensions) {\n                    allowedFileExtensions = [allowedFileExtensions];\n                }\n\n                this.addRule(oFile => {\n                    var name = oFile.name;\n                    var extension = jsx.getFileExtension(oFile.name);\n                    if (-1 === allowedFileExtensions.indexOf(extension)) {\n                        var tags = {\n                            \"fileName\": '<strong>' + oFile.name + '</strong>',\n                            \"fileExtension\": '<strong>' + extension + '</strong>',\n                            \"allowedFileExtensions\": allowedFileExtensions.join(', '),\n                        };\n                        return this.translatee._(\"err.wrongFileExtension\", tags);\n                    }\n                    return true;\n                });\n            }\n        }\n\n\n    }\n}\n\n","export default class GlobalProgressTracker {\n\n    constructor() {\n        this.nbItems = 0;\n        this.totalWeight = 0;\n        this.slots = {};\n    }\n\n    registerItems(uFiles) {\n\n        this.nbItems = 0;\n        this.totalWeight = 0;\n        this.slots = {};\n\n        for (let uFile of uFiles) {\n            if (2 === uFile.status) {\n                this.slots[uFile.id] = 0;\n                this.totalWeight += uFile.size;\n                this.nbItems++;\n            }\n        }\n    }\n\n    addProgress(id, percent) {\n        var maxPercentPerSlot = Math.round(100 / this.nbItems, 2);\n        this.slots[id] = percent * maxPercentPerSlot / 100;\n    }\n\n    getPercent() {\n        var percent = 0;\n        for (var id in this.slots) {\n            percent += this.slots[id];\n        }\n        return percent;\n    }\n\n    getTotalWeight() {\n        return this.totalWeight;\n    }\n\n}\n\n","/**\n *\n * Plural/non-plural\n * --------------\n * Translatee distinguishes two types of strings:\n *\n * - non-plural string (which doesn't involve a plural)\n * - plural string (which involves a plural)\n *\n * The _ method fetches non-plural translations.\n * The _n method fetches plural translations.\n *\n *\n * Plural selector and dictionary structure\n * ---------------\n * The **plural selector** is a function that returns a plural index.\n * The plural index indicates which translation (in the dictionary) to choose from when a plural form is required.\n *\n * The dictionary is a map of msgId to array of translations.\n * In singular string (aka non-plural string), the array contains only one translation.\n * In plural strings, the array contains more than one translation, depending on the language,\n * and the **plural selector** function returns the index of the translation to return.\n * The order of the translation depends on the person who creates the dictionary.\n *\n * In translatee, the plural selector function is always bound to a dictionary.\n *\n *\n *\n * Strict mode\n * -----------\n * With strict mode on, all errors throw an exception.\n * With strict mode off, the translation methods always return the msg id if there is an error.\n *\n *\n */\nclass Translatee {\n\n    constructor() {\n        this.dictionaries = {};\n        this.pluralSelectors = {};\n        this.defaultLang = 'eng';\n        this.strictMode = true;\n    }\n\n    setDefaultLang(langId) {\n        this.defaultLang = langId;\n    }\n\n    setStrictMode(bool) {\n        this.strictMode = bool;\n    }\n\n    addDictionary(langId, dictionary, pluralSelector = null) {\n        if (null === pluralSelector) {\n            pluralSelector = this._getDefaultPluralSelector(langId);\n        }\n        this.pluralSelectors[langId] = pluralSelector;\n        this.dictionaries[langId] = dictionary;\n    }\n\n\n    /**\n     * Fetches a non-plural translation.\n     * Tags are automatically wrapped with the curly bracket and will replace their dictionary string counterpart if found.\n     * If langId is null, the default lang will be used.\n     */\n    _(msgId, tags = {}, langId = null) {\n        if (null === langId) {\n            langId = this.defaultLang;\n        }\n        if (langId in this.dictionaries) {\n\n            var dict = this.dictionaries[langId];\n            if (msgId in dict) {\n                var msg = dict[msgId][0];\n                for (var key in tags) {\n                    msg = msg.replace('{' + key + '}', tags[key]);\n                }\n                return msg;\n            } else {\n                if (true === this.strictMode) {\n                    this._error(`Message not found with id = ${msgId} and langId = ${langId}.`);\n                }\n                return msgId;\n            }\n        } else {\n            if (true === this.strictMode) {\n                this._error(`Dictionary not loaded with langId = ${langId}.`);\n            }\n            return msgId;\n        }\n    }\n\n\n    /**\n     * Fetches a plural translation.\n     * Tags are automatically wrapped with the curly bracket and will replace their dictionary string counterpart if found.\n     * If langId is null, the default lang will be used.\n     *\n     * The special tag {x} is used to replace the number in the translation.\n     */\n    _n(msgId, number, tags = {}, langId = null) {\n        if (null === langId) {\n            langId = this.defaultLang;\n        }\n        if (langId in this.dictionaries) {\n\n            var dict = this.dictionaries[langId];\n            if (msgId in dict) {\n\n                var pluralSelector = this.pluralSelectors[langId];\n                var pluralIndex = pluralSelector(number);\n                var messages = dict[msgId];\n                if (pluralIndex < messages.length) {\n                    var msg = dict[msgId][pluralIndex];\n                    for (var key in tags) {\n                        msg = msg.replace('{' + key + '}', tags[key]);\n                    }\n                    msg = msg.replace('{x}', number);\n                    return msg;\n                } else {\n                    if (true === this.strictMode) {\n                        this._error(`Plural form not found with id = ${msgId}, pluralIndex=${pluralIndex} and langId = ${langId}.`);\n                    }\n                    return msgId;\n                }\n\n            } else {\n                if (true === this.strictMode) {\n                    this._error(`Message not found with id = ${msgId} and langId = ${langId}.`);\n                }\n                return msgId;\n            }\n        } else {\n            if (true === this.strictMode) {\n                this._error(`Dictionary not loaded with langId = ${langId}.`);\n            }\n            return msgId;\n        }\n    }\n\n\n    //----------------------------------------\n    // PRIVATE STUFF\n    //----------------------------------------\n    _error(msg) {\n        throw new Error(\"Translatee error: \" + msg);\n    }\n\n    _getDefaultPluralSelector(langId) {\n        switch (langId) {\n            case 'en':\n            case 'eng':\n            case 'fr':\n            case 'fra':\n            default:\n\n                return function (n) {\n                    if (1 === n) {\n                        return 0;\n                    }\n                    return 1;\n                };\n        }\n    }\n}\n\n\nmodule.exports = Translatee;\n","class DropZoneHandler {\n\n    constructor(options) {\n        this.options = Object.assign({\n            container: null,\n            cssClass: \"dropzone-hover\",\n            onDrop: function (files) {\n                console.log(\"the files have been dropped.\", files);\n            },\n        }, options);\n\n\n        this.container = this.options.container;\n    }\n\n\n    start() {\n\n\n        const cssClass = this.options.cssClass;\n        const onDrop = this.options.onDrop;\n        const elDropZone = this.container;\n\n\n        function dragstart(e) {\n            e.stopPropagation();\n            e.preventDefault();\n\n            // https://stackoverflow.com/questions/10119514/html5-drag-drop-change-icon-cursor-while-dragging\n            e.dataTransfer.effectAllowed = \"copyMove\";\n        }\n\n        function dragenter(e) {\n            e.stopPropagation();\n            e.preventDefault();\n\n            // https://stackoverflow.com/questions/10119514/html5-drag-drop-change-icon-cursor-while-dragging\n            e.dataTransfer.dropEffect = \"copy\";\n        }\n\n        function dragover(e) {\n            e.stopPropagation();\n            e.preventDefault();\n            if (false === elDropZone.classList.contains(cssClass)) {\n                elDropZone.classList.add(cssClass);\n            }\n\n            // https://stackoverflow.com/questions/10119514/html5-drag-drop-change-icon-cursor-while-dragging\n            e.dataTransfer.dropEffect = \"copy\";\n        }\n\n        function dragleave(e) {\n            e.stopPropagation();\n            e.preventDefault();\n            elDropZone.classList.remove(cssClass);\n        }\n\n        function drop(e) {\n            e.stopPropagation();\n            e.preventDefault();\n            elDropZone.classList.remove(cssClass);\n\n\n            const dt = e.dataTransfer;\n            const files = dt.files;\n            let filesArray = [];\n            for (let i = 0; i < files.length; i++) {\n                filesArray.push(files[i]);\n            }\n            onDrop(filesArray);\n        }\n\n\n        elDropZone.addEventListener(\"dragstart\", dragstart, false);\n        elDropZone.addEventListener(\"dragenter\", dragenter, false);\n        elDropZone.addEventListener(\"dragleave\", dragleave, false);\n        elDropZone.addEventListener(\"dragover\", dragover, false);\n        elDropZone.addEventListener(\"drop\", drop, false);\n\n\n    }\n\n\n}\n\n\nmodule.exports = DropZoneHandler;","const jsx = require(\"js-extension-ling\");\n\nclass ChunkUploader {\n\n    constructor(options) {\n        /**\n         * Defaults: 5M every 100ms (50M every second)\n         */\n        this.timer = options.timer || 1;\n        this.sliceSize = options.chunkSize || 5 * 1024 * 1024;\n        this.serverUrl = options.serverUrl || \"/chunk-uploader.php\";\n\n\n        // this.onRequestError = function (e) {\n        //     console.log(\"ChunkUploader: an error occurred with the request.\")\n        // };\n        this.onChunkLoaded = options.onChunkLoaded || function (start, end, size, isLastChunk) {\n            let percent = Math.round(end / size * 100, 2);\n            console.log(`${percent}% of the chunks loaded`);\n        };\n\n        this.onChunkAborted = options.onChunkAborted || function (start, end, isLastChunk) {\n            console.log(`The chunk has been aborted: ${start}-${end}, isLastChunk=${isLastChunk}.`);\n        };\n        /**\n         * Sets a callback to control whether the received chunk is ok.\n         * Use this callback to interrupt the upload process at any chunk.\n         *\n         *\n         * The callback receives a clone of the response.\n         * (a clone is used so that the callback can analyze the response without consuming the real response\n         * body, which is eventually returned by the sendByChunks method.\n         *\n         * If the callback returns something else than true, the promise will be rejected.\n         * If the callback returns false, a default error message will be generated.\n         * If the callback returns a string, this string will be used as the error message.\n         *\n         * Note: this should be an async function.\n         *\n         */\n        this.onChunkResponseReceived = options.onChunkResponseReceived || async function (response) {\n            return true;\n        };\n\n        this._xhr = null;\n        this.controller = new AbortController();\n        this._is_aborted = false;\n        this._chunkFailed = false;\n\n    }\n\n\n    abort() {\n        this._is_aborted = true;\n        if (null !== this._xhr) {\n            this._xhr.abort();\n        } else {\n            this.controller.abort();\n        }\n    }\n\n\n    /**\n     * Returns a promise that resolves only when all chunks are uploaded.\n     * Note: you can use the abort method to abort at anytime before the promise resolves.\n     *\n     *\n     * - file: the js File/Blob object to upload.\n     * - data: map of key/value pairs to add to the request.\n     *      The following property names are reserved (i.e. you cannot use them):\n     *        - start\n     *        - end\n     *        - isLastChunk\n     *        - file\n     *\n     *\n     *\n     * Options:\n     *      - start: int=0, the byte of the blob to start the upload with.\n     *\n     *\n     * adapted from https://gist.github.com/shiawuen/1534477\n     **/\n    async sendByChunks(file, data, options) {\n\n        var start = options.start || 0;\n\n        this._is_aborted = false;\n        this._chunkFailed = false;\n        let $this = this;\n        return new Promise((resolve, reject) => {\n\n\n            var $this = this;\n            var size = file.size;\n\n            setTimeout(loop, this.timer);\n\n            async function loop() {\n                var isLastChunk = false;\n                var end = start + $this.sliceSize;\n\n                if (size - end <= 0) {\n                    isLastChunk = true;\n                    end = size;\n                }\n\n                var s = $this._slice(file, start, end);\n\n                if (false === $this._chunkFailed) {\n                    await $this._send(resolve, reject, s, start, end, size, isLastChunk, data);\n\n\n                    if (end < size) {\n                        start += $this.sliceSize;\n                        setTimeout(loop, $this.timer);\n                    }\n                }\n            }\n        });\n    }\n\n\n    //----------------------------------------\n    // PRIVATE\n    //----------------------------------------\n    async _send(resolve, reject, piece, start, end, size, isLastChunk, userData) {\n\n\n        var formdata = new FormData();\n        formdata.append('start', start);\n        formdata.append('end', end);\n        formdata.append('file', piece);\n        formdata.append('last_chunk', (isLastChunk ? 1 : 0));\n\n        formdata = jsx.toFormData(userData, formdata);\n\n\n        return this._sendViaFetch(resolve, reject, formdata, start, end, size, isLastChunk);\n        // return this._sendViaXMLHttpRequest(resolve, reject, formdata, start, end, size, isLastChunk);\n\n    }\n\n\n    /**\n     * Formalize file.slice\n     */\n    _slice(file, start, end) {\n        var slice = file.mozSlice ? file.mozSlice :\n            file.webkitSlice ? file.webkitSlice :\n                file.slice ? file.slice : this._noop;\n\n        return slice.bind(file)(start, end);\n    }\n\n    _noop() {\n\n    }\n\n\n    _sendViaFetch(resolve, reject, formdata, start, end, size, isLastChunk) {\n\n\n        return new Promise(async (_resolve, _reject) => {\n\n            let errMsg = `ChunkUploader: an error occurred with the chunk request (start:${start}, end: ${end}).`;\n\n            var response = await fetch(this.serverUrl, {\n                body: formdata,\n                method: \"POST\",\n                signal: this.controller.signal,\n            }).catch(e => {\n                if (true === this._is_aborted) {\n                    this.onChunkAborted(start, end, isLastChunk);\n                } else {\n                    _reject(errMsg);\n                }\n            });\n\n\n            if (true === this._is_aborted) {\n                this.onChunkAborted(start, end, isLastChunk);\n            } else {\n                if (true === response.ok) {\n\n\n                    let ret = await this.onChunkResponseReceived(response.clone());\n\n                    if (true === ret) {\n                        this.onChunkLoaded(start, end, size, isLastChunk);\n                        _resolve();\n\n                        if (true === isLastChunk) {\n                            resolve(response);\n                        }\n                    } else {\n                        if ('string' === typeof ret) {\n                            errMsg = ret;\n                        }\n                        _reject(errMsg);\n                    }\n                } else {\n                    _reject(errMsg);\n                }\n            }\n        }).catch((e) => {\n            reject(e);\n            this._chunkFailed = true;\n        });\n\n    }\n\n    /**\n     * Old, don't use this, I just keep it for reference\n     */\n    _sendViaXMLHttpRequest(resolve, reject, formdata, start, end, size, isLastChunk) {\n\n        return new Promise((_resolve, _reject) => {\n\n            var ajax = new XMLHttpRequest();\n            this._xhr = ajax;\n            ajax.open('POST', this.serverUrl, true);\n\n\n            // ajax.upload.addEventListener(\"progress\", function (e) {\n            //     var percent = Math.round((e.loaded / e.total) * 100, 2);\n            //     // console.log(\"progress\", e, percent, e.loaded, e.total);\n            // }, false);\n\n\n            // ajax.addEventListener(\"load\", function (e) {\n            //     e.stopPropagation();\n            //     e.preventDefault();\n            //     // console.log(\"load\", e);\n            // }, false);\n\n            ajax.addEventListener(\"error\", e => {\n                e.stopPropagation();\n                e.preventDefault();\n                let errMsg = `ChunkUploader: an error occurred with the chunk request (start:${start}, end: ${end}).`;\n                _reject(errMsg);\n                reject(errMsg);\n                // this.onRequestError(e);\n            }, false);\n\n\n            // ajax.addEventListener(\"abort\", function (e) {\n            //     e.stopPropagation();\n            //     e.preventDefault();\n            //     console.log(\"abort\", e);\n            // }, false);\n\n            ajax.onreadystatechange = () => {\n                if (ajax.readyState === 4) {\n                    this.onChunkLoaded(start, end, size, isLastChunk);\n\n                    _resolve();\n\n                    if (true === isLastChunk) {\n                        resolve(ajax);\n                    }\n                }\n            };\n            ajax.send(formdata);\n        });\n\n    }\n\n}\n\n\nmodule.exports = ChunkUploader;","module.exports = function atoa (a, n) { return Array.prototype.slice.call(a, n); }\n","var si = typeof setImmediate === 'function', tick;\nif (si) {\n  tick = function (fn) { setImmediate(fn); };\n} else {\n  tick = function (fn) { setTimeout(fn, 0); };\n}\n\nmodule.exports = tick;","'use strict';\n\nvar ticky = require('ticky');\n\nmodule.exports = function debounce (fn, args, ctx) {\n  if (!fn) { return; }\n  ticky(function run () {\n    fn.apply(ctx || null, args || []);\n  });\n};\n","'use strict';\n\nvar atoa = require('atoa');\nvar debounce = require('./debounce');\n\nmodule.exports = function emitter (thing, options) {\n  var opts = options || {};\n  var evt = {};\n  if (thing === undefined) { thing = {}; }\n  thing.on = function (type, fn) {\n    if (!evt[type]) {\n      evt[type] = [fn];\n    } else {\n      evt[type].push(fn);\n    }\n    return thing;\n  };\n  thing.once = function (type, fn) {\n    fn._once = true; // thing.off(fn) still works!\n    thing.on(type, fn);\n    return thing;\n  };\n  thing.off = function (type, fn) {\n    var c = arguments.length;\n    if (c === 1) {\n      delete evt[type];\n    } else if (c === 0) {\n      evt = {};\n    } else {\n      var et = evt[type];\n      if (!et) { return thing; }\n      et.splice(et.indexOf(fn), 1);\n    }\n    return thing;\n  };\n  thing.emit = function () {\n    var args = atoa(arguments);\n    return thing.emitterSnapshot(args.shift()).apply(this, args);\n  };\n  thing.emitterSnapshot = function (type) {\n    var et = (evt[type] || []).slice(0);\n    return function () {\n      var args = atoa(arguments);\n      var ctx = this || thing;\n      if (type === 'error' && opts.throws !== false && !et.length) { throw args.length === 1 ? args[0] : args; }\n      et.forEach(function emitter (listen) {\n        if (opts.async) { debounce(listen, args, ctx); } else { listen.apply(ctx, args); }\n        if (listen._once) { thing.off(type, listen); }\n      });\n      return thing;\n    };\n  };\n  return thing;\n};\n","\nvar NativeCustomEvent = global.CustomEvent;\n\nfunction useNative () {\n  try {\n    var p = new NativeCustomEvent('cat', { detail: { foo: 'bar' } });\n    return  'cat' === p.type && 'bar' === p.detail.foo;\n  } catch (e) {\n  }\n  return false;\n}\n\n/**\n * Cross-browser `CustomEvent` constructor.\n *\n * https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent.CustomEvent\n *\n * @public\n */\n\nmodule.exports = useNative() ? NativeCustomEvent :\n\n// IE >= 9\n'function' === typeof document.createEvent ? function CustomEvent (type, params) {\n  var e = document.createEvent('CustomEvent');\n  if (params) {\n    e.initCustomEvent(type, params.bubbles, params.cancelable, params.detail);\n  } else {\n    e.initCustomEvent(type, false, false, void 0);\n  }\n  return e;\n} :\n\n// IE <= 8\nfunction CustomEvent (type, params) {\n  var e = document.createEventObject();\n  e.type = type;\n  if (params) {\n    e.bubbles = Boolean(params.bubbles);\n    e.cancelable = Boolean(params.cancelable);\n    e.detail = params.detail;\n  } else {\n    e.bubbles = false;\n    e.cancelable = false;\n    e.detail = void 0;\n  }\n  return e;\n}\n","'use strict';\n\nvar eventmap = [];\nvar eventname = '';\nvar ron = /^on/;\n\nfor (eventname in global) {\n  if (ron.test(eventname)) {\n    eventmap.push(eventname.slice(2));\n  }\n}\n\nmodule.exports = eventmap;\n","'use strict';\n\nvar customEvent = require('custom-event');\nvar eventmap = require('./eventmap');\nvar doc = global.document;\nvar addEvent = addEventEasy;\nvar removeEvent = removeEventEasy;\nvar hardCache = [];\n\nif (!global.addEventListener) {\n  addEvent = addEventHard;\n  removeEvent = removeEventHard;\n}\n\nmodule.exports = {\n  add: addEvent,\n  remove: removeEvent,\n  fabricate: fabricateEvent\n};\n\nfunction addEventEasy (el, type, fn, capturing) {\n  return el.addEventListener(type, fn, capturing);\n}\n\nfunction addEventHard (el, type, fn) {\n  return el.attachEvent('on' + type, wrap(el, type, fn));\n}\n\nfunction removeEventEasy (el, type, fn, capturing) {\n  return el.removeEventListener(type, fn, capturing);\n}\n\nfunction removeEventHard (el, type, fn) {\n  var listener = unwrap(el, type, fn);\n  if (listener) {\n    return el.detachEvent('on' + type, listener);\n  }\n}\n\nfunction fabricateEvent (el, type, model) {\n  var e = eventmap.indexOf(type) === -1 ? makeCustomEvent() : makeClassicEvent();\n  if (el.dispatchEvent) {\n    el.dispatchEvent(e);\n  } else {\n    el.fireEvent('on' + type, e);\n  }\n  function makeClassicEvent () {\n    var e;\n    if (doc.createEvent) {\n      e = doc.createEvent('Event');\n      e.initEvent(type, true, true);\n    } else if (doc.createEventObject) {\n      e = doc.createEventObject();\n    }\n    return e;\n  }\n  function makeCustomEvent () {\n    return new customEvent(type, { detail: model });\n  }\n}\n\nfunction wrapperFactory (el, type, fn) {\n  return function wrapper (originalEvent) {\n    var e = originalEvent || global.event;\n    e.target = e.target || e.srcElement;\n    e.preventDefault = e.preventDefault || function preventDefault () { e.returnValue = false; };\n    e.stopPropagation = e.stopPropagation || function stopPropagation () { e.cancelBubble = true; };\n    e.which = e.which || e.keyCode;\n    fn.call(el, e);\n  };\n}\n\nfunction wrap (el, type, fn) {\n  var wrapper = unwrap(el, type, fn) || wrapperFactory(el, type, fn);\n  hardCache.push({\n    wrapper: wrapper,\n    element: el,\n    type: type,\n    fn: fn\n  });\n  return wrapper;\n}\n\nfunction unwrap (el, type, fn) {\n  var i = find(el, type, fn);\n  if (i) {\n    var wrapper = hardCache[i].wrapper;\n    hardCache.splice(i, 1); // free up a tad of memory\n    return wrapper;\n  }\n}\n\nfunction find (el, type, fn) {\n  var i, item;\n  for (i = 0; i < hardCache.length; i++) {\n    item = hardCache[i];\n    if (item.element === el && item.type === type && item.fn === fn) {\n      return i;\n    }\n  }\n}\n","'use strict';\n\nvar cache = {};\nvar start = '(?:^|\\\\s)';\nvar end = '(?:\\\\s|$)';\n\nfunction lookupClass (className) {\n  var cached = cache[className];\n  if (cached) {\n    cached.lastIndex = 0;\n  } else {\n    cache[className] = cached = new RegExp(start + className + end, 'g');\n  }\n  return cached;\n}\n\nfunction addClass (el, className) {\n  var current = el.className;\n  if (!current.length) {\n    el.className = className;\n  } else if (!lookupClass(className).test(current)) {\n    el.className += ' ' + className;\n  }\n}\n\nfunction rmClass (el, className) {\n  el.className = el.className.replace(lookupClass(className), ' ').trim();\n}\n\nmodule.exports = {\n  add: addClass,\n  rm: rmClass\n};\n","'use strict';\n\nvar emitter = require('contra/emitter');\nvar crossvent = require('crossvent');\nvar classes = require('./classes');\nvar doc = document;\nvar documentElement = doc.documentElement;\n\nfunction dragula (initialContainers, options) {\n  var len = arguments.length;\n  if (len === 1 && Array.isArray(initialContainers) === false) {\n    options = initialContainers;\n    initialContainers = [];\n  }\n  var _mirror; // mirror image\n  var _source; // source container\n  var _item; // item being dragged\n  var _offsetX; // reference x\n  var _offsetY; // reference y\n  var _moveX; // reference move x\n  var _moveY; // reference move y\n  var _initialSibling; // reference sibling when grabbed\n  var _currentSibling; // reference sibling now\n  var _copy; // item used for copying\n  var _renderTimer; // timer for setTimeout renderMirrorImage\n  var _lastDropTarget = null; // last container item was over\n  var _grabbed; // holds mousedown context until first mousemove\n\n  var o = options || {};\n  if (o.moves === void 0) { o.moves = always; }\n  if (o.accepts === void 0) { o.accepts = always; }\n  if (o.invalid === void 0) { o.invalid = invalidTarget; }\n  if (o.containers === void 0) { o.containers = initialContainers || []; }\n  if (o.isContainer === void 0) { o.isContainer = never; }\n  if (o.copy === void 0) { o.copy = false; }\n  if (o.copySortSource === void 0) { o.copySortSource = false; }\n  if (o.revertOnSpill === void 0) { o.revertOnSpill = false; }\n  if (o.removeOnSpill === void 0) { o.removeOnSpill = false; }\n  if (o.direction === void 0) { o.direction = 'vertical'; }\n  if (o.ignoreInputTextSelection === void 0) { o.ignoreInputTextSelection = true; }\n  if (o.mirrorContainer === void 0) { o.mirrorContainer = doc.body; }\n\n  var drake = emitter({\n    containers: o.containers,\n    start: manualStart,\n    end: end,\n    cancel: cancel,\n    remove: remove,\n    destroy: destroy,\n    canMove: canMove,\n    dragging: false\n  });\n\n  if (o.removeOnSpill === true) {\n    drake.on('over', spillOver).on('out', spillOut);\n  }\n\n  events();\n\n  return drake;\n\n  function isContainer (el) {\n    return drake.containers.indexOf(el) !== -1 || o.isContainer(el);\n  }\n\n  function events (remove) {\n    var op = remove ? 'remove' : 'add';\n    touchy(documentElement, op, 'mousedown', grab);\n    touchy(documentElement, op, 'mouseup', release);\n  }\n\n  function eventualMovements (remove) {\n    var op = remove ? 'remove' : 'add';\n    touchy(documentElement, op, 'mousemove', startBecauseMouseMoved);\n  }\n\n  function movements (remove) {\n    var op = remove ? 'remove' : 'add';\n    crossvent[op](documentElement, 'selectstart', preventGrabbed); // IE8\n    crossvent[op](documentElement, 'click', preventGrabbed);\n  }\n\n  function destroy () {\n    events(true);\n    release({});\n  }\n\n  function preventGrabbed (e) {\n    if (_grabbed) {\n      e.preventDefault();\n    }\n  }\n\n  function grab (e) {\n    _moveX = e.clientX;\n    _moveY = e.clientY;\n\n    var ignore = whichMouseButton(e) !== 1 || e.metaKey || e.ctrlKey;\n    if (ignore) {\n      return; // we only care about honest-to-god left clicks and touch events\n    }\n    var item = e.target;\n    var context = canStart(item);\n    if (!context) {\n      return;\n    }\n    _grabbed = context;\n    eventualMovements();\n    if (e.type === 'mousedown') {\n      if (isInput(item)) { // see also: https://github.com/bevacqua/dragula/issues/208\n        item.focus(); // fixes https://github.com/bevacqua/dragula/issues/176\n      } else {\n        e.preventDefault(); // fixes https://github.com/bevacqua/dragula/issues/155\n      }\n    }\n  }\n\n  function startBecauseMouseMoved (e) {\n    if (!_grabbed) {\n      return;\n    }\n    if (whichMouseButton(e) === 0) {\n      release({});\n      return; // when text is selected on an input and then dragged, mouseup doesn't fire. this is our only hope\n    }\n    // truthy check fixes #239, equality fixes #207\n    if (e.clientX !== void 0 && e.clientX === _moveX && e.clientY !== void 0 && e.clientY === _moveY) {\n      return;\n    }\n    if (o.ignoreInputTextSelection) {\n      var clientX = getCoord('clientX', e);\n      var clientY = getCoord('clientY', e);\n      var elementBehindCursor = doc.elementFromPoint(clientX, clientY);\n      if (isInput(elementBehindCursor)) {\n        return;\n      }\n    }\n\n    var grabbed = _grabbed; // call to end() unsets _grabbed\n    eventualMovements(true);\n    movements();\n    end();\n    start(grabbed);\n\n    var offset = getOffset(_item);\n    _offsetX = getCoord('pageX', e) - offset.left;\n    _offsetY = getCoord('pageY', e) - offset.top;\n\n    classes.add(_copy || _item, 'gu-transit');\n    renderMirrorImage();\n    drag(e);\n  }\n\n  function canStart (item) {\n    if (drake.dragging && _mirror) {\n      return;\n    }\n    if (isContainer(item)) {\n      return; // don't drag container itself\n    }\n    var handle = item;\n    while (getParent(item) && isContainer(getParent(item)) === false) {\n      if (o.invalid(item, handle)) {\n        return;\n      }\n      item = getParent(item); // drag target should be a top element\n      if (!item) {\n        return;\n      }\n    }\n    var source = getParent(item);\n    if (!source) {\n      return;\n    }\n    if (o.invalid(item, handle)) {\n      return;\n    }\n\n    var movable = o.moves(item, source, handle, nextEl(item));\n    if (!movable) {\n      return;\n    }\n\n    return {\n      item: item,\n      source: source\n    };\n  }\n\n  function canMove (item) {\n    return !!canStart(item);\n  }\n\n  function manualStart (item) {\n    var context = canStart(item);\n    if (context) {\n      start(context);\n    }\n  }\n\n  function start (context) {\n    if (isCopy(context.item, context.source)) {\n      _copy = context.item.cloneNode(true);\n      drake.emit('cloned', _copy, context.item, 'copy');\n    }\n\n    _source = context.source;\n    _item = context.item;\n    _initialSibling = _currentSibling = nextEl(context.item);\n\n    drake.dragging = true;\n    drake.emit('drag', _item, _source);\n  }\n\n  function invalidTarget () {\n    return false;\n  }\n\n  function end () {\n    if (!drake.dragging) {\n      return;\n    }\n    var item = _copy || _item;\n    drop(item, getParent(item));\n  }\n\n  function ungrab () {\n    _grabbed = false;\n    eventualMovements(true);\n    movements(true);\n  }\n\n  function release (e) {\n    ungrab();\n\n    if (!drake.dragging) {\n      return;\n    }\n    var item = _copy || _item;\n    var clientX = getCoord('clientX', e);\n    var clientY = getCoord('clientY', e);\n    var elementBehindCursor = getElementBehindPoint(_mirror, clientX, clientY);\n    var dropTarget = findDropTarget(elementBehindCursor, clientX, clientY);\n    if (dropTarget && ((_copy && o.copySortSource) || (!_copy || dropTarget !== _source))) {\n      drop(item, dropTarget);\n    } else if (o.removeOnSpill) {\n      remove();\n    } else {\n      cancel();\n    }\n  }\n\n  function drop (item, target) {\n    var parent = getParent(item);\n    if (_copy && o.copySortSource && target === _source) {\n      parent.removeChild(_item);\n    }\n    if (isInitialPlacement(target)) {\n      drake.emit('cancel', item, _source, _source);\n    } else {\n      drake.emit('drop', item, target, _source, _currentSibling);\n    }\n    cleanup();\n  }\n\n  function remove () {\n    if (!drake.dragging) {\n      return;\n    }\n    var item = _copy || _item;\n    var parent = getParent(item);\n    if (parent) {\n      parent.removeChild(item);\n    }\n    drake.emit(_copy ? 'cancel' : 'remove', item, parent, _source);\n    cleanup();\n  }\n\n  function cancel (revert) {\n    if (!drake.dragging) {\n      return;\n    }\n    var reverts = arguments.length > 0 ? revert : o.revertOnSpill;\n    var item = _copy || _item;\n    var parent = getParent(item);\n    var initial = isInitialPlacement(parent);\n    if (initial === false && reverts) {\n      if (_copy) {\n        if (parent) {\n          parent.removeChild(_copy);\n        }\n      } else {\n        _source.insertBefore(item, _initialSibling);\n      }\n    }\n    if (initial || reverts) {\n      drake.emit('cancel', item, _source, _source);\n    } else {\n      drake.emit('drop', item, parent, _source, _currentSibling);\n    }\n    cleanup();\n  }\n\n  function cleanup () {\n    var item = _copy || _item;\n    ungrab();\n    removeMirrorImage();\n    if (item) {\n      classes.rm(item, 'gu-transit');\n    }\n    if (_renderTimer) {\n      clearTimeout(_renderTimer);\n    }\n    drake.dragging = false;\n    if (_lastDropTarget) {\n      drake.emit('out', item, _lastDropTarget, _source);\n    }\n    drake.emit('dragend', item);\n    _source = _item = _copy = _initialSibling = _currentSibling = _renderTimer = _lastDropTarget = null;\n  }\n\n  function isInitialPlacement (target, s) {\n    var sibling;\n    if (s !== void 0) {\n      sibling = s;\n    } else if (_mirror) {\n      sibling = _currentSibling;\n    } else {\n      sibling = nextEl(_copy || _item);\n    }\n    return target === _source && sibling === _initialSibling;\n  }\n\n  function findDropTarget (elementBehindCursor, clientX, clientY) {\n    var target = elementBehindCursor;\n    while (target && !accepted()) {\n      target = getParent(target);\n    }\n    return target;\n\n    function accepted () {\n      var droppable = isContainer(target);\n      if (droppable === false) {\n        return false;\n      }\n\n      var immediate = getImmediateChild(target, elementBehindCursor);\n      var reference = getReference(target, immediate, clientX, clientY);\n      var initial = isInitialPlacement(target, reference);\n      if (initial) {\n        return true; // should always be able to drop it right back where it was\n      }\n      return o.accepts(_item, target, _source, reference);\n    }\n  }\n\n  function drag (e) {\n    if (!_mirror) {\n      return;\n    }\n    e.preventDefault();\n\n    var clientX = getCoord('clientX', e);\n    var clientY = getCoord('clientY', e);\n    var x = clientX - _offsetX;\n    var y = clientY - _offsetY;\n\n    _mirror.style.left = x + 'px';\n    _mirror.style.top = y + 'px';\n\n    var item = _copy || _item;\n    var elementBehindCursor = getElementBehindPoint(_mirror, clientX, clientY);\n    var dropTarget = findDropTarget(elementBehindCursor, clientX, clientY);\n    var changed = dropTarget !== null && dropTarget !== _lastDropTarget;\n    if (changed || dropTarget === null) {\n      out();\n      _lastDropTarget = dropTarget;\n      over();\n    }\n    var parent = getParent(item);\n    if (dropTarget === _source && _copy && !o.copySortSource) {\n      if (parent) {\n        parent.removeChild(item);\n      }\n      return;\n    }\n    var reference;\n    var immediate = getImmediateChild(dropTarget, elementBehindCursor);\n    if (immediate !== null) {\n      reference = getReference(dropTarget, immediate, clientX, clientY);\n    } else if (o.revertOnSpill === true && !_copy) {\n      reference = _initialSibling;\n      dropTarget = _source;\n    } else {\n      if (_copy && parent) {\n        parent.removeChild(item);\n      }\n      return;\n    }\n    if (\n      (reference === null && changed) ||\n      reference !== item &&\n      reference !== nextEl(item)\n    ) {\n      _currentSibling = reference;\n      dropTarget.insertBefore(item, reference);\n      drake.emit('shadow', item, dropTarget, _source);\n    }\n    function moved (type) { drake.emit(type, item, _lastDropTarget, _source); }\n    function over () { if (changed) { moved('over'); } }\n    function out () { if (_lastDropTarget) { moved('out'); } }\n  }\n\n  function spillOver (el) {\n    classes.rm(el, 'gu-hide');\n  }\n\n  function spillOut (el) {\n    if (drake.dragging) { classes.add(el, 'gu-hide'); }\n  }\n\n  function renderMirrorImage () {\n    if (_mirror) {\n      return;\n    }\n    var rect = _item.getBoundingClientRect();\n    _mirror = _item.cloneNode(true);\n    _mirror.style.width = getRectWidth(rect) + 'px';\n    _mirror.style.height = getRectHeight(rect) + 'px';\n    classes.rm(_mirror, 'gu-transit');\n    classes.add(_mirror, 'gu-mirror');\n    o.mirrorContainer.appendChild(_mirror);\n    touchy(documentElement, 'add', 'mousemove', drag);\n    classes.add(o.mirrorContainer, 'gu-unselectable');\n    drake.emit('cloned', _mirror, _item, 'mirror');\n  }\n\n  function removeMirrorImage () {\n    if (_mirror) {\n      classes.rm(o.mirrorContainer, 'gu-unselectable');\n      touchy(documentElement, 'remove', 'mousemove', drag);\n      getParent(_mirror).removeChild(_mirror);\n      _mirror = null;\n    }\n  }\n\n  function getImmediateChild (dropTarget, target) {\n    var immediate = target;\n    while (immediate !== dropTarget && getParent(immediate) !== dropTarget) {\n      immediate = getParent(immediate);\n    }\n    if (immediate === documentElement) {\n      return null;\n    }\n    return immediate;\n  }\n\n  function getReference (dropTarget, target, x, y) {\n    var horizontal = o.direction === 'horizontal';\n    var reference = target !== dropTarget ? inside() : outside();\n    return reference;\n\n    function outside () { // slower, but able to figure out any position\n      var len = dropTarget.children.length;\n      var i;\n      var el;\n      var rect;\n      for (i = 0; i < len; i++) {\n        el = dropTarget.children[i];\n        rect = el.getBoundingClientRect();\n        if (horizontal && (rect.left + rect.width / 2) > x) { return el; }\n        if (!horizontal && (rect.top + rect.height / 2) > y) { return el; }\n      }\n      return null;\n    }\n\n    function inside () { // faster, but only available if dropped inside a child element\n      var rect = target.getBoundingClientRect();\n      if (horizontal) {\n        return resolve(x > rect.left + getRectWidth(rect) / 2);\n      }\n      return resolve(y > rect.top + getRectHeight(rect) / 2);\n    }\n\n    function resolve (after) {\n      return after ? nextEl(target) : target;\n    }\n  }\n\n  function isCopy (item, container) {\n    return typeof o.copy === 'boolean' ? o.copy : o.copy(item, container);\n  }\n}\n\nfunction touchy (el, op, type, fn) {\n  var touch = {\n    mouseup: 'touchend',\n    mousedown: 'touchstart',\n    mousemove: 'touchmove'\n  };\n  var pointers = {\n    mouseup: 'pointerup',\n    mousedown: 'pointerdown',\n    mousemove: 'pointermove'\n  };\n  var microsoft = {\n    mouseup: 'MSPointerUp',\n    mousedown: 'MSPointerDown',\n    mousemove: 'MSPointerMove'\n  };\n  if (global.navigator.pointerEnabled) {\n    crossvent[op](el, pointers[type], fn);\n  } else if (global.navigator.msPointerEnabled) {\n    crossvent[op](el, microsoft[type], fn);\n  } else {\n    crossvent[op](el, touch[type], fn);\n    crossvent[op](el, type, fn);\n  }\n}\n\nfunction whichMouseButton (e) {\n  if (e.touches !== void 0) { return e.touches.length; }\n  if (e.which !== void 0 && e.which !== 0) { return e.which; } // see https://github.com/bevacqua/dragula/issues/261\n  if (e.buttons !== void 0) { return e.buttons; }\n  var button = e.button;\n  if (button !== void 0) { // see https://github.com/jquery/jquery/blob/99e8ff1baa7ae341e94bb89c3e84570c7c3ad9ea/src/event.js#L573-L575\n    return button & 1 ? 1 : button & 2 ? 3 : (button & 4 ? 2 : 0);\n  }\n}\n\nfunction getOffset (el) {\n  var rect = el.getBoundingClientRect();\n  return {\n    left: rect.left + getScroll('scrollLeft', 'pageXOffset'),\n    top: rect.top + getScroll('scrollTop', 'pageYOffset')\n  };\n}\n\nfunction getScroll (scrollProp, offsetProp) {\n  if (typeof global[offsetProp] !== 'undefined') {\n    return global[offsetProp];\n  }\n  if (documentElement.clientHeight) {\n    return documentElement[scrollProp];\n  }\n  return doc.body[scrollProp];\n}\n\nfunction getElementBehindPoint (point, x, y) {\n  var p = point || {};\n  var state = p.className;\n  var el;\n  p.className += ' gu-hide';\n  el = doc.elementFromPoint(x, y);\n  p.className = state;\n  return el;\n}\n\nfunction never () { return false; }\nfunction always () { return true; }\nfunction getRectWidth (rect) { return rect.width || (rect.right - rect.left); }\nfunction getRectHeight (rect) { return rect.height || (rect.bottom - rect.top); }\nfunction getParent (el) { return el.parentNode === doc ? null : el.parentNode; }\nfunction isInput (el) { return el.tagName === 'INPUT' || el.tagName === 'TEXTAREA' || el.tagName === 'SELECT' || isEditable(el); }\nfunction isEditable (el) {\n  if (!el) { return false; } // no parents were editable\n  if (el.contentEditable === 'false') { return false; } // stop the lookup\n  if (el.contentEditable === 'true') { return true; } // found a contentEditable element in the chain\n  return isEditable(getParent(el)); // contentEditable is set to 'inherit'\n}\n\nfunction nextEl (el) {\n  return el.nextElementSibling || manually();\n  function manually () {\n    var sibling = el;\n    do {\n      sibling = sibling.nextSibling;\n    } while (sibling && sibling.nodeType !== 1);\n    return sibling;\n  }\n}\n\nfunction getEventHost (e) {\n  // on touchend event, we have to use `e.changedTouches`\n  // see http://stackoverflow.com/questions/7192563/touchend-event-properties\n  // see https://github.com/bevacqua/dragula/issues/34\n  if (e.targetTouches && e.targetTouches.length) {\n    return e.targetTouches[0];\n  }\n  if (e.changedTouches && e.changedTouches.length) {\n    return e.changedTouches[0];\n  }\n  return e;\n}\n\nfunction getCoord (coord, e) {\n  var host = getEventHost(e);\n  var missMap = {\n    pageX: 'clientX', // IE8\n    pageY: 'clientY' // IE8\n  };\n  if (coord in missMap && !(coord in host) && missMap[coord] in host) {\n    coord = missMap[coord];\n  }\n  return host[coord];\n}\n\nmodule.exports = dragula;\n","import { cubicInOut, linear, cubicOut } from '../easing';\nimport { is_function, assign } from '../internal';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\n\nfunction blur(node, { delay = 0, duration = 400, easing = cubicInOut, amount = 5, opacity = 0 }) {\n    const style = getComputedStyle(node);\n    const target_opacity = +style.opacity;\n    const f = style.filter === 'none' ? '' : style.filter;\n    const od = target_opacity * (1 - opacity);\n    return {\n        delay,\n        duration,\n        easing,\n        css: (_t, u) => `opacity: ${target_opacity - (od * u)}; filter: ${f} blur(${u * amount}px);`\n    };\n}\nfunction fade(node, { delay = 0, duration = 400, easing = linear }) {\n    const o = +getComputedStyle(node).opacity;\n    return {\n        delay,\n        duration,\n        easing,\n        css: t => `opacity: ${t * o}`\n    };\n}\nfunction fly(node, { delay = 0, duration = 400, easing = cubicOut, x = 0, y = 0, opacity = 0 }) {\n    const style = getComputedStyle(node);\n    const target_opacity = +style.opacity;\n    const transform = style.transform === 'none' ? '' : style.transform;\n    const od = target_opacity * (1 - opacity);\n    return {\n        delay,\n        duration,\n        easing,\n        css: (t, u) => `\n\t\t\ttransform: ${transform} translate(${(1 - t) * x}px, ${(1 - t) * y}px);\n\t\t\topacity: ${target_opacity - (od * u)}`\n    };\n}\nfunction slide(node, { delay = 0, duration = 400, easing = cubicOut }) {\n    const style = getComputedStyle(node);\n    const opacity = +style.opacity;\n    const height = parseFloat(style.height);\n    const padding_top = parseFloat(style.paddingTop);\n    const padding_bottom = parseFloat(style.paddingBottom);\n    const margin_top = parseFloat(style.marginTop);\n    const margin_bottom = parseFloat(style.marginBottom);\n    const border_top_width = parseFloat(style.borderTopWidth);\n    const border_bottom_width = parseFloat(style.borderBottomWidth);\n    return {\n        delay,\n        duration,\n        easing,\n        css: t => `overflow: hidden;` +\n            `opacity: ${Math.min(t * 20, 1) * opacity};` +\n            `height: ${t * height}px;` +\n            `padding-top: ${t * padding_top}px;` +\n            `padding-bottom: ${t * padding_bottom}px;` +\n            `margin-top: ${t * margin_top}px;` +\n            `margin-bottom: ${t * margin_bottom}px;` +\n            `border-top-width: ${t * border_top_width}px;` +\n            `border-bottom-width: ${t * border_bottom_width}px;`\n    };\n}\nfunction scale(node, { delay = 0, duration = 400, easing = cubicOut, start = 0, opacity = 0 }) {\n    const style = getComputedStyle(node);\n    const target_opacity = +style.opacity;\n    const transform = style.transform === 'none' ? '' : style.transform;\n    const sd = 1 - start;\n    const od = target_opacity * (1 - opacity);\n    return {\n        delay,\n        duration,\n        easing,\n        css: (_t, u) => `\n\t\t\ttransform: ${transform} scale(${1 - (sd * u)});\n\t\t\topacity: ${target_opacity - (od * u)}\n\t\t`\n    };\n}\nfunction draw(node, { delay = 0, speed, duration, easing = cubicInOut }) {\n    const len = node.getTotalLength();\n    if (duration === undefined) {\n        if (speed === undefined) {\n            duration = 800;\n        }\n        else {\n            duration = len / speed;\n        }\n    }\n    else if (typeof duration === 'function') {\n        duration = duration(len);\n    }\n    return {\n        delay,\n        duration,\n        easing,\n        css: (t, u) => `stroke-dasharray: ${t * len} ${u * len}`\n    };\n}\nfunction crossfade(_a) {\n    var { fallback } = _a, defaults = __rest(_a, [\"fallback\"]);\n    const to_receive = new Map();\n    const to_send = new Map();\n    function crossfade(from, node, params) {\n        const { delay = 0, duration = d => Math.sqrt(d) * 30, easing = cubicOut } = assign(assign({}, defaults), params);\n        const to = node.getBoundingClientRect();\n        const dx = from.left - to.left;\n        const dy = from.top - to.top;\n        const dw = from.width / to.width;\n        const dh = from.height / to.height;\n        const d = Math.sqrt(dx * dx + dy * dy);\n        const style = getComputedStyle(node);\n        const transform = style.transform === 'none' ? '' : style.transform;\n        const opacity = +style.opacity;\n        return {\n            delay,\n            duration: is_function(duration) ? duration(d) : duration,\n            easing,\n            css: (t, u) => `\n\t\t\t\topacity: ${t * opacity};\n\t\t\t\ttransform-origin: top left;\n\t\t\t\ttransform: ${transform} translate(${u * dx}px,${u * dy}px) scale(${t + (1 - t) * dw}, ${t + (1 - t) * dh});\n\t\t\t`\n        };\n    }\n    function transition(items, counterparts, intro) {\n        return (node, params) => {\n            items.set(params.key, {\n                rect: node.getBoundingClientRect()\n            });\n            return () => {\n                if (counterparts.has(params.key)) {\n                    const { rect } = counterparts.get(params.key);\n                    counterparts.delete(params.key);\n                    return crossfade(rect, node, params);\n                }\n                // if the node is disappearing altogether\n                // (i.e. wasn't claimed by the other list)\n                // then we need to supply an outro\n                items.delete(params.key);\n                return fallback && fallback(node, params, intro);\n            };\n        };\n    }\n    return [\n        transition(to_send, to_receive, false),\n        transition(to_receive, to_send, true)\n    ];\n}\n\nexport { blur, crossfade, draw, fade, fly, scale, slide };\n","import { noop, safe_not_equal, subscribe, run_all, is_function } from '../internal';\nexport { get_store_value as get } from '../internal';\n\nconst subscriber_queue = [];\n/**\n * Creates a `Readable` store that allows reading by subscription.\n * @param value initial value\n * @param {StartStopNotifier}start start and stop notifications for subscriptions\n */\nfunction readable(value, start) {\n    return {\n        subscribe: writable(value, start).subscribe,\n    };\n}\n/**\n * Create a `Writable` store that allows both updating and reading by subscription.\n * @param {*=}value initial value\n * @param {StartStopNotifier=}start start and stop notifications for subscriptions\n */\nfunction writable(value, start = noop) {\n    let stop;\n    const subscribers = [];\n    function set(new_value) {\n        if (safe_not_equal(value, new_value)) {\n            value = new_value;\n            if (stop) { // store is ready\n                const run_queue = !subscriber_queue.length;\n                for (let i = 0; i < subscribers.length; i += 1) {\n                    const s = subscribers[i];\n                    s[1]();\n                    subscriber_queue.push(s, value);\n                }\n                if (run_queue) {\n                    for (let i = 0; i < subscriber_queue.length; i += 2) {\n                        subscriber_queue[i][0](subscriber_queue[i + 1]);\n                    }\n                    subscriber_queue.length = 0;\n                }\n            }\n        }\n    }\n    function update(fn) {\n        set(fn(value));\n    }\n    function subscribe(run, invalidate = noop) {\n        const subscriber = [run, invalidate];\n        subscribers.push(subscriber);\n        if (subscribers.length === 1) {\n            stop = start(set) || noop;\n        }\n        run(value);\n        return () => {\n            const index = subscribers.indexOf(subscriber);\n            if (index !== -1) {\n                subscribers.splice(index, 1);\n            }\n            if (subscribers.length === 0) {\n                stop();\n                stop = null;\n            }\n        };\n    }\n    return { set, update, subscribe };\n}\nfunction derived(stores, fn, initial_value) {\n    const single = !Array.isArray(stores);\n    const stores_array = single\n        ? [stores]\n        : stores;\n    const auto = fn.length < 2;\n    return readable(initial_value, (set) => {\n        let inited = false;\n        const values = [];\n        let pending = 0;\n        let cleanup = noop;\n        const sync = () => {\n            if (pending) {\n                return;\n            }\n            cleanup();\n            const result = fn(single ? values[0] : values, set);\n            if (auto) {\n                set(result);\n            }\n            else {\n                cleanup = is_function(result) ? result : noop;\n            }\n        };\n        const unsubscribers = stores_array.map((store, i) => subscribe(store, (value) => {\n            values[i] = value;\n            pending &= ~(1 << i);\n            if (inited) {\n                sync();\n            }\n        }, () => {\n            pending |= (1 << i);\n        }));\n        inited = true;\n        sync();\n        return function stop() {\n            run_all(unsubscribers);\n            cleanup();\n        };\n    });\n}\n\nexport { derived, readable, writable };\n","export default function draggable(node, _options = {}) {\n    let x;\n    let y;\n    let options = Object.assign({\n        /**\n         *\n         * Defines which mouse button(s) will initiate the drag.\n         *\n         * https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/button\n         * - main: left\n         * - aux: middle wheel\n         * - secondary: right\n         *\n         * You can pass an array.\n         */\n        startClick: \"main\",\n        /**\n         * Triggered before the dragging starts.\n         * Opportunity to prevent the dragging by returning false.\n         *\n         * The callback accepts the following parameters:\n         * - event: the mousedown event received by this action when the user mouses down the element.\n         */\n        onStartDragBefore: function (event) {\n\n\n        },\n    }, _options);\n    let isDragging = false;\n\n\n\n    function handleMousedown(event) {\n\n        //----------------------------------------\n        // MOUSE BUTTON FILTERING\n        //----------------------------------------\n        let startClick = options.startClick;\n        if (false === Array.isArray(options.startClick)) {\n            startClick = [options.startClick];\n        }\n        startClick = startClick.map(btn => {\n            let ret;\n            switch (btn) {\n                case 'main':\n                    ret = 0;\n                    break;\n                case 'aux':\n                    ret = 1;\n                    break;\n                case 'secondary':\n                    ret = 2;\n                    break;\n            }\n            return ret;\n        });\n        if (false === startClick.includes(event.button)) {\n            return;\n        }\n\n\n        let userRet = options.onStartDragBefore(event);\n        if (false === userRet) {\n            return;\n        }\n        isDragging = true;\n\n\n        //----------------------------------------\n        //\n        //----------------------------------------\n\n        x = event.clientX;\n        y = event.clientY;\n\n        node.dispatchEvent(new CustomEvent('dragstart', {\n            detail: { x, y }\n        }));\n\n\n        window.addEventListener('mousemove', handleMousemove);\n        window.addEventListener('mouseup', handleMouseup);\n\n        // document.body.addEventListener('mouseleave', handleMouseLeave);\n        // document.body.addEventListener('mouseenter', handleMouseEnter);\n\n\n        document.body\n\n\n    }\n\n    function handleMouseLeave(event) {\n        console.log(\"mouse leaving body\");\n    }\n\n    function handleMouseEnter(event) {\n        console.log(\"mouse enters body\");\n    }\n\n\n\n    function handleMousemove(event) {\n        if (false === isDragging) {\n            return;\n        }\n\n        const dx = event.clientX - x;\n        const dy = event.clientY - y;\n        x = event.clientX;\n        y = event.clientY;\n\n        node.dispatchEvent(new CustomEvent('dragmove', {\n            detail: { x, y, dx, dy }\n        }));\n    }\n\n    function handleMouseup(event) {\n        isDragging = false;        \n        x = event.clientX;\n        y = event.clientY;\n\n        node.dispatchEvent(new CustomEvent('dragend', {\n            detail: { x, y }\n        }));\n\n        window.removeEventListener('mousemove', handleMousemove);\n        window.removeEventListener('mouseup', handleMouseup);\n    }\n\n    node.addEventListener('mousedown', handleMousedown);\n\n    return {\n        destroy() {\n            node.removeEventListener('mousedown', handleMousedown);\n        }\n    };\n}","<script>\n\n\n    import {writable} from 'svelte/store';\n    import {createEventDispatcher} from 'svelte';\n    import {beforeUpdate} from 'svelte';\n    import draggable from \"svelte-action-draggable\";\n\n\n    export let options = {};\n    export let open = true;\n\n\n    let maxTop = 0;\n    let maxRight = 0;\n    let maxBottom = 0;\n    let maxLeft = 0;\n\n\n    const coords = writable({x: 0, y: 0});\n    const styleId = \"my-draggable-tmp-style\";\n    const dispatch = createEventDispatcher();\n    let draggableOptions = {\n        startClick: \"main\",\n        onStartDragBefore: function (event) {\n\n            if (null !== modalOptions.dragHandle) {\n                let dragHandle = event.target.closest(modalOptions.dragHandle);\n                if (null === dragHandle) {\n                    return false;\n                }\n            }\n        },\n    };\n    let displayStyle = '';\n\n\n    let modalOptions = Object.assign({\n        /**\n         * A selector identifying the drag handle.\n         * If null, the whole modal serves as a drag handle.\n         */\n        dragHandle: null,\n        /**\n         * Whether the modal should be trapped into the viewport.\n         * If false, the user can drag the modal out of the window (and loose it).\n         */\n        keepInViewport: true,\n    }, options);\n\n\n    function handleDragMove(event) {\n        coords.update($coords => {\n            let newX = $coords.x + event.detail.dx;\n            let newY = $coords.y + event.detail.dy;\n\n\n            if (true === modalOptions.keepInViewport) {\n                if (newX < maxLeft) {\n                    newX = maxLeft;\n                }\n                if (newX > maxRight) {\n                    newX = maxRight;\n                }\n                if (newY < maxTop) {\n                    newY = maxTop;\n                }\n                if (newY > maxBottom) {\n                    newY = maxBottom;\n                }\n            }\n\n            return ({\n                x: newX,\n                y: newY,\n            });\n        });\n\n        dispatch('dragmove', event.detail);\n\n\n    }\n\n    function handleDragStart(event) {\n\n        //----------------------------------------\n        // REMOVE BACKGROUND SELECTION WHILE DRAGGING\n        //----------------------------------------\n        let elStyle = document.getElementById(styleId);\n        if (null === elStyle) {\n            var elHead = document.getElementsByTagName('head')[0];\n            elStyle = document.createElement('style');\n            elStyle.type = 'text/css';\n            elHead.appendChild(elStyle);\n            elStyle.id = styleId;\n            elStyle.innerHTML = '.draggable-unselectable > * {user-select: none;}';\n        }\n        this.classList.add('draggable-unselectable');\n\n\n        if (true === modalOptions.keepInViewport) {\n\n            let r = event.target.firstChild.getBoundingClientRect();\n            maxLeft = -r.left + $coords.x;\n            maxRight = window.innerWidth - r.right + $coords.x;\n            maxTop = -r.top + $coords.y;\n            maxBottom = window.innerHeight - r.bottom + $coords.y;\n        }\n\n    }\n\n    function handleDragEnd(event) {\n        this.classList.remove('draggable-unselectable');\n        let elStyle = document.getElementById(styleId);\n        if (null !== elStyle) {\n            elStyle.remove();\n        }\n    }\n\n\n    //----------------------------------------\n    // POLYFILLS\n    //----------------------------------------\n    // CustomEvent polyfill ie11\n    // https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent#Polyfill\n    (function () {\n        if (typeof window.CustomEvent === \"function\") return false;\n\n        function CustomEvent(event, params) {\n            params = params || {bubbles: false, cancelable: false, detail: null};\n            var evt = document.createEvent('CustomEvent');\n            evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n            return evt;\n        }\n\n        window.CustomEvent = CustomEvent;\n    })();\n\n\n    beforeUpdate(() => {\n        if (true === open) {\n            // note: could be display: block, or display: inline, or etc... so we don't set it\n            displayStyle = '';\n        } else {\n            displayStyle = 'display: none;'\n        }\n    });\n\n    function closeModal() {\n        open = false;\n    }\n\n\n</script>\n\n\n<div\n        use:draggable={draggableOptions}\n        on:dragstart={handleDragStart}\n        on:dragmove={handleDragMove}\n        on:dragend={handleDragEnd}\n        style=\"\n        {displayStyle}\n        transform: translate({$coords.x}px,{$coords.y}px)\n        \"\n>\n    <slot></slot>\n</div>\n\n\n","/*!\n * Cropper.js v1.5.6\n * https://fengyuanchen.github.io/cropperjs\n *\n * Copyright 2015-present Chen Fengyuan\n * Released under the MIT license\n *\n * Date: 2019-10-04T04:33:48.372Z\n */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, global.Cropper = factory());\n}(this, function () { 'use strict';\n\n  function _typeof(obj) {\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function (obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function (obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function ownKeys(object, enumerableOnly) {\n    var keys = Object.keys(object);\n\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      if (enumerableOnly) symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n      keys.push.apply(keys, symbols);\n    }\n\n    return keys;\n  }\n\n  function _objectSpread2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n\n      if (i % 2) {\n        ownKeys(source, true).forEach(function (key) {\n          _defineProperty(target, key, source[key]);\n        });\n      } else if (Object.getOwnPropertyDescriptors) {\n        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n      } else {\n        ownKeys(source).forEach(function (key) {\n          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n        });\n      }\n    }\n\n    return target;\n  }\n\n  function _toConsumableArray(arr) {\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n  }\n\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n      return arr2;\n    }\n  }\n\n  function _iterableToArray(iter) {\n    if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n  }\n\n  function _nonIterableSpread() {\n    throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n  }\n\n  var IS_BROWSER = typeof window !== 'undefined' && typeof window.document !== 'undefined';\n  var WINDOW = IS_BROWSER ? window : {};\n  var IS_TOUCH_DEVICE = IS_BROWSER ? 'ontouchstart' in WINDOW.document.documentElement : false;\n  var HAS_POINTER_EVENT = IS_BROWSER ? 'PointerEvent' in WINDOW : false;\n  var NAMESPACE = 'cropper'; // Actions\n\n  var ACTION_ALL = 'all';\n  var ACTION_CROP = 'crop';\n  var ACTION_MOVE = 'move';\n  var ACTION_ZOOM = 'zoom';\n  var ACTION_EAST = 'e';\n  var ACTION_WEST = 'w';\n  var ACTION_SOUTH = 's';\n  var ACTION_NORTH = 'n';\n  var ACTION_NORTH_EAST = 'ne';\n  var ACTION_NORTH_WEST = 'nw';\n  var ACTION_SOUTH_EAST = 'se';\n  var ACTION_SOUTH_WEST = 'sw'; // Classes\n\n  var CLASS_CROP = \"\".concat(NAMESPACE, \"-crop\");\n  var CLASS_DISABLED = \"\".concat(NAMESPACE, \"-disabled\");\n  var CLASS_HIDDEN = \"\".concat(NAMESPACE, \"-hidden\");\n  var CLASS_HIDE = \"\".concat(NAMESPACE, \"-hide\");\n  var CLASS_INVISIBLE = \"\".concat(NAMESPACE, \"-invisible\");\n  var CLASS_MODAL = \"\".concat(NAMESPACE, \"-modal\");\n  var CLASS_MOVE = \"\".concat(NAMESPACE, \"-move\"); // Data keys\n\n  var DATA_ACTION = \"\".concat(NAMESPACE, \"Action\");\n  var DATA_PREVIEW = \"\".concat(NAMESPACE, \"Preview\"); // Drag modes\n\n  var DRAG_MODE_CROP = 'crop';\n  var DRAG_MODE_MOVE = 'move';\n  var DRAG_MODE_NONE = 'none'; // Events\n\n  var EVENT_CROP = 'crop';\n  var EVENT_CROP_END = 'cropend';\n  var EVENT_CROP_MOVE = 'cropmove';\n  var EVENT_CROP_START = 'cropstart';\n  var EVENT_DBLCLICK = 'dblclick';\n  var EVENT_TOUCH_START = IS_TOUCH_DEVICE ? 'touchstart' : 'mousedown';\n  var EVENT_TOUCH_MOVE = IS_TOUCH_DEVICE ? 'touchmove' : 'mousemove';\n  var EVENT_TOUCH_END = IS_TOUCH_DEVICE ? 'touchend touchcancel' : 'mouseup';\n  var EVENT_POINTER_DOWN = HAS_POINTER_EVENT ? 'pointerdown' : EVENT_TOUCH_START;\n  var EVENT_POINTER_MOVE = HAS_POINTER_EVENT ? 'pointermove' : EVENT_TOUCH_MOVE;\n  var EVENT_POINTER_UP = HAS_POINTER_EVENT ? 'pointerup pointercancel' : EVENT_TOUCH_END;\n  var EVENT_READY = 'ready';\n  var EVENT_RESIZE = 'resize';\n  var EVENT_WHEEL = 'wheel';\n  var EVENT_ZOOM = 'zoom'; // Mime types\n\n  var MIME_TYPE_JPEG = 'image/jpeg'; // RegExps\n\n  var REGEXP_ACTIONS = /^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/;\n  var REGEXP_DATA_URL = /^data:/;\n  var REGEXP_DATA_URL_JPEG = /^data:image\\/jpeg;base64,/;\n  var REGEXP_TAG_NAME = /^img|canvas$/i; // Misc\n  // Inspired by the default width and height of a canvas element.\n\n  var MIN_CONTAINER_WIDTH = 200;\n  var MIN_CONTAINER_HEIGHT = 100;\n\n  var DEFAULTS = {\n    // Define the view mode of the cropper\n    viewMode: 0,\n    // 0, 1, 2, 3\n    // Define the dragging mode of the cropper\n    dragMode: DRAG_MODE_CROP,\n    // 'crop', 'move' or 'none'\n    // Define the initial aspect ratio of the crop box\n    initialAspectRatio: NaN,\n    // Define the aspect ratio of the crop box\n    aspectRatio: NaN,\n    // An object with the previous cropping result data\n    data: null,\n    // A selector for adding extra containers to preview\n    preview: '',\n    // Re-render the cropper when resize the window\n    responsive: true,\n    // Restore the cropped area after resize the window\n    restore: true,\n    // Check if the current image is a cross-origin image\n    checkCrossOrigin: true,\n    // Check the current image's Exif Orientation information\n    checkOrientation: true,\n    // Show the black modal\n    modal: true,\n    // Show the dashed lines for guiding\n    guides: true,\n    // Show the center indicator for guiding\n    center: true,\n    // Show the white modal to highlight the crop box\n    highlight: true,\n    // Show the grid background\n    background: true,\n    // Enable to crop the image automatically when initialize\n    autoCrop: true,\n    // Define the percentage of automatic cropping area when initializes\n    autoCropArea: 0.8,\n    // Enable to move the image\n    movable: true,\n    // Enable to rotate the image\n    rotatable: true,\n    // Enable to scale the image\n    scalable: true,\n    // Enable to zoom the image\n    zoomable: true,\n    // Enable to zoom the image by dragging touch\n    zoomOnTouch: true,\n    // Enable to zoom the image by wheeling mouse\n    zoomOnWheel: true,\n    // Define zoom ratio when zoom the image by wheeling mouse\n    wheelZoomRatio: 0.1,\n    // Enable to move the crop box\n    cropBoxMovable: true,\n    // Enable to resize the crop box\n    cropBoxResizable: true,\n    // Toggle drag mode between \"crop\" and \"move\" when click twice on the cropper\n    toggleDragModeOnDblclick: true,\n    // Size limitation\n    minCanvasWidth: 0,\n    minCanvasHeight: 0,\n    minCropBoxWidth: 0,\n    minCropBoxHeight: 0,\n    minContainerWidth: 200,\n    minContainerHeight: 100,\n    // Shortcuts of events\n    ready: null,\n    cropstart: null,\n    cropmove: null,\n    cropend: null,\n    crop: null,\n    zoom: null\n  };\n\n  var TEMPLATE = '<div class=\"cropper-container\" touch-action=\"none\">' + '<div class=\"cropper-wrap-box\">' + '<div class=\"cropper-canvas\"></div>' + '</div>' + '<div class=\"cropper-drag-box\"></div>' + '<div class=\"cropper-crop-box\">' + '<span class=\"cropper-view-box\"></span>' + '<span class=\"cropper-dashed dashed-h\"></span>' + '<span class=\"cropper-dashed dashed-v\"></span>' + '<span class=\"cropper-center\"></span>' + '<span class=\"cropper-face\"></span>' + '<span class=\"cropper-line line-e\" data-cropper-action=\"e\"></span>' + '<span class=\"cropper-line line-n\" data-cropper-action=\"n\"></span>' + '<span class=\"cropper-line line-w\" data-cropper-action=\"w\"></span>' + '<span class=\"cropper-line line-s\" data-cropper-action=\"s\"></span>' + '<span class=\"cropper-point point-e\" data-cropper-action=\"e\"></span>' + '<span class=\"cropper-point point-n\" data-cropper-action=\"n\"></span>' + '<span class=\"cropper-point point-w\" data-cropper-action=\"w\"></span>' + '<span class=\"cropper-point point-s\" data-cropper-action=\"s\"></span>' + '<span class=\"cropper-point point-ne\" data-cropper-action=\"ne\"></span>' + '<span class=\"cropper-point point-nw\" data-cropper-action=\"nw\"></span>' + '<span class=\"cropper-point point-sw\" data-cropper-action=\"sw\"></span>' + '<span class=\"cropper-point point-se\" data-cropper-action=\"se\"></span>' + '</div>' + '</div>';\n\n  /**\n   * Check if the given value is not a number.\n   */\n\n  var isNaN = Number.isNaN || WINDOW.isNaN;\n  /**\n   * Check if the given value is a number.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a number, else `false`.\n   */\n\n  function isNumber(value) {\n    return typeof value === 'number' && !isNaN(value);\n  }\n  /**\n   * Check if the given value is a positive number.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a positive number, else `false`.\n   */\n\n  var isPositiveNumber = function isPositiveNumber(value) {\n    return value > 0 && value < Infinity;\n  };\n  /**\n   * Check if the given value is undefined.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is undefined, else `false`.\n   */\n\n  function isUndefined(value) {\n    return typeof value === 'undefined';\n  }\n  /**\n   * Check if the given value is an object.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is an object, else `false`.\n   */\n\n  function isObject(value) {\n    return _typeof(value) === 'object' && value !== null;\n  }\n  var hasOwnProperty = Object.prototype.hasOwnProperty;\n  /**\n   * Check if the given value is a plain object.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a plain object, else `false`.\n   */\n\n  function isPlainObject(value) {\n    if (!isObject(value)) {\n      return false;\n    }\n\n    try {\n      var _constructor = value.constructor;\n      var prototype = _constructor.prototype;\n      return _constructor && prototype && hasOwnProperty.call(prototype, 'isPrototypeOf');\n    } catch (error) {\n      return false;\n    }\n  }\n  /**\n   * Check if the given value is a function.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a function, else `false`.\n   */\n\n  function isFunction(value) {\n    return typeof value === 'function';\n  }\n  var slice = Array.prototype.slice;\n  /**\n   * Convert array-like or iterable object to an array.\n   * @param {*} value - The value to convert.\n   * @returns {Array} Returns a new array.\n   */\n\n  function toArray(value) {\n    return Array.from ? Array.from(value) : slice.call(value);\n  }\n  /**\n   * Iterate the given data.\n   * @param {*} data - The data to iterate.\n   * @param {Function} callback - The process function for each element.\n   * @returns {*} The original data.\n   */\n\n  function forEach(data, callback) {\n    if (data && isFunction(callback)) {\n      if (Array.isArray(data) || isNumber(data.length)\n      /* array-like */\n      ) {\n          toArray(data).forEach(function (value, key) {\n            callback.call(data, value, key, data);\n          });\n        } else if (isObject(data)) {\n        Object.keys(data).forEach(function (key) {\n          callback.call(data, data[key], key, data);\n        });\n      }\n    }\n\n    return data;\n  }\n  /**\n   * Extend the given object.\n   * @param {*} target - The target object to extend.\n   * @param {*} args - The rest objects for merging to the target object.\n   * @returns {Object} The extended object.\n   */\n\n  var assign = Object.assign || function assign(target) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    if (isObject(target) && args.length > 0) {\n      args.forEach(function (arg) {\n        if (isObject(arg)) {\n          Object.keys(arg).forEach(function (key) {\n            target[key] = arg[key];\n          });\n        }\n      });\n    }\n\n    return target;\n  };\n  var REGEXP_DECIMALS = /\\.\\d*(?:0|9){12}\\d*$/;\n  /**\n   * Normalize decimal number.\n   * Check out {@link http://0.30000000000000004.com/}\n   * @param {number} value - The value to normalize.\n   * @param {number} [times=100000000000] - The times for normalizing.\n   * @returns {number} Returns the normalized number.\n   */\n\n  function normalizeDecimalNumber(value) {\n    var times = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 100000000000;\n    return REGEXP_DECIMALS.test(value) ? Math.round(value * times) / times : value;\n  }\n  var REGEXP_SUFFIX = /^width|height|left|top|marginLeft|marginTop$/;\n  /**\n   * Apply styles to the given element.\n   * @param {Element} element - The target element.\n   * @param {Object} styles - The styles for applying.\n   */\n\n  function setStyle(element, styles) {\n    var style = element.style;\n    forEach(styles, function (value, property) {\n      if (REGEXP_SUFFIX.test(property) && isNumber(value)) {\n        value = \"\".concat(value, \"px\");\n      }\n\n      style[property] = value;\n    });\n  }\n  /**\n   * Check if the given element has a special class.\n   * @param {Element} element - The element to check.\n   * @param {string} value - The class to search.\n   * @returns {boolean} Returns `true` if the special class was found.\n   */\n\n  function hasClass(element, value) {\n    return element.classList ? element.classList.contains(value) : element.className.indexOf(value) > -1;\n  }\n  /**\n   * Add classes to the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be added.\n   */\n\n  function addClass(element, value) {\n    if (!value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        addClass(elem, value);\n      });\n      return;\n    }\n\n    if (element.classList) {\n      element.classList.add(value);\n      return;\n    }\n\n    var className = element.className.trim();\n\n    if (!className) {\n      element.className = value;\n    } else if (className.indexOf(value) < 0) {\n      element.className = \"\".concat(className, \" \").concat(value);\n    }\n  }\n  /**\n   * Remove classes from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be removed.\n   */\n\n  function removeClass(element, value) {\n    if (!value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        removeClass(elem, value);\n      });\n      return;\n    }\n\n    if (element.classList) {\n      element.classList.remove(value);\n      return;\n    }\n\n    if (element.className.indexOf(value) >= 0) {\n      element.className = element.className.replace(value, '');\n    }\n  }\n  /**\n   * Add or remove classes from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be toggled.\n   * @param {boolean} added - Add only.\n   */\n\n  function toggleClass(element, value, added) {\n    if (!value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        toggleClass(elem, value, added);\n      });\n      return;\n    } // IE10-11 doesn't support the second parameter of `classList.toggle`\n\n\n    if (added) {\n      addClass(element, value);\n    } else {\n      removeClass(element, value);\n    }\n  }\n  var REGEXP_CAMEL_CASE = /([a-z\\d])([A-Z])/g;\n  /**\n   * Transform the given string from camelCase to kebab-case\n   * @param {string} value - The value to transform.\n   * @returns {string} The transformed value.\n   */\n\n  function toParamCase(value) {\n    return value.replace(REGEXP_CAMEL_CASE, '$1-$2').toLowerCase();\n  }\n  /**\n   * Get data from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to get.\n   * @returns {string} The data value.\n   */\n\n  function getData(element, name) {\n    if (isObject(element[name])) {\n      return element[name];\n    }\n\n    if (element.dataset) {\n      return element.dataset[name];\n    }\n\n    return element.getAttribute(\"data-\".concat(toParamCase(name)));\n  }\n  /**\n   * Set data to the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to set.\n   * @param {string} data - The data value.\n   */\n\n  function setData(element, name, data) {\n    if (isObject(data)) {\n      element[name] = data;\n    } else if (element.dataset) {\n      element.dataset[name] = data;\n    } else {\n      element.setAttribute(\"data-\".concat(toParamCase(name)), data);\n    }\n  }\n  /**\n   * Remove data from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to remove.\n   */\n\n  function removeData(element, name) {\n    if (isObject(element[name])) {\n      try {\n        delete element[name];\n      } catch (error) {\n        element[name] = undefined;\n      }\n    } else if (element.dataset) {\n      // #128 Safari not allows to delete dataset property\n      try {\n        delete element.dataset[name];\n      } catch (error) {\n        element.dataset[name] = undefined;\n      }\n    } else {\n      element.removeAttribute(\"data-\".concat(toParamCase(name)));\n    }\n  }\n  var REGEXP_SPACES = /\\s\\s*/;\n\n  var onceSupported = function () {\n    var supported = false;\n\n    if (IS_BROWSER) {\n      var once = false;\n\n      var listener = function listener() {};\n\n      var options = Object.defineProperty({}, 'once', {\n        get: function get() {\n          supported = true;\n          return once;\n        },\n\n        /**\n         * This setter can fix a `TypeError` in strict mode\n         * {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Getter_only}\n         * @param {boolean} value - The value to set\n         */\n        set: function set(value) {\n          once = value;\n        }\n      });\n      WINDOW.addEventListener('test', listener, options);\n      WINDOW.removeEventListener('test', listener, options);\n    }\n\n    return supported;\n  }();\n  /**\n   * Remove event listener from the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Function} listener - The event listener.\n   * @param {Object} options - The event options.\n   */\n\n\n  function removeListener(element, type, listener) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var handler = listener;\n    type.trim().split(REGEXP_SPACES).forEach(function (event) {\n      if (!onceSupported) {\n        var listeners = element.listeners;\n\n        if (listeners && listeners[event] && listeners[event][listener]) {\n          handler = listeners[event][listener];\n          delete listeners[event][listener];\n\n          if (Object.keys(listeners[event]).length === 0) {\n            delete listeners[event];\n          }\n\n          if (Object.keys(listeners).length === 0) {\n            delete element.listeners;\n          }\n        }\n      }\n\n      element.removeEventListener(event, handler, options);\n    });\n  }\n  /**\n   * Add event listener to the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Function} listener - The event listener.\n   * @param {Object} options - The event options.\n   */\n\n  function addListener(element, type, listener) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var _handler = listener;\n    type.trim().split(REGEXP_SPACES).forEach(function (event) {\n      if (options.once && !onceSupported) {\n        var _element$listeners = element.listeners,\n            listeners = _element$listeners === void 0 ? {} : _element$listeners;\n\n        _handler = function handler() {\n          delete listeners[event][listener];\n          element.removeEventListener(event, _handler, options);\n\n          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            args[_key2] = arguments[_key2];\n          }\n\n          listener.apply(element, args);\n        };\n\n        if (!listeners[event]) {\n          listeners[event] = {};\n        }\n\n        if (listeners[event][listener]) {\n          element.removeEventListener(event, listeners[event][listener], options);\n        }\n\n        listeners[event][listener] = _handler;\n        element.listeners = listeners;\n      }\n\n      element.addEventListener(event, _handler, options);\n    });\n  }\n  /**\n   * Dispatch event on the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Object} data - The additional event data.\n   * @returns {boolean} Indicate if the event is default prevented or not.\n   */\n\n  function dispatchEvent(element, type, data) {\n    var event; // Event and CustomEvent on IE9-11 are global objects, not constructors\n\n    if (isFunction(Event) && isFunction(CustomEvent)) {\n      event = new CustomEvent(type, {\n        detail: data,\n        bubbles: true,\n        cancelable: true\n      });\n    } else {\n      event = document.createEvent('CustomEvent');\n      event.initCustomEvent(type, true, true, data);\n    }\n\n    return element.dispatchEvent(event);\n  }\n  /**\n   * Get the offset base on the document.\n   * @param {Element} element - The target element.\n   * @returns {Object} The offset data.\n   */\n\n  function getOffset(element) {\n    var box = element.getBoundingClientRect();\n    return {\n      left: box.left + (window.pageXOffset - document.documentElement.clientLeft),\n      top: box.top + (window.pageYOffset - document.documentElement.clientTop)\n    };\n  }\n  var location = WINDOW.location;\n  var REGEXP_ORIGINS = /^(\\w+:)\\/\\/([^:/?#]*):?(\\d*)/i;\n  /**\n   * Check if the given URL is a cross origin URL.\n   * @param {string} url - The target URL.\n   * @returns {boolean} Returns `true` if the given URL is a cross origin URL, else `false`.\n   */\n\n  function isCrossOriginURL(url) {\n    var parts = url.match(REGEXP_ORIGINS);\n    return parts !== null && (parts[1] !== location.protocol || parts[2] !== location.hostname || parts[3] !== location.port);\n  }\n  /**\n   * Add timestamp to the given URL.\n   * @param {string} url - The target URL.\n   * @returns {string} The result URL.\n   */\n\n  function addTimestamp(url) {\n    var timestamp = \"timestamp=\".concat(new Date().getTime());\n    return url + (url.indexOf('?') === -1 ? '?' : '&') + timestamp;\n  }\n  /**\n   * Get transforms base on the given object.\n   * @param {Object} obj - The target object.\n   * @returns {string} A string contains transform values.\n   */\n\n  function getTransforms(_ref) {\n    var rotate = _ref.rotate,\n        scaleX = _ref.scaleX,\n        scaleY = _ref.scaleY,\n        translateX = _ref.translateX,\n        translateY = _ref.translateY;\n    var values = [];\n\n    if (isNumber(translateX) && translateX !== 0) {\n      values.push(\"translateX(\".concat(translateX, \"px)\"));\n    }\n\n    if (isNumber(translateY) && translateY !== 0) {\n      values.push(\"translateY(\".concat(translateY, \"px)\"));\n    } // Rotate should come first before scale to match orientation transform\n\n\n    if (isNumber(rotate) && rotate !== 0) {\n      values.push(\"rotate(\".concat(rotate, \"deg)\"));\n    }\n\n    if (isNumber(scaleX) && scaleX !== 1) {\n      values.push(\"scaleX(\".concat(scaleX, \")\"));\n    }\n\n    if (isNumber(scaleY) && scaleY !== 1) {\n      values.push(\"scaleY(\".concat(scaleY, \")\"));\n    }\n\n    var transform = values.length ? values.join(' ') : 'none';\n    return {\n      WebkitTransform: transform,\n      msTransform: transform,\n      transform: transform\n    };\n  }\n  /**\n   * Get the max ratio of a group of pointers.\n   * @param {string} pointers - The target pointers.\n   * @returns {number} The result ratio.\n   */\n\n  function getMaxZoomRatio(pointers) {\n    var pointers2 = _objectSpread2({}, pointers);\n\n    var ratios = [];\n    forEach(pointers, function (pointer, pointerId) {\n      delete pointers2[pointerId];\n      forEach(pointers2, function (pointer2) {\n        var x1 = Math.abs(pointer.startX - pointer2.startX);\n        var y1 = Math.abs(pointer.startY - pointer2.startY);\n        var x2 = Math.abs(pointer.endX - pointer2.endX);\n        var y2 = Math.abs(pointer.endY - pointer2.endY);\n        var z1 = Math.sqrt(x1 * x1 + y1 * y1);\n        var z2 = Math.sqrt(x2 * x2 + y2 * y2);\n        var ratio = (z2 - z1) / z1;\n        ratios.push(ratio);\n      });\n    });\n    ratios.sort(function (a, b) {\n      return Math.abs(a) < Math.abs(b);\n    });\n    return ratios[0];\n  }\n  /**\n   * Get a pointer from an event object.\n   * @param {Object} event - The target event object.\n   * @param {boolean} endOnly - Indicates if only returns the end point coordinate or not.\n   * @returns {Object} The result pointer contains start and/or end point coordinates.\n   */\n\n  function getPointer(_ref2, endOnly) {\n    var pageX = _ref2.pageX,\n        pageY = _ref2.pageY;\n    var end = {\n      endX: pageX,\n      endY: pageY\n    };\n    return endOnly ? end : _objectSpread2({\n      startX: pageX,\n      startY: pageY\n    }, end);\n  }\n  /**\n   * Get the center point coordinate of a group of pointers.\n   * @param {Object} pointers - The target pointers.\n   * @returns {Object} The center point coordinate.\n   */\n\n  function getPointersCenter(pointers) {\n    var pageX = 0;\n    var pageY = 0;\n    var count = 0;\n    forEach(pointers, function (_ref3) {\n      var startX = _ref3.startX,\n          startY = _ref3.startY;\n      pageX += startX;\n      pageY += startY;\n      count += 1;\n    });\n    pageX /= count;\n    pageY /= count;\n    return {\n      pageX: pageX,\n      pageY: pageY\n    };\n  }\n  /**\n   * Get the max sizes in a rectangle under the given aspect ratio.\n   * @param {Object} data - The original sizes.\n   * @param {string} [type='contain'] - The adjust type.\n   * @returns {Object} The result sizes.\n   */\n\n  function getAdjustedSizes(_ref4) // or 'cover'\n  {\n    var aspectRatio = _ref4.aspectRatio,\n        height = _ref4.height,\n        width = _ref4.width;\n    var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'contain';\n    var isValidWidth = isPositiveNumber(width);\n    var isValidHeight = isPositiveNumber(height);\n\n    if (isValidWidth && isValidHeight) {\n      var adjustedWidth = height * aspectRatio;\n\n      if (type === 'contain' && adjustedWidth > width || type === 'cover' && adjustedWidth < width) {\n        height = width / aspectRatio;\n      } else {\n        width = height * aspectRatio;\n      }\n    } else if (isValidWidth) {\n      height = width / aspectRatio;\n    } else if (isValidHeight) {\n      width = height * aspectRatio;\n    }\n\n    return {\n      width: width,\n      height: height\n    };\n  }\n  /**\n   * Get the new sizes of a rectangle after rotated.\n   * @param {Object} data - The original sizes.\n   * @returns {Object} The result sizes.\n   */\n\n  function getRotatedSizes(_ref5) {\n    var width = _ref5.width,\n        height = _ref5.height,\n        degree = _ref5.degree;\n    degree = Math.abs(degree) % 180;\n\n    if (degree === 90) {\n      return {\n        width: height,\n        height: width\n      };\n    }\n\n    var arc = degree % 90 * Math.PI / 180;\n    var sinArc = Math.sin(arc);\n    var cosArc = Math.cos(arc);\n    var newWidth = width * cosArc + height * sinArc;\n    var newHeight = width * sinArc + height * cosArc;\n    return degree > 90 ? {\n      width: newHeight,\n      height: newWidth\n    } : {\n      width: newWidth,\n      height: newHeight\n    };\n  }\n  /**\n   * Get a canvas which drew the given image.\n   * @param {HTMLImageElement} image - The image for drawing.\n   * @param {Object} imageData - The image data.\n   * @param {Object} canvasData - The canvas data.\n   * @param {Object} options - The options.\n   * @returns {HTMLCanvasElement} The result canvas.\n   */\n\n  function getSourceCanvas(image, _ref6, _ref7, _ref8) {\n    var imageAspectRatio = _ref6.aspectRatio,\n        imageNaturalWidth = _ref6.naturalWidth,\n        imageNaturalHeight = _ref6.naturalHeight,\n        _ref6$rotate = _ref6.rotate,\n        rotate = _ref6$rotate === void 0 ? 0 : _ref6$rotate,\n        _ref6$scaleX = _ref6.scaleX,\n        scaleX = _ref6$scaleX === void 0 ? 1 : _ref6$scaleX,\n        _ref6$scaleY = _ref6.scaleY,\n        scaleY = _ref6$scaleY === void 0 ? 1 : _ref6$scaleY;\n    var aspectRatio = _ref7.aspectRatio,\n        naturalWidth = _ref7.naturalWidth,\n        naturalHeight = _ref7.naturalHeight;\n    var _ref8$fillColor = _ref8.fillColor,\n        fillColor = _ref8$fillColor === void 0 ? 'transparent' : _ref8$fillColor,\n        _ref8$imageSmoothingE = _ref8.imageSmoothingEnabled,\n        imageSmoothingEnabled = _ref8$imageSmoothingE === void 0 ? true : _ref8$imageSmoothingE,\n        _ref8$imageSmoothingQ = _ref8.imageSmoothingQuality,\n        imageSmoothingQuality = _ref8$imageSmoothingQ === void 0 ? 'low' : _ref8$imageSmoothingQ,\n        _ref8$maxWidth = _ref8.maxWidth,\n        maxWidth = _ref8$maxWidth === void 0 ? Infinity : _ref8$maxWidth,\n        _ref8$maxHeight = _ref8.maxHeight,\n        maxHeight = _ref8$maxHeight === void 0 ? Infinity : _ref8$maxHeight,\n        _ref8$minWidth = _ref8.minWidth,\n        minWidth = _ref8$minWidth === void 0 ? 0 : _ref8$minWidth,\n        _ref8$minHeight = _ref8.minHeight,\n        minHeight = _ref8$minHeight === void 0 ? 0 : _ref8$minHeight;\n    var canvas = document.createElement('canvas');\n    var context = canvas.getContext('2d');\n    var maxSizes = getAdjustedSizes({\n      aspectRatio: aspectRatio,\n      width: maxWidth,\n      height: maxHeight\n    });\n    var minSizes = getAdjustedSizes({\n      aspectRatio: aspectRatio,\n      width: minWidth,\n      height: minHeight\n    }, 'cover');\n    var width = Math.min(maxSizes.width, Math.max(minSizes.width, naturalWidth));\n    var height = Math.min(maxSizes.height, Math.max(minSizes.height, naturalHeight)); // Note: should always use image's natural sizes for drawing as\n    // imageData.naturalWidth === canvasData.naturalHeight when rotate % 180 === 90\n\n    var destMaxSizes = getAdjustedSizes({\n      aspectRatio: imageAspectRatio,\n      width: maxWidth,\n      height: maxHeight\n    });\n    var destMinSizes = getAdjustedSizes({\n      aspectRatio: imageAspectRatio,\n      width: minWidth,\n      height: minHeight\n    }, 'cover');\n    var destWidth = Math.min(destMaxSizes.width, Math.max(destMinSizes.width, imageNaturalWidth));\n    var destHeight = Math.min(destMaxSizes.height, Math.max(destMinSizes.height, imageNaturalHeight));\n    var params = [-destWidth / 2, -destHeight / 2, destWidth, destHeight];\n    canvas.width = normalizeDecimalNumber(width);\n    canvas.height = normalizeDecimalNumber(height);\n    context.fillStyle = fillColor;\n    context.fillRect(0, 0, width, height);\n    context.save();\n    context.translate(width / 2, height / 2);\n    context.rotate(rotate * Math.PI / 180);\n    context.scale(scaleX, scaleY);\n    context.imageSmoothingEnabled = imageSmoothingEnabled;\n    context.imageSmoothingQuality = imageSmoothingQuality;\n    context.drawImage.apply(context, [image].concat(_toConsumableArray(params.map(function (param) {\n      return Math.floor(normalizeDecimalNumber(param));\n    }))));\n    context.restore();\n    return canvas;\n  }\n  var fromCharCode = String.fromCharCode;\n  /**\n   * Get string from char code in data view.\n   * @param {DataView} dataView - The data view for read.\n   * @param {number} start - The start index.\n   * @param {number} length - The read length.\n   * @returns {string} The read result.\n   */\n\n  function getStringFromCharCode(dataView, start, length) {\n    var str = '';\n    length += start;\n\n    for (var i = start; i < length; i += 1) {\n      str += fromCharCode(dataView.getUint8(i));\n    }\n\n    return str;\n  }\n  var REGEXP_DATA_URL_HEAD = /^data:.*,/;\n  /**\n   * Transform Data URL to array buffer.\n   * @param {string} dataURL - The Data URL to transform.\n   * @returns {ArrayBuffer} The result array buffer.\n   */\n\n  function dataURLToArrayBuffer(dataURL) {\n    var base64 = dataURL.replace(REGEXP_DATA_URL_HEAD, '');\n    var binary = atob(base64);\n    var arrayBuffer = new ArrayBuffer(binary.length);\n    var uint8 = new Uint8Array(arrayBuffer);\n    forEach(uint8, function (value, i) {\n      uint8[i] = binary.charCodeAt(i);\n    });\n    return arrayBuffer;\n  }\n  /**\n   * Transform array buffer to Data URL.\n   * @param {ArrayBuffer} arrayBuffer - The array buffer to transform.\n   * @param {string} mimeType - The mime type of the Data URL.\n   * @returns {string} The result Data URL.\n   */\n\n  function arrayBufferToDataURL(arrayBuffer, mimeType) {\n    var chunks = []; // Chunk Typed Array for better performance (#435)\n\n    var chunkSize = 8192;\n    var uint8 = new Uint8Array(arrayBuffer);\n\n    while (uint8.length > 0) {\n      // XXX: Babel's `toConsumableArray` helper will throw error in IE or Safari 9\n      // eslint-disable-next-line prefer-spread\n      chunks.push(fromCharCode.apply(null, toArray(uint8.subarray(0, chunkSize))));\n      uint8 = uint8.subarray(chunkSize);\n    }\n\n    return \"data:\".concat(mimeType, \";base64,\").concat(btoa(chunks.join('')));\n  }\n  /**\n   * Get orientation value from given array buffer.\n   * @param {ArrayBuffer} arrayBuffer - The array buffer to read.\n   * @returns {number} The read orientation value.\n   */\n\n  function resetAndGetOrientation(arrayBuffer) {\n    var dataView = new DataView(arrayBuffer);\n    var orientation; // Ignores range error when the image does not have correct Exif information\n\n    try {\n      var littleEndian;\n      var app1Start;\n      var ifdStart; // Only handle JPEG image (start by 0xFFD8)\n\n      if (dataView.getUint8(0) === 0xFF && dataView.getUint8(1) === 0xD8) {\n        var length = dataView.byteLength;\n        var offset = 2;\n\n        while (offset + 1 < length) {\n          if (dataView.getUint8(offset) === 0xFF && dataView.getUint8(offset + 1) === 0xE1) {\n            app1Start = offset;\n            break;\n          }\n\n          offset += 1;\n        }\n      }\n\n      if (app1Start) {\n        var exifIDCode = app1Start + 4;\n        var tiffOffset = app1Start + 10;\n\n        if (getStringFromCharCode(dataView, exifIDCode, 4) === 'Exif') {\n          var endianness = dataView.getUint16(tiffOffset);\n          littleEndian = endianness === 0x4949;\n\n          if (littleEndian || endianness === 0x4D4D\n          /* bigEndian */\n          ) {\n              if (dataView.getUint16(tiffOffset + 2, littleEndian) === 0x002A) {\n                var firstIFDOffset = dataView.getUint32(tiffOffset + 4, littleEndian);\n\n                if (firstIFDOffset >= 0x00000008) {\n                  ifdStart = tiffOffset + firstIFDOffset;\n                }\n              }\n            }\n        }\n      }\n\n      if (ifdStart) {\n        var _length = dataView.getUint16(ifdStart, littleEndian);\n\n        var _offset;\n\n        var i;\n\n        for (i = 0; i < _length; i += 1) {\n          _offset = ifdStart + i * 12 + 2;\n\n          if (dataView.getUint16(_offset, littleEndian) === 0x0112\n          /* Orientation */\n          ) {\n              // 8 is the offset of the current tag's value\n              _offset += 8; // Get the original orientation value\n\n              orientation = dataView.getUint16(_offset, littleEndian); // Override the orientation with its default value\n\n              dataView.setUint16(_offset, 1, littleEndian);\n              break;\n            }\n        }\n      }\n    } catch (error) {\n      orientation = 1;\n    }\n\n    return orientation;\n  }\n  /**\n   * Parse Exif Orientation value.\n   * @param {number} orientation - The orientation to parse.\n   * @returns {Object} The parsed result.\n   */\n\n  function parseOrientation(orientation) {\n    var rotate = 0;\n    var scaleX = 1;\n    var scaleY = 1;\n\n    switch (orientation) {\n      // Flip horizontal\n      case 2:\n        scaleX = -1;\n        break;\n      // Rotate left 180°\n\n      case 3:\n        rotate = -180;\n        break;\n      // Flip vertical\n\n      case 4:\n        scaleY = -1;\n        break;\n      // Flip vertical and rotate right 90°\n\n      case 5:\n        rotate = 90;\n        scaleY = -1;\n        break;\n      // Rotate right 90°\n\n      case 6:\n        rotate = 90;\n        break;\n      // Flip horizontal and rotate right 90°\n\n      case 7:\n        rotate = 90;\n        scaleX = -1;\n        break;\n      // Rotate left 90°\n\n      case 8:\n        rotate = -90;\n        break;\n\n      default:\n    }\n\n    return {\n      rotate: rotate,\n      scaleX: scaleX,\n      scaleY: scaleY\n    };\n  }\n\n  var render = {\n    render: function render() {\n      this.initContainer();\n      this.initCanvas();\n      this.initCropBox();\n      this.renderCanvas();\n\n      if (this.cropped) {\n        this.renderCropBox();\n      }\n    },\n    initContainer: function initContainer() {\n      var element = this.element,\n          options = this.options,\n          container = this.container,\n          cropper = this.cropper;\n      addClass(cropper, CLASS_HIDDEN);\n      removeClass(element, CLASS_HIDDEN);\n      var containerData = {\n        width: Math.max(container.offsetWidth, Number(options.minContainerWidth) || 200),\n        height: Math.max(container.offsetHeight, Number(options.minContainerHeight) || 100)\n      };\n      this.containerData = containerData;\n      setStyle(cropper, {\n        width: containerData.width,\n        height: containerData.height\n      });\n      addClass(element, CLASS_HIDDEN);\n      removeClass(cropper, CLASS_HIDDEN);\n    },\n    // Canvas (image wrapper)\n    initCanvas: function initCanvas() {\n      var containerData = this.containerData,\n          imageData = this.imageData;\n      var viewMode = this.options.viewMode;\n      var rotated = Math.abs(imageData.rotate) % 180 === 90;\n      var naturalWidth = rotated ? imageData.naturalHeight : imageData.naturalWidth;\n      var naturalHeight = rotated ? imageData.naturalWidth : imageData.naturalHeight;\n      var aspectRatio = naturalWidth / naturalHeight;\n      var canvasWidth = containerData.width;\n      var canvasHeight = containerData.height;\n\n      if (containerData.height * aspectRatio > containerData.width) {\n        if (viewMode === 3) {\n          canvasWidth = containerData.height * aspectRatio;\n        } else {\n          canvasHeight = containerData.width / aspectRatio;\n        }\n      } else if (viewMode === 3) {\n        canvasHeight = containerData.width / aspectRatio;\n      } else {\n        canvasWidth = containerData.height * aspectRatio;\n      }\n\n      var canvasData = {\n        aspectRatio: aspectRatio,\n        naturalWidth: naturalWidth,\n        naturalHeight: naturalHeight,\n        width: canvasWidth,\n        height: canvasHeight\n      };\n      canvasData.left = (containerData.width - canvasWidth) / 2;\n      canvasData.top = (containerData.height - canvasHeight) / 2;\n      canvasData.oldLeft = canvasData.left;\n      canvasData.oldTop = canvasData.top;\n      this.canvasData = canvasData;\n      this.limited = viewMode === 1 || viewMode === 2;\n      this.limitCanvas(true, true);\n      this.initialImageData = assign({}, imageData);\n      this.initialCanvasData = assign({}, canvasData);\n    },\n    limitCanvas: function limitCanvas(sizeLimited, positionLimited) {\n      var options = this.options,\n          containerData = this.containerData,\n          canvasData = this.canvasData,\n          cropBoxData = this.cropBoxData;\n      var viewMode = options.viewMode;\n      var aspectRatio = canvasData.aspectRatio;\n      var cropped = this.cropped && cropBoxData;\n\n      if (sizeLimited) {\n        var minCanvasWidth = Number(options.minCanvasWidth) || 0;\n        var minCanvasHeight = Number(options.minCanvasHeight) || 0;\n\n        if (viewMode > 1) {\n          minCanvasWidth = Math.max(minCanvasWidth, containerData.width);\n          minCanvasHeight = Math.max(minCanvasHeight, containerData.height);\n\n          if (viewMode === 3) {\n            if (minCanvasHeight * aspectRatio > minCanvasWidth) {\n              minCanvasWidth = minCanvasHeight * aspectRatio;\n            } else {\n              minCanvasHeight = minCanvasWidth / aspectRatio;\n            }\n          }\n        } else if (viewMode > 0) {\n          if (minCanvasWidth) {\n            minCanvasWidth = Math.max(minCanvasWidth, cropped ? cropBoxData.width : 0);\n          } else if (minCanvasHeight) {\n            minCanvasHeight = Math.max(minCanvasHeight, cropped ? cropBoxData.height : 0);\n          } else if (cropped) {\n            minCanvasWidth = cropBoxData.width;\n            minCanvasHeight = cropBoxData.height;\n\n            if (minCanvasHeight * aspectRatio > minCanvasWidth) {\n              minCanvasWidth = minCanvasHeight * aspectRatio;\n            } else {\n              minCanvasHeight = minCanvasWidth / aspectRatio;\n            }\n          }\n        }\n\n        var _getAdjustedSizes = getAdjustedSizes({\n          aspectRatio: aspectRatio,\n          width: minCanvasWidth,\n          height: minCanvasHeight\n        });\n\n        minCanvasWidth = _getAdjustedSizes.width;\n        minCanvasHeight = _getAdjustedSizes.height;\n        canvasData.minWidth = minCanvasWidth;\n        canvasData.minHeight = minCanvasHeight;\n        canvasData.maxWidth = Infinity;\n        canvasData.maxHeight = Infinity;\n      }\n\n      if (positionLimited) {\n        if (viewMode > (cropped ? 0 : 1)) {\n          var newCanvasLeft = containerData.width - canvasData.width;\n          var newCanvasTop = containerData.height - canvasData.height;\n          canvasData.minLeft = Math.min(0, newCanvasLeft);\n          canvasData.minTop = Math.min(0, newCanvasTop);\n          canvasData.maxLeft = Math.max(0, newCanvasLeft);\n          canvasData.maxTop = Math.max(0, newCanvasTop);\n\n          if (cropped && this.limited) {\n            canvasData.minLeft = Math.min(cropBoxData.left, cropBoxData.left + (cropBoxData.width - canvasData.width));\n            canvasData.minTop = Math.min(cropBoxData.top, cropBoxData.top + (cropBoxData.height - canvasData.height));\n            canvasData.maxLeft = cropBoxData.left;\n            canvasData.maxTop = cropBoxData.top;\n\n            if (viewMode === 2) {\n              if (canvasData.width >= containerData.width) {\n                canvasData.minLeft = Math.min(0, newCanvasLeft);\n                canvasData.maxLeft = Math.max(0, newCanvasLeft);\n              }\n\n              if (canvasData.height >= containerData.height) {\n                canvasData.minTop = Math.min(0, newCanvasTop);\n                canvasData.maxTop = Math.max(0, newCanvasTop);\n              }\n            }\n          }\n        } else {\n          canvasData.minLeft = -canvasData.width;\n          canvasData.minTop = -canvasData.height;\n          canvasData.maxLeft = containerData.width;\n          canvasData.maxTop = containerData.height;\n        }\n      }\n    },\n    renderCanvas: function renderCanvas(changed, transformed) {\n      var canvasData = this.canvasData,\n          imageData = this.imageData;\n\n      if (transformed) {\n        var _getRotatedSizes = getRotatedSizes({\n          width: imageData.naturalWidth * Math.abs(imageData.scaleX || 1),\n          height: imageData.naturalHeight * Math.abs(imageData.scaleY || 1),\n          degree: imageData.rotate || 0\n        }),\n            naturalWidth = _getRotatedSizes.width,\n            naturalHeight = _getRotatedSizes.height;\n\n        var width = canvasData.width * (naturalWidth / canvasData.naturalWidth);\n        var height = canvasData.height * (naturalHeight / canvasData.naturalHeight);\n        canvasData.left -= (width - canvasData.width) / 2;\n        canvasData.top -= (height - canvasData.height) / 2;\n        canvasData.width = width;\n        canvasData.height = height;\n        canvasData.aspectRatio = naturalWidth / naturalHeight;\n        canvasData.naturalWidth = naturalWidth;\n        canvasData.naturalHeight = naturalHeight;\n        this.limitCanvas(true, false);\n      }\n\n      if (canvasData.width > canvasData.maxWidth || canvasData.width < canvasData.minWidth) {\n        canvasData.left = canvasData.oldLeft;\n      }\n\n      if (canvasData.height > canvasData.maxHeight || canvasData.height < canvasData.minHeight) {\n        canvasData.top = canvasData.oldTop;\n      }\n\n      canvasData.width = Math.min(Math.max(canvasData.width, canvasData.minWidth), canvasData.maxWidth);\n      canvasData.height = Math.min(Math.max(canvasData.height, canvasData.minHeight), canvasData.maxHeight);\n      this.limitCanvas(false, true);\n      canvasData.left = Math.min(Math.max(canvasData.left, canvasData.minLeft), canvasData.maxLeft);\n      canvasData.top = Math.min(Math.max(canvasData.top, canvasData.minTop), canvasData.maxTop);\n      canvasData.oldLeft = canvasData.left;\n      canvasData.oldTop = canvasData.top;\n      setStyle(this.canvas, assign({\n        width: canvasData.width,\n        height: canvasData.height\n      }, getTransforms({\n        translateX: canvasData.left,\n        translateY: canvasData.top\n      })));\n      this.renderImage(changed);\n\n      if (this.cropped && this.limited) {\n        this.limitCropBox(true, true);\n      }\n    },\n    renderImage: function renderImage(changed) {\n      var canvasData = this.canvasData,\n          imageData = this.imageData;\n      var width = imageData.naturalWidth * (canvasData.width / canvasData.naturalWidth);\n      var height = imageData.naturalHeight * (canvasData.height / canvasData.naturalHeight);\n      assign(imageData, {\n        width: width,\n        height: height,\n        left: (canvasData.width - width) / 2,\n        top: (canvasData.height - height) / 2\n      });\n      setStyle(this.image, assign({\n        width: imageData.width,\n        height: imageData.height\n      }, getTransforms(assign({\n        translateX: imageData.left,\n        translateY: imageData.top\n      }, imageData))));\n\n      if (changed) {\n        this.output();\n      }\n    },\n    initCropBox: function initCropBox() {\n      var options = this.options,\n          canvasData = this.canvasData;\n      var aspectRatio = options.aspectRatio || options.initialAspectRatio;\n      var autoCropArea = Number(options.autoCropArea) || 0.8;\n      var cropBoxData = {\n        width: canvasData.width,\n        height: canvasData.height\n      };\n\n      if (aspectRatio) {\n        if (canvasData.height * aspectRatio > canvasData.width) {\n          cropBoxData.height = cropBoxData.width / aspectRatio;\n        } else {\n          cropBoxData.width = cropBoxData.height * aspectRatio;\n        }\n      }\n\n      this.cropBoxData = cropBoxData;\n      this.limitCropBox(true, true); // Initialize auto crop area\n\n      cropBoxData.width = Math.min(Math.max(cropBoxData.width, cropBoxData.minWidth), cropBoxData.maxWidth);\n      cropBoxData.height = Math.min(Math.max(cropBoxData.height, cropBoxData.minHeight), cropBoxData.maxHeight); // The width/height of auto crop area must large than \"minWidth/Height\"\n\n      cropBoxData.width = Math.max(cropBoxData.minWidth, cropBoxData.width * autoCropArea);\n      cropBoxData.height = Math.max(cropBoxData.minHeight, cropBoxData.height * autoCropArea);\n      cropBoxData.left = canvasData.left + (canvasData.width - cropBoxData.width) / 2;\n      cropBoxData.top = canvasData.top + (canvasData.height - cropBoxData.height) / 2;\n      cropBoxData.oldLeft = cropBoxData.left;\n      cropBoxData.oldTop = cropBoxData.top;\n      this.initialCropBoxData = assign({}, cropBoxData);\n    },\n    limitCropBox: function limitCropBox(sizeLimited, positionLimited) {\n      var options = this.options,\n          containerData = this.containerData,\n          canvasData = this.canvasData,\n          cropBoxData = this.cropBoxData,\n          limited = this.limited;\n      var aspectRatio = options.aspectRatio;\n\n      if (sizeLimited) {\n        var minCropBoxWidth = Number(options.minCropBoxWidth) || 0;\n        var minCropBoxHeight = Number(options.minCropBoxHeight) || 0;\n        var maxCropBoxWidth = limited ? Math.min(containerData.width, canvasData.width, canvasData.width + canvasData.left, containerData.width - canvasData.left) : containerData.width;\n        var maxCropBoxHeight = limited ? Math.min(containerData.height, canvasData.height, canvasData.height + canvasData.top, containerData.height - canvasData.top) : containerData.height; // The min/maxCropBoxWidth/Height must be less than container's width/height\n\n        minCropBoxWidth = Math.min(minCropBoxWidth, containerData.width);\n        minCropBoxHeight = Math.min(minCropBoxHeight, containerData.height);\n\n        if (aspectRatio) {\n          if (minCropBoxWidth && minCropBoxHeight) {\n            if (minCropBoxHeight * aspectRatio > minCropBoxWidth) {\n              minCropBoxHeight = minCropBoxWidth / aspectRatio;\n            } else {\n              minCropBoxWidth = minCropBoxHeight * aspectRatio;\n            }\n          } else if (minCropBoxWidth) {\n            minCropBoxHeight = minCropBoxWidth / aspectRatio;\n          } else if (minCropBoxHeight) {\n            minCropBoxWidth = minCropBoxHeight * aspectRatio;\n          }\n\n          if (maxCropBoxHeight * aspectRatio > maxCropBoxWidth) {\n            maxCropBoxHeight = maxCropBoxWidth / aspectRatio;\n          } else {\n            maxCropBoxWidth = maxCropBoxHeight * aspectRatio;\n          }\n        } // The minWidth/Height must be less than maxWidth/Height\n\n\n        cropBoxData.minWidth = Math.min(minCropBoxWidth, maxCropBoxWidth);\n        cropBoxData.minHeight = Math.min(minCropBoxHeight, maxCropBoxHeight);\n        cropBoxData.maxWidth = maxCropBoxWidth;\n        cropBoxData.maxHeight = maxCropBoxHeight;\n      }\n\n      if (positionLimited) {\n        if (limited) {\n          cropBoxData.minLeft = Math.max(0, canvasData.left);\n          cropBoxData.minTop = Math.max(0, canvasData.top);\n          cropBoxData.maxLeft = Math.min(containerData.width, canvasData.left + canvasData.width) - cropBoxData.width;\n          cropBoxData.maxTop = Math.min(containerData.height, canvasData.top + canvasData.height) - cropBoxData.height;\n        } else {\n          cropBoxData.minLeft = 0;\n          cropBoxData.minTop = 0;\n          cropBoxData.maxLeft = containerData.width - cropBoxData.width;\n          cropBoxData.maxTop = containerData.height - cropBoxData.height;\n        }\n      }\n    },\n    renderCropBox: function renderCropBox() {\n      var options = this.options,\n          containerData = this.containerData,\n          cropBoxData = this.cropBoxData;\n\n      if (cropBoxData.width > cropBoxData.maxWidth || cropBoxData.width < cropBoxData.minWidth) {\n        cropBoxData.left = cropBoxData.oldLeft;\n      }\n\n      if (cropBoxData.height > cropBoxData.maxHeight || cropBoxData.height < cropBoxData.minHeight) {\n        cropBoxData.top = cropBoxData.oldTop;\n      }\n\n      cropBoxData.width = Math.min(Math.max(cropBoxData.width, cropBoxData.minWidth), cropBoxData.maxWidth);\n      cropBoxData.height = Math.min(Math.max(cropBoxData.height, cropBoxData.minHeight), cropBoxData.maxHeight);\n      this.limitCropBox(false, true);\n      cropBoxData.left = Math.min(Math.max(cropBoxData.left, cropBoxData.minLeft), cropBoxData.maxLeft);\n      cropBoxData.top = Math.min(Math.max(cropBoxData.top, cropBoxData.minTop), cropBoxData.maxTop);\n      cropBoxData.oldLeft = cropBoxData.left;\n      cropBoxData.oldTop = cropBoxData.top;\n\n      if (options.movable && options.cropBoxMovable) {\n        // Turn to move the canvas when the crop box is equal to the container\n        setData(this.face, DATA_ACTION, cropBoxData.width >= containerData.width && cropBoxData.height >= containerData.height ? ACTION_MOVE : ACTION_ALL);\n      }\n\n      setStyle(this.cropBox, assign({\n        width: cropBoxData.width,\n        height: cropBoxData.height\n      }, getTransforms({\n        translateX: cropBoxData.left,\n        translateY: cropBoxData.top\n      })));\n\n      if (this.cropped && this.limited) {\n        this.limitCanvas(true, true);\n      }\n\n      if (!this.disabled) {\n        this.output();\n      }\n    },\n    output: function output() {\n      this.preview();\n      dispatchEvent(this.element, EVENT_CROP, this.getData());\n    }\n  };\n\n  var preview = {\n    initPreview: function initPreview() {\n      var element = this.element,\n          crossOrigin = this.crossOrigin;\n      var preview = this.options.preview;\n      var url = crossOrigin ? this.crossOriginUrl : this.url;\n      var alt = element.alt || 'The image to preview';\n      var image = document.createElement('img');\n\n      if (crossOrigin) {\n        image.crossOrigin = crossOrigin;\n      }\n\n      image.src = url;\n      image.alt = alt;\n      this.viewBox.appendChild(image);\n      this.viewBoxImage = image;\n\n      if (!preview) {\n        return;\n      }\n\n      var previews = preview;\n\n      if (typeof preview === 'string') {\n        previews = element.ownerDocument.querySelectorAll(preview);\n      } else if (preview.querySelector) {\n        previews = [preview];\n      }\n\n      this.previews = previews;\n      forEach(previews, function (el) {\n        var img = document.createElement('img'); // Save the original size for recover\n\n        setData(el, DATA_PREVIEW, {\n          width: el.offsetWidth,\n          height: el.offsetHeight,\n          html: el.innerHTML\n        });\n\n        if (crossOrigin) {\n          img.crossOrigin = crossOrigin;\n        }\n\n        img.src = url;\n        img.alt = alt;\n        /**\n         * Override img element styles\n         * Add `display:block` to avoid margin top issue\n         * Add `height:auto` to override `height` attribute on IE8\n         * (Occur only when margin-top <= -height)\n         */\n\n        img.style.cssText = 'display:block;' + 'width:100%;' + 'height:auto;' + 'min-width:0!important;' + 'min-height:0!important;' + 'max-width:none!important;' + 'max-height:none!important;' + 'image-orientation:0deg!important;\"';\n        el.innerHTML = '';\n        el.appendChild(img);\n      });\n    },\n    resetPreview: function resetPreview() {\n      forEach(this.previews, function (element) {\n        var data = getData(element, DATA_PREVIEW);\n        setStyle(element, {\n          width: data.width,\n          height: data.height\n        });\n        element.innerHTML = data.html;\n        removeData(element, DATA_PREVIEW);\n      });\n    },\n    preview: function preview() {\n      var imageData = this.imageData,\n          canvasData = this.canvasData,\n          cropBoxData = this.cropBoxData;\n      var cropBoxWidth = cropBoxData.width,\n          cropBoxHeight = cropBoxData.height;\n      var width = imageData.width,\n          height = imageData.height;\n      var left = cropBoxData.left - canvasData.left - imageData.left;\n      var top = cropBoxData.top - canvasData.top - imageData.top;\n\n      if (!this.cropped || this.disabled) {\n        return;\n      }\n\n      setStyle(this.viewBoxImage, assign({\n        width: width,\n        height: height\n      }, getTransforms(assign({\n        translateX: -left,\n        translateY: -top\n      }, imageData))));\n      forEach(this.previews, function (element) {\n        var data = getData(element, DATA_PREVIEW);\n        var originalWidth = data.width;\n        var originalHeight = data.height;\n        var newWidth = originalWidth;\n        var newHeight = originalHeight;\n        var ratio = 1;\n\n        if (cropBoxWidth) {\n          ratio = originalWidth / cropBoxWidth;\n          newHeight = cropBoxHeight * ratio;\n        }\n\n        if (cropBoxHeight && newHeight > originalHeight) {\n          ratio = originalHeight / cropBoxHeight;\n          newWidth = cropBoxWidth * ratio;\n          newHeight = originalHeight;\n        }\n\n        setStyle(element, {\n          width: newWidth,\n          height: newHeight\n        });\n        setStyle(element.getElementsByTagName('img')[0], assign({\n          width: width * ratio,\n          height: height * ratio\n        }, getTransforms(assign({\n          translateX: -left * ratio,\n          translateY: -top * ratio\n        }, imageData))));\n      });\n    }\n  };\n\n  var events = {\n    bind: function bind() {\n      var element = this.element,\n          options = this.options,\n          cropper = this.cropper;\n\n      if (isFunction(options.cropstart)) {\n        addListener(element, EVENT_CROP_START, options.cropstart);\n      }\n\n      if (isFunction(options.cropmove)) {\n        addListener(element, EVENT_CROP_MOVE, options.cropmove);\n      }\n\n      if (isFunction(options.cropend)) {\n        addListener(element, EVENT_CROP_END, options.cropend);\n      }\n\n      if (isFunction(options.crop)) {\n        addListener(element, EVENT_CROP, options.crop);\n      }\n\n      if (isFunction(options.zoom)) {\n        addListener(element, EVENT_ZOOM, options.zoom);\n      }\n\n      addListener(cropper, EVENT_POINTER_DOWN, this.onCropStart = this.cropStart.bind(this));\n\n      if (options.zoomable && options.zoomOnWheel) {\n        addListener(cropper, EVENT_WHEEL, this.onWheel = this.wheel.bind(this), {\n          passive: false,\n          capture: true\n        });\n      }\n\n      if (options.toggleDragModeOnDblclick) {\n        addListener(cropper, EVENT_DBLCLICK, this.onDblclick = this.dblclick.bind(this));\n      }\n\n      addListener(element.ownerDocument, EVENT_POINTER_MOVE, this.onCropMove = this.cropMove.bind(this));\n      addListener(element.ownerDocument, EVENT_POINTER_UP, this.onCropEnd = this.cropEnd.bind(this));\n\n      if (options.responsive) {\n        addListener(window, EVENT_RESIZE, this.onResize = this.resize.bind(this));\n      }\n    },\n    unbind: function unbind() {\n      var element = this.element,\n          options = this.options,\n          cropper = this.cropper;\n\n      if (isFunction(options.cropstart)) {\n        removeListener(element, EVENT_CROP_START, options.cropstart);\n      }\n\n      if (isFunction(options.cropmove)) {\n        removeListener(element, EVENT_CROP_MOVE, options.cropmove);\n      }\n\n      if (isFunction(options.cropend)) {\n        removeListener(element, EVENT_CROP_END, options.cropend);\n      }\n\n      if (isFunction(options.crop)) {\n        removeListener(element, EVENT_CROP, options.crop);\n      }\n\n      if (isFunction(options.zoom)) {\n        removeListener(element, EVENT_ZOOM, options.zoom);\n      }\n\n      removeListener(cropper, EVENT_POINTER_DOWN, this.onCropStart);\n\n      if (options.zoomable && options.zoomOnWheel) {\n        removeListener(cropper, EVENT_WHEEL, this.onWheel, {\n          passive: false,\n          capture: true\n        });\n      }\n\n      if (options.toggleDragModeOnDblclick) {\n        removeListener(cropper, EVENT_DBLCLICK, this.onDblclick);\n      }\n\n      removeListener(element.ownerDocument, EVENT_POINTER_MOVE, this.onCropMove);\n      removeListener(element.ownerDocument, EVENT_POINTER_UP, this.onCropEnd);\n\n      if (options.responsive) {\n        removeListener(window, EVENT_RESIZE, this.onResize);\n      }\n    }\n  };\n\n  var handlers = {\n    resize: function resize() {\n      var options = this.options,\n          container = this.container,\n          containerData = this.containerData;\n      var minContainerWidth = Number(options.minContainerWidth) || MIN_CONTAINER_WIDTH;\n      var minContainerHeight = Number(options.minContainerHeight) || MIN_CONTAINER_HEIGHT;\n\n      if (this.disabled || containerData.width <= minContainerWidth || containerData.height <= minContainerHeight) {\n        return;\n      }\n\n      var ratio = container.offsetWidth / containerData.width; // Resize when width changed or height changed\n\n      if (ratio !== 1 || container.offsetHeight !== containerData.height) {\n        var canvasData;\n        var cropBoxData;\n\n        if (options.restore) {\n          canvasData = this.getCanvasData();\n          cropBoxData = this.getCropBoxData();\n        }\n\n        this.render();\n\n        if (options.restore) {\n          this.setCanvasData(forEach(canvasData, function (n, i) {\n            canvasData[i] = n * ratio;\n          }));\n          this.setCropBoxData(forEach(cropBoxData, function (n, i) {\n            cropBoxData[i] = n * ratio;\n          }));\n        }\n      }\n    },\n    dblclick: function dblclick() {\n      if (this.disabled || this.options.dragMode === DRAG_MODE_NONE) {\n        return;\n      }\n\n      this.setDragMode(hasClass(this.dragBox, CLASS_CROP) ? DRAG_MODE_MOVE : DRAG_MODE_CROP);\n    },\n    wheel: function wheel(event) {\n      var _this = this;\n\n      var ratio = Number(this.options.wheelZoomRatio) || 0.1;\n      var delta = 1;\n\n      if (this.disabled) {\n        return;\n      }\n\n      event.preventDefault(); // Limit wheel speed to prevent zoom too fast (#21)\n\n      if (this.wheeling) {\n        return;\n      }\n\n      this.wheeling = true;\n      setTimeout(function () {\n        _this.wheeling = false;\n      }, 50);\n\n      if (event.deltaY) {\n        delta = event.deltaY > 0 ? 1 : -1;\n      } else if (event.wheelDelta) {\n        delta = -event.wheelDelta / 120;\n      } else if (event.detail) {\n        delta = event.detail > 0 ? 1 : -1;\n      }\n\n      this.zoom(-delta * ratio, event);\n    },\n    cropStart: function cropStart(event) {\n      var buttons = event.buttons,\n          button = event.button;\n\n      if (this.disabled // Handle mouse event and pointer event and ignore touch event\n      || (event.type === 'mousedown' || event.type === 'pointerdown' && event.pointerType === 'mouse') && ( // No primary button (Usually the left button)\n      isNumber(buttons) && buttons !== 1 || isNumber(button) && button !== 0 // Open context menu\n      || event.ctrlKey)) {\n        return;\n      }\n\n      var options = this.options,\n          pointers = this.pointers;\n      var action;\n\n      if (event.changedTouches) {\n        // Handle touch event\n        forEach(event.changedTouches, function (touch) {\n          pointers[touch.identifier] = getPointer(touch);\n        });\n      } else {\n        // Handle mouse event and pointer event\n        pointers[event.pointerId || 0] = getPointer(event);\n      }\n\n      if (Object.keys(pointers).length > 1 && options.zoomable && options.zoomOnTouch) {\n        action = ACTION_ZOOM;\n      } else {\n        action = getData(event.target, DATA_ACTION);\n      }\n\n      if (!REGEXP_ACTIONS.test(action)) {\n        return;\n      }\n\n      if (dispatchEvent(this.element, EVENT_CROP_START, {\n        originalEvent: event,\n        action: action\n      }) === false) {\n        return;\n      } // This line is required for preventing page zooming in iOS browsers\n\n\n      event.preventDefault();\n      this.action = action;\n      this.cropping = false;\n\n      if (action === ACTION_CROP) {\n        this.cropping = true;\n        addClass(this.dragBox, CLASS_MODAL);\n      }\n    },\n    cropMove: function cropMove(event) {\n      var action = this.action;\n\n      if (this.disabled || !action) {\n        return;\n      }\n\n      var pointers = this.pointers;\n      event.preventDefault();\n\n      if (dispatchEvent(this.element, EVENT_CROP_MOVE, {\n        originalEvent: event,\n        action: action\n      }) === false) {\n        return;\n      }\n\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          // The first parameter should not be undefined (#432)\n          assign(pointers[touch.identifier] || {}, getPointer(touch, true));\n        });\n      } else {\n        assign(pointers[event.pointerId || 0] || {}, getPointer(event, true));\n      }\n\n      this.change(event);\n    },\n    cropEnd: function cropEnd(event) {\n      if (this.disabled) {\n        return;\n      }\n\n      var action = this.action,\n          pointers = this.pointers;\n\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          delete pointers[touch.identifier];\n        });\n      } else {\n        delete pointers[event.pointerId || 0];\n      }\n\n      if (!action) {\n        return;\n      }\n\n      event.preventDefault();\n\n      if (!Object.keys(pointers).length) {\n        this.action = '';\n      }\n\n      if (this.cropping) {\n        this.cropping = false;\n        toggleClass(this.dragBox, CLASS_MODAL, this.cropped && this.options.modal);\n      }\n\n      dispatchEvent(this.element, EVENT_CROP_END, {\n        originalEvent: event,\n        action: action\n      });\n    }\n  };\n\n  var change = {\n    change: function change(event) {\n      var options = this.options,\n          canvasData = this.canvasData,\n          containerData = this.containerData,\n          cropBoxData = this.cropBoxData,\n          pointers = this.pointers;\n      var action = this.action;\n      var aspectRatio = options.aspectRatio;\n      var left = cropBoxData.left,\n          top = cropBoxData.top,\n          width = cropBoxData.width,\n          height = cropBoxData.height;\n      var right = left + width;\n      var bottom = top + height;\n      var minLeft = 0;\n      var minTop = 0;\n      var maxWidth = containerData.width;\n      var maxHeight = containerData.height;\n      var renderable = true;\n      var offset; // Locking aspect ratio in \"free mode\" by holding shift key\n\n      if (!aspectRatio && event.shiftKey) {\n        aspectRatio = width && height ? width / height : 1;\n      }\n\n      if (this.limited) {\n        minLeft = cropBoxData.minLeft;\n        minTop = cropBoxData.minTop;\n        maxWidth = minLeft + Math.min(containerData.width, canvasData.width, canvasData.left + canvasData.width);\n        maxHeight = minTop + Math.min(containerData.height, canvasData.height, canvasData.top + canvasData.height);\n      }\n\n      var pointer = pointers[Object.keys(pointers)[0]];\n      var range = {\n        x: pointer.endX - pointer.startX,\n        y: pointer.endY - pointer.startY\n      };\n\n      var check = function check(side) {\n        switch (side) {\n          case ACTION_EAST:\n            if (right + range.x > maxWidth) {\n              range.x = maxWidth - right;\n            }\n\n            break;\n\n          case ACTION_WEST:\n            if (left + range.x < minLeft) {\n              range.x = minLeft - left;\n            }\n\n            break;\n\n          case ACTION_NORTH:\n            if (top + range.y < minTop) {\n              range.y = minTop - top;\n            }\n\n            break;\n\n          case ACTION_SOUTH:\n            if (bottom + range.y > maxHeight) {\n              range.y = maxHeight - bottom;\n            }\n\n            break;\n\n          default:\n        }\n      };\n\n      switch (action) {\n        // Move crop box\n        case ACTION_ALL:\n          left += range.x;\n          top += range.y;\n          break;\n        // Resize crop box\n\n        case ACTION_EAST:\n          if (range.x >= 0 && (right >= maxWidth || aspectRatio && (top <= minTop || bottom >= maxHeight))) {\n            renderable = false;\n            break;\n          }\n\n          check(ACTION_EAST);\n          width += range.x;\n\n          if (width < 0) {\n            action = ACTION_WEST;\n            width = -width;\n            left -= width;\n          }\n\n          if (aspectRatio) {\n            height = width / aspectRatio;\n            top += (cropBoxData.height - height) / 2;\n          }\n\n          break;\n\n        case ACTION_NORTH:\n          if (range.y <= 0 && (top <= minTop || aspectRatio && (left <= minLeft || right >= maxWidth))) {\n            renderable = false;\n            break;\n          }\n\n          check(ACTION_NORTH);\n          height -= range.y;\n          top += range.y;\n\n          if (height < 0) {\n            action = ACTION_SOUTH;\n            height = -height;\n            top -= height;\n          }\n\n          if (aspectRatio) {\n            width = height * aspectRatio;\n            left += (cropBoxData.width - width) / 2;\n          }\n\n          break;\n\n        case ACTION_WEST:\n          if (range.x <= 0 && (left <= minLeft || aspectRatio && (top <= minTop || bottom >= maxHeight))) {\n            renderable = false;\n            break;\n          }\n\n          check(ACTION_WEST);\n          width -= range.x;\n          left += range.x;\n\n          if (width < 0) {\n            action = ACTION_EAST;\n            width = -width;\n            left -= width;\n          }\n\n          if (aspectRatio) {\n            height = width / aspectRatio;\n            top += (cropBoxData.height - height) / 2;\n          }\n\n          break;\n\n        case ACTION_SOUTH:\n          if (range.y >= 0 && (bottom >= maxHeight || aspectRatio && (left <= minLeft || right >= maxWidth))) {\n            renderable = false;\n            break;\n          }\n\n          check(ACTION_SOUTH);\n          height += range.y;\n\n          if (height < 0) {\n            action = ACTION_NORTH;\n            height = -height;\n            top -= height;\n          }\n\n          if (aspectRatio) {\n            width = height * aspectRatio;\n            left += (cropBoxData.width - width) / 2;\n          }\n\n          break;\n\n        case ACTION_NORTH_EAST:\n          if (aspectRatio) {\n            if (range.y <= 0 && (top <= minTop || right >= maxWidth)) {\n              renderable = false;\n              break;\n            }\n\n            check(ACTION_NORTH);\n            height -= range.y;\n            top += range.y;\n            width = height * aspectRatio;\n          } else {\n            check(ACTION_NORTH);\n            check(ACTION_EAST);\n\n            if (range.x >= 0) {\n              if (right < maxWidth) {\n                width += range.x;\n              } else if (range.y <= 0 && top <= minTop) {\n                renderable = false;\n              }\n            } else {\n              width += range.x;\n            }\n\n            if (range.y <= 0) {\n              if (top > minTop) {\n                height -= range.y;\n                top += range.y;\n              }\n            } else {\n              height -= range.y;\n              top += range.y;\n            }\n          }\n\n          if (width < 0 && height < 0) {\n            action = ACTION_SOUTH_WEST;\n            height = -height;\n            width = -width;\n            top -= height;\n            left -= width;\n          } else if (width < 0) {\n            action = ACTION_NORTH_WEST;\n            width = -width;\n            left -= width;\n          } else if (height < 0) {\n            action = ACTION_SOUTH_EAST;\n            height = -height;\n            top -= height;\n          }\n\n          break;\n\n        case ACTION_NORTH_WEST:\n          if (aspectRatio) {\n            if (range.y <= 0 && (top <= minTop || left <= minLeft)) {\n              renderable = false;\n              break;\n            }\n\n            check(ACTION_NORTH);\n            height -= range.y;\n            top += range.y;\n            width = height * aspectRatio;\n            left += cropBoxData.width - width;\n          } else {\n            check(ACTION_NORTH);\n            check(ACTION_WEST);\n\n            if (range.x <= 0) {\n              if (left > minLeft) {\n                width -= range.x;\n                left += range.x;\n              } else if (range.y <= 0 && top <= minTop) {\n                renderable = false;\n              }\n            } else {\n              width -= range.x;\n              left += range.x;\n            }\n\n            if (range.y <= 0) {\n              if (top > minTop) {\n                height -= range.y;\n                top += range.y;\n              }\n            } else {\n              height -= range.y;\n              top += range.y;\n            }\n          }\n\n          if (width < 0 && height < 0) {\n            action = ACTION_SOUTH_EAST;\n            height = -height;\n            width = -width;\n            top -= height;\n            left -= width;\n          } else if (width < 0) {\n            action = ACTION_NORTH_EAST;\n            width = -width;\n            left -= width;\n          } else if (height < 0) {\n            action = ACTION_SOUTH_WEST;\n            height = -height;\n            top -= height;\n          }\n\n          break;\n\n        case ACTION_SOUTH_WEST:\n          if (aspectRatio) {\n            if (range.x <= 0 && (left <= minLeft || bottom >= maxHeight)) {\n              renderable = false;\n              break;\n            }\n\n            check(ACTION_WEST);\n            width -= range.x;\n            left += range.x;\n            height = width / aspectRatio;\n          } else {\n            check(ACTION_SOUTH);\n            check(ACTION_WEST);\n\n            if (range.x <= 0) {\n              if (left > minLeft) {\n                width -= range.x;\n                left += range.x;\n              } else if (range.y >= 0 && bottom >= maxHeight) {\n                renderable = false;\n              }\n            } else {\n              width -= range.x;\n              left += range.x;\n            }\n\n            if (range.y >= 0) {\n              if (bottom < maxHeight) {\n                height += range.y;\n              }\n            } else {\n              height += range.y;\n            }\n          }\n\n          if (width < 0 && height < 0) {\n            action = ACTION_NORTH_EAST;\n            height = -height;\n            width = -width;\n            top -= height;\n            left -= width;\n          } else if (width < 0) {\n            action = ACTION_SOUTH_EAST;\n            width = -width;\n            left -= width;\n          } else if (height < 0) {\n            action = ACTION_NORTH_WEST;\n            height = -height;\n            top -= height;\n          }\n\n          break;\n\n        case ACTION_SOUTH_EAST:\n          if (aspectRatio) {\n            if (range.x >= 0 && (right >= maxWidth || bottom >= maxHeight)) {\n              renderable = false;\n              break;\n            }\n\n            check(ACTION_EAST);\n            width += range.x;\n            height = width / aspectRatio;\n          } else {\n            check(ACTION_SOUTH);\n            check(ACTION_EAST);\n\n            if (range.x >= 0) {\n              if (right < maxWidth) {\n                width += range.x;\n              } else if (range.y >= 0 && bottom >= maxHeight) {\n                renderable = false;\n              }\n            } else {\n              width += range.x;\n            }\n\n            if (range.y >= 0) {\n              if (bottom < maxHeight) {\n                height += range.y;\n              }\n            } else {\n              height += range.y;\n            }\n          }\n\n          if (width < 0 && height < 0) {\n            action = ACTION_NORTH_WEST;\n            height = -height;\n            width = -width;\n            top -= height;\n            left -= width;\n          } else if (width < 0) {\n            action = ACTION_SOUTH_WEST;\n            width = -width;\n            left -= width;\n          } else if (height < 0) {\n            action = ACTION_NORTH_EAST;\n            height = -height;\n            top -= height;\n          }\n\n          break;\n        // Move canvas\n\n        case ACTION_MOVE:\n          this.move(range.x, range.y);\n          renderable = false;\n          break;\n        // Zoom canvas\n\n        case ACTION_ZOOM:\n          this.zoom(getMaxZoomRatio(pointers), event);\n          renderable = false;\n          break;\n        // Create crop box\n\n        case ACTION_CROP:\n          if (!range.x || !range.y) {\n            renderable = false;\n            break;\n          }\n\n          offset = getOffset(this.cropper);\n          left = pointer.startX - offset.left;\n          top = pointer.startY - offset.top;\n          width = cropBoxData.minWidth;\n          height = cropBoxData.minHeight;\n\n          if (range.x > 0) {\n            action = range.y > 0 ? ACTION_SOUTH_EAST : ACTION_NORTH_EAST;\n          } else if (range.x < 0) {\n            left -= width;\n            action = range.y > 0 ? ACTION_SOUTH_WEST : ACTION_NORTH_WEST;\n          }\n\n          if (range.y < 0) {\n            top -= height;\n          } // Show the crop box if is hidden\n\n\n          if (!this.cropped) {\n            removeClass(this.cropBox, CLASS_HIDDEN);\n            this.cropped = true;\n\n            if (this.limited) {\n              this.limitCropBox(true, true);\n            }\n          }\n\n          break;\n\n        default:\n      }\n\n      if (renderable) {\n        cropBoxData.width = width;\n        cropBoxData.height = height;\n        cropBoxData.left = left;\n        cropBoxData.top = top;\n        this.action = action;\n        this.renderCropBox();\n      } // Override\n\n\n      forEach(pointers, function (p) {\n        p.startX = p.endX;\n        p.startY = p.endY;\n      });\n    }\n  };\n\n  var methods = {\n    // Show the crop box manually\n    crop: function crop() {\n      if (this.ready && !this.cropped && !this.disabled) {\n        this.cropped = true;\n        this.limitCropBox(true, true);\n\n        if (this.options.modal) {\n          addClass(this.dragBox, CLASS_MODAL);\n        }\n\n        removeClass(this.cropBox, CLASS_HIDDEN);\n        this.setCropBoxData(this.initialCropBoxData);\n      }\n\n      return this;\n    },\n    // Reset the image and crop box to their initial states\n    reset: function reset() {\n      if (this.ready && !this.disabled) {\n        this.imageData = assign({}, this.initialImageData);\n        this.canvasData = assign({}, this.initialCanvasData);\n        this.cropBoxData = assign({}, this.initialCropBoxData);\n        this.renderCanvas();\n\n        if (this.cropped) {\n          this.renderCropBox();\n        }\n      }\n\n      return this;\n    },\n    // Clear the crop box\n    clear: function clear() {\n      if (this.cropped && !this.disabled) {\n        assign(this.cropBoxData, {\n          left: 0,\n          top: 0,\n          width: 0,\n          height: 0\n        });\n        this.cropped = false;\n        this.renderCropBox();\n        this.limitCanvas(true, true); // Render canvas after crop box rendered\n\n        this.renderCanvas();\n        removeClass(this.dragBox, CLASS_MODAL);\n        addClass(this.cropBox, CLASS_HIDDEN);\n      }\n\n      return this;\n    },\n\n    /**\n     * Replace the image's src and rebuild the cropper\n     * @param {string} url - The new URL.\n     * @param {boolean} [hasSameSize] - Indicate if the new image has the same size as the old one.\n     * @returns {Cropper} this\n     */\n    replace: function replace(url) {\n      var hasSameSize = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      if (!this.disabled && url) {\n        if (this.isImg) {\n          this.element.src = url;\n        }\n\n        if (hasSameSize) {\n          this.url = url;\n          this.image.src = url;\n\n          if (this.ready) {\n            this.viewBoxImage.src = url;\n            forEach(this.previews, function (element) {\n              element.getElementsByTagName('img')[0].src = url;\n            });\n          }\n        } else {\n          if (this.isImg) {\n            this.replaced = true;\n          }\n\n          this.options.data = null;\n          this.uncreate();\n          this.load(url);\n        }\n      }\n\n      return this;\n    },\n    // Enable (unfreeze) the cropper\n    enable: function enable() {\n      if (this.ready && this.disabled) {\n        this.disabled = false;\n        removeClass(this.cropper, CLASS_DISABLED);\n      }\n\n      return this;\n    },\n    // Disable (freeze) the cropper\n    disable: function disable() {\n      if (this.ready && !this.disabled) {\n        this.disabled = true;\n        addClass(this.cropper, CLASS_DISABLED);\n      }\n\n      return this;\n    },\n\n    /**\n     * Destroy the cropper and remove the instance from the image\n     * @returns {Cropper} this\n     */\n    destroy: function destroy() {\n      var element = this.element;\n\n      if (!element[NAMESPACE]) {\n        return this;\n      }\n\n      element[NAMESPACE] = undefined;\n\n      if (this.isImg && this.replaced) {\n        element.src = this.originalUrl;\n      }\n\n      this.uncreate();\n      return this;\n    },\n\n    /**\n     * Move the canvas with relative offsets\n     * @param {number} offsetX - The relative offset distance on the x-axis.\n     * @param {number} [offsetY=offsetX] - The relative offset distance on the y-axis.\n     * @returns {Cropper} this\n     */\n    move: function move(offsetX) {\n      var offsetY = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : offsetX;\n      var _this$canvasData = this.canvasData,\n          left = _this$canvasData.left,\n          top = _this$canvasData.top;\n      return this.moveTo(isUndefined(offsetX) ? offsetX : left + Number(offsetX), isUndefined(offsetY) ? offsetY : top + Number(offsetY));\n    },\n\n    /**\n     * Move the canvas to an absolute point\n     * @param {number} x - The x-axis coordinate.\n     * @param {number} [y=x] - The y-axis coordinate.\n     * @returns {Cropper} this\n     */\n    moveTo: function moveTo(x) {\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : x;\n      var canvasData = this.canvasData;\n      var changed = false;\n      x = Number(x);\n      y = Number(y);\n\n      if (this.ready && !this.disabled && this.options.movable) {\n        if (isNumber(x)) {\n          canvasData.left = x;\n          changed = true;\n        }\n\n        if (isNumber(y)) {\n          canvasData.top = y;\n          changed = true;\n        }\n\n        if (changed) {\n          this.renderCanvas(true);\n        }\n      }\n\n      return this;\n    },\n\n    /**\n     * Zoom the canvas with a relative ratio\n     * @param {number} ratio - The target ratio.\n     * @param {Event} _originalEvent - The original event if any.\n     * @returns {Cropper} this\n     */\n    zoom: function zoom(ratio, _originalEvent) {\n      var canvasData = this.canvasData;\n      ratio = Number(ratio);\n\n      if (ratio < 0) {\n        ratio = 1 / (1 - ratio);\n      } else {\n        ratio = 1 + ratio;\n      }\n\n      return this.zoomTo(canvasData.width * ratio / canvasData.naturalWidth, null, _originalEvent);\n    },\n\n    /**\n     * Zoom the canvas to an absolute ratio\n     * @param {number} ratio - The target ratio.\n     * @param {Object} pivot - The zoom pivot point coordinate.\n     * @param {Event} _originalEvent - The original event if any.\n     * @returns {Cropper} this\n     */\n    zoomTo: function zoomTo(ratio, pivot, _originalEvent) {\n      var options = this.options,\n          canvasData = this.canvasData;\n      var width = canvasData.width,\n          height = canvasData.height,\n          naturalWidth = canvasData.naturalWidth,\n          naturalHeight = canvasData.naturalHeight;\n      ratio = Number(ratio);\n\n      if (ratio >= 0 && this.ready && !this.disabled && options.zoomable) {\n        var newWidth = naturalWidth * ratio;\n        var newHeight = naturalHeight * ratio;\n\n        if (dispatchEvent(this.element, EVENT_ZOOM, {\n          ratio: ratio,\n          oldRatio: width / naturalWidth,\n          originalEvent: _originalEvent\n        }) === false) {\n          return this;\n        }\n\n        if (_originalEvent) {\n          var pointers = this.pointers;\n          var offset = getOffset(this.cropper);\n          var center = pointers && Object.keys(pointers).length ? getPointersCenter(pointers) : {\n            pageX: _originalEvent.pageX,\n            pageY: _originalEvent.pageY\n          }; // Zoom from the triggering point of the event\n\n          canvasData.left -= (newWidth - width) * ((center.pageX - offset.left - canvasData.left) / width);\n          canvasData.top -= (newHeight - height) * ((center.pageY - offset.top - canvasData.top) / height);\n        } else if (isPlainObject(pivot) && isNumber(pivot.x) && isNumber(pivot.y)) {\n          canvasData.left -= (newWidth - width) * ((pivot.x - canvasData.left) / width);\n          canvasData.top -= (newHeight - height) * ((pivot.y - canvasData.top) / height);\n        } else {\n          // Zoom from the center of the canvas\n          canvasData.left -= (newWidth - width) / 2;\n          canvasData.top -= (newHeight - height) / 2;\n        }\n\n        canvasData.width = newWidth;\n        canvasData.height = newHeight;\n        this.renderCanvas(true);\n      }\n\n      return this;\n    },\n\n    /**\n     * Rotate the canvas with a relative degree\n     * @param {number} degree - The rotate degree.\n     * @returns {Cropper} this\n     */\n    rotate: function rotate(degree) {\n      return this.rotateTo((this.imageData.rotate || 0) + Number(degree));\n    },\n\n    /**\n     * Rotate the canvas to an absolute degree\n     * @param {number} degree - The rotate degree.\n     * @returns {Cropper} this\n     */\n    rotateTo: function rotateTo(degree) {\n      degree = Number(degree);\n\n      if (isNumber(degree) && this.ready && !this.disabled && this.options.rotatable) {\n        this.imageData.rotate = degree % 360;\n        this.renderCanvas(true, true);\n      }\n\n      return this;\n    },\n\n    /**\n     * Scale the image on the x-axis.\n     * @param {number} scaleX - The scale ratio on the x-axis.\n     * @returns {Cropper} this\n     */\n    scaleX: function scaleX(_scaleX) {\n      var scaleY = this.imageData.scaleY;\n      return this.scale(_scaleX, isNumber(scaleY) ? scaleY : 1);\n    },\n\n    /**\n     * Scale the image on the y-axis.\n     * @param {number} scaleY - The scale ratio on the y-axis.\n     * @returns {Cropper} this\n     */\n    scaleY: function scaleY(_scaleY) {\n      var scaleX = this.imageData.scaleX;\n      return this.scale(isNumber(scaleX) ? scaleX : 1, _scaleY);\n    },\n\n    /**\n     * Scale the image\n     * @param {number} scaleX - The scale ratio on the x-axis.\n     * @param {number} [scaleY=scaleX] - The scale ratio on the y-axis.\n     * @returns {Cropper} this\n     */\n    scale: function scale(scaleX) {\n      var scaleY = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : scaleX;\n      var imageData = this.imageData;\n      var transformed = false;\n      scaleX = Number(scaleX);\n      scaleY = Number(scaleY);\n\n      if (this.ready && !this.disabled && this.options.scalable) {\n        if (isNumber(scaleX)) {\n          imageData.scaleX = scaleX;\n          transformed = true;\n        }\n\n        if (isNumber(scaleY)) {\n          imageData.scaleY = scaleY;\n          transformed = true;\n        }\n\n        if (transformed) {\n          this.renderCanvas(true, true);\n        }\n      }\n\n      return this;\n    },\n\n    /**\n     * Get the cropped area position and size data (base on the original image)\n     * @param {boolean} [rounded=false] - Indicate if round the data values or not.\n     * @returns {Object} The result cropped data.\n     */\n    getData: function getData() {\n      var rounded = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var options = this.options,\n          imageData = this.imageData,\n          canvasData = this.canvasData,\n          cropBoxData = this.cropBoxData;\n      var data;\n\n      if (this.ready && this.cropped) {\n        data = {\n          x: cropBoxData.left - canvasData.left,\n          y: cropBoxData.top - canvasData.top,\n          width: cropBoxData.width,\n          height: cropBoxData.height\n        };\n        var ratio = imageData.width / imageData.naturalWidth;\n        forEach(data, function (n, i) {\n          data[i] = n / ratio;\n        });\n\n        if (rounded) {\n          // In case rounding off leads to extra 1px in right or bottom border\n          // we should round the top-left corner and the dimension (#343).\n          var bottom = Math.round(data.y + data.height);\n          var right = Math.round(data.x + data.width);\n          data.x = Math.round(data.x);\n          data.y = Math.round(data.y);\n          data.width = right - data.x;\n          data.height = bottom - data.y;\n        }\n      } else {\n        data = {\n          x: 0,\n          y: 0,\n          width: 0,\n          height: 0\n        };\n      }\n\n      if (options.rotatable) {\n        data.rotate = imageData.rotate || 0;\n      }\n\n      if (options.scalable) {\n        data.scaleX = imageData.scaleX || 1;\n        data.scaleY = imageData.scaleY || 1;\n      }\n\n      return data;\n    },\n\n    /**\n     * Set the cropped area position and size with new data\n     * @param {Object} data - The new data.\n     * @returns {Cropper} this\n     */\n    setData: function setData(data) {\n      var options = this.options,\n          imageData = this.imageData,\n          canvasData = this.canvasData;\n      var cropBoxData = {};\n\n      if (this.ready && !this.disabled && isPlainObject(data)) {\n        var transformed = false;\n\n        if (options.rotatable) {\n          if (isNumber(data.rotate) && data.rotate !== imageData.rotate) {\n            imageData.rotate = data.rotate;\n            transformed = true;\n          }\n        }\n\n        if (options.scalable) {\n          if (isNumber(data.scaleX) && data.scaleX !== imageData.scaleX) {\n            imageData.scaleX = data.scaleX;\n            transformed = true;\n          }\n\n          if (isNumber(data.scaleY) && data.scaleY !== imageData.scaleY) {\n            imageData.scaleY = data.scaleY;\n            transformed = true;\n          }\n        }\n\n        if (transformed) {\n          this.renderCanvas(true, true);\n        }\n\n        var ratio = imageData.width / imageData.naturalWidth;\n\n        if (isNumber(data.x)) {\n          cropBoxData.left = data.x * ratio + canvasData.left;\n        }\n\n        if (isNumber(data.y)) {\n          cropBoxData.top = data.y * ratio + canvasData.top;\n        }\n\n        if (isNumber(data.width)) {\n          cropBoxData.width = data.width * ratio;\n        }\n\n        if (isNumber(data.height)) {\n          cropBoxData.height = data.height * ratio;\n        }\n\n        this.setCropBoxData(cropBoxData);\n      }\n\n      return this;\n    },\n\n    /**\n     * Get the container size data.\n     * @returns {Object} The result container data.\n     */\n    getContainerData: function getContainerData() {\n      return this.ready ? assign({}, this.containerData) : {};\n    },\n\n    /**\n     * Get the image position and size data.\n     * @returns {Object} The result image data.\n     */\n    getImageData: function getImageData() {\n      return this.sized ? assign({}, this.imageData) : {};\n    },\n\n    /**\n     * Get the canvas position and size data.\n     * @returns {Object} The result canvas data.\n     */\n    getCanvasData: function getCanvasData() {\n      var canvasData = this.canvasData;\n      var data = {};\n\n      if (this.ready) {\n        forEach(['left', 'top', 'width', 'height', 'naturalWidth', 'naturalHeight'], function (n) {\n          data[n] = canvasData[n];\n        });\n      }\n\n      return data;\n    },\n\n    /**\n     * Set the canvas position and size with new data.\n     * @param {Object} data - The new canvas data.\n     * @returns {Cropper} this\n     */\n    setCanvasData: function setCanvasData(data) {\n      var canvasData = this.canvasData;\n      var aspectRatio = canvasData.aspectRatio;\n\n      if (this.ready && !this.disabled && isPlainObject(data)) {\n        if (isNumber(data.left)) {\n          canvasData.left = data.left;\n        }\n\n        if (isNumber(data.top)) {\n          canvasData.top = data.top;\n        }\n\n        if (isNumber(data.width)) {\n          canvasData.width = data.width;\n          canvasData.height = data.width / aspectRatio;\n        } else if (isNumber(data.height)) {\n          canvasData.height = data.height;\n          canvasData.width = data.height * aspectRatio;\n        }\n\n        this.renderCanvas(true);\n      }\n\n      return this;\n    },\n\n    /**\n     * Get the crop box position and size data.\n     * @returns {Object} The result crop box data.\n     */\n    getCropBoxData: function getCropBoxData() {\n      var cropBoxData = this.cropBoxData;\n      var data;\n\n      if (this.ready && this.cropped) {\n        data = {\n          left: cropBoxData.left,\n          top: cropBoxData.top,\n          width: cropBoxData.width,\n          height: cropBoxData.height\n        };\n      }\n\n      return data || {};\n    },\n\n    /**\n     * Set the crop box position and size with new data.\n     * @param {Object} data - The new crop box data.\n     * @returns {Cropper} this\n     */\n    setCropBoxData: function setCropBoxData(data) {\n      var cropBoxData = this.cropBoxData;\n      var aspectRatio = this.options.aspectRatio;\n      var widthChanged;\n      var heightChanged;\n\n      if (this.ready && this.cropped && !this.disabled && isPlainObject(data)) {\n        if (isNumber(data.left)) {\n          cropBoxData.left = data.left;\n        }\n\n        if (isNumber(data.top)) {\n          cropBoxData.top = data.top;\n        }\n\n        if (isNumber(data.width) && data.width !== cropBoxData.width) {\n          widthChanged = true;\n          cropBoxData.width = data.width;\n        }\n\n        if (isNumber(data.height) && data.height !== cropBoxData.height) {\n          heightChanged = true;\n          cropBoxData.height = data.height;\n        }\n\n        if (aspectRatio) {\n          if (widthChanged) {\n            cropBoxData.height = cropBoxData.width / aspectRatio;\n          } else if (heightChanged) {\n            cropBoxData.width = cropBoxData.height * aspectRatio;\n          }\n        }\n\n        this.renderCropBox();\n      }\n\n      return this;\n    },\n\n    /**\n     * Get a canvas drawn the cropped image.\n     * @param {Object} [options={}] - The config options.\n     * @returns {HTMLCanvasElement} - The result canvas.\n     */\n    getCroppedCanvas: function getCroppedCanvas() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      if (!this.ready || !window.HTMLCanvasElement) {\n        return null;\n      }\n\n      var canvasData = this.canvasData;\n      var source = getSourceCanvas(this.image, this.imageData, canvasData, options); // Returns the source canvas if it is not cropped.\n\n      if (!this.cropped) {\n        return source;\n      }\n\n      var _this$getData = this.getData(),\n          initialX = _this$getData.x,\n          initialY = _this$getData.y,\n          initialWidth = _this$getData.width,\n          initialHeight = _this$getData.height;\n\n      var ratio = source.width / Math.floor(canvasData.naturalWidth);\n\n      if (ratio !== 1) {\n        initialX *= ratio;\n        initialY *= ratio;\n        initialWidth *= ratio;\n        initialHeight *= ratio;\n      }\n\n      var aspectRatio = initialWidth / initialHeight;\n      var maxSizes = getAdjustedSizes({\n        aspectRatio: aspectRatio,\n        width: options.maxWidth || Infinity,\n        height: options.maxHeight || Infinity\n      });\n      var minSizes = getAdjustedSizes({\n        aspectRatio: aspectRatio,\n        width: options.minWidth || 0,\n        height: options.minHeight || 0\n      }, 'cover');\n\n      var _getAdjustedSizes = getAdjustedSizes({\n        aspectRatio: aspectRatio,\n        width: options.width || (ratio !== 1 ? source.width : initialWidth),\n        height: options.height || (ratio !== 1 ? source.height : initialHeight)\n      }),\n          width = _getAdjustedSizes.width,\n          height = _getAdjustedSizes.height;\n\n      width = Math.min(maxSizes.width, Math.max(minSizes.width, width));\n      height = Math.min(maxSizes.height, Math.max(minSizes.height, height));\n      var canvas = document.createElement('canvas');\n      var context = canvas.getContext('2d');\n      canvas.width = normalizeDecimalNumber(width);\n      canvas.height = normalizeDecimalNumber(height);\n      context.fillStyle = options.fillColor || 'transparent';\n      context.fillRect(0, 0, width, height);\n      var _options$imageSmoothi = options.imageSmoothingEnabled,\n          imageSmoothingEnabled = _options$imageSmoothi === void 0 ? true : _options$imageSmoothi,\n          imageSmoothingQuality = options.imageSmoothingQuality;\n      context.imageSmoothingEnabled = imageSmoothingEnabled;\n\n      if (imageSmoothingQuality) {\n        context.imageSmoothingQuality = imageSmoothingQuality;\n      } // https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D.drawImage\n\n\n      var sourceWidth = source.width;\n      var sourceHeight = source.height; // Source canvas parameters\n\n      var srcX = initialX;\n      var srcY = initialY;\n      var srcWidth;\n      var srcHeight; // Destination canvas parameters\n\n      var dstX;\n      var dstY;\n      var dstWidth;\n      var dstHeight;\n\n      if (srcX <= -initialWidth || srcX > sourceWidth) {\n        srcX = 0;\n        srcWidth = 0;\n        dstX = 0;\n        dstWidth = 0;\n      } else if (srcX <= 0) {\n        dstX = -srcX;\n        srcX = 0;\n        srcWidth = Math.min(sourceWidth, initialWidth + srcX);\n        dstWidth = srcWidth;\n      } else if (srcX <= sourceWidth) {\n        dstX = 0;\n        srcWidth = Math.min(initialWidth, sourceWidth - srcX);\n        dstWidth = srcWidth;\n      }\n\n      if (srcWidth <= 0 || srcY <= -initialHeight || srcY > sourceHeight) {\n        srcY = 0;\n        srcHeight = 0;\n        dstY = 0;\n        dstHeight = 0;\n      } else if (srcY <= 0) {\n        dstY = -srcY;\n        srcY = 0;\n        srcHeight = Math.min(sourceHeight, initialHeight + srcY);\n        dstHeight = srcHeight;\n      } else if (srcY <= sourceHeight) {\n        dstY = 0;\n        srcHeight = Math.min(initialHeight, sourceHeight - srcY);\n        dstHeight = srcHeight;\n      }\n\n      var params = [srcX, srcY, srcWidth, srcHeight]; // Avoid \"IndexSizeError\"\n\n      if (dstWidth > 0 && dstHeight > 0) {\n        var scale = width / initialWidth;\n        params.push(dstX * scale, dstY * scale, dstWidth * scale, dstHeight * scale);\n      } // All the numerical parameters should be integer for `drawImage`\n      // https://github.com/fengyuanchen/cropper/issues/476\n\n\n      context.drawImage.apply(context, [source].concat(_toConsumableArray(params.map(function (param) {\n        return Math.floor(normalizeDecimalNumber(param));\n      }))));\n      return canvas;\n    },\n\n    /**\n     * Change the aspect ratio of the crop box.\n     * @param {number} aspectRatio - The new aspect ratio.\n     * @returns {Cropper} this\n     */\n    setAspectRatio: function setAspectRatio(aspectRatio) {\n      var options = this.options;\n\n      if (!this.disabled && !isUndefined(aspectRatio)) {\n        // 0 -> NaN\n        options.aspectRatio = Math.max(0, aspectRatio) || NaN;\n\n        if (this.ready) {\n          this.initCropBox();\n\n          if (this.cropped) {\n            this.renderCropBox();\n          }\n        }\n      }\n\n      return this;\n    },\n\n    /**\n     * Change the drag mode.\n     * @param {string} mode - The new drag mode.\n     * @returns {Cropper} this\n     */\n    setDragMode: function setDragMode(mode) {\n      var options = this.options,\n          dragBox = this.dragBox,\n          face = this.face;\n\n      if (this.ready && !this.disabled) {\n        var croppable = mode === DRAG_MODE_CROP;\n        var movable = options.movable && mode === DRAG_MODE_MOVE;\n        mode = croppable || movable ? mode : DRAG_MODE_NONE;\n        options.dragMode = mode;\n        setData(dragBox, DATA_ACTION, mode);\n        toggleClass(dragBox, CLASS_CROP, croppable);\n        toggleClass(dragBox, CLASS_MOVE, movable);\n\n        if (!options.cropBoxMovable) {\n          // Sync drag mode to crop box when it is not movable\n          setData(face, DATA_ACTION, mode);\n          toggleClass(face, CLASS_CROP, croppable);\n          toggleClass(face, CLASS_MOVE, movable);\n        }\n      }\n\n      return this;\n    }\n  };\n\n  var AnotherCropper = WINDOW.Cropper;\n\n  var Cropper =\n  /*#__PURE__*/\n  function () {\n    /**\n     * Create a new Cropper.\n     * @param {Element} element - The target element for cropping.\n     * @param {Object} [options={}] - The configuration options.\n     */\n    function Cropper(element) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      _classCallCheck(this, Cropper);\n\n      if (!element || !REGEXP_TAG_NAME.test(element.tagName)) {\n        throw new Error('The first argument is required and must be an <img> or <canvas> element.');\n      }\n\n      this.element = element;\n      this.options = assign({}, DEFAULTS, isPlainObject(options) && options);\n      this.cropped = false;\n      this.disabled = false;\n      this.pointers = {};\n      this.ready = false;\n      this.reloading = false;\n      this.replaced = false;\n      this.sized = false;\n      this.sizing = false;\n      this.init();\n    }\n\n    _createClass(Cropper, [{\n      key: \"init\",\n      value: function init() {\n        var element = this.element;\n        var tagName = element.tagName.toLowerCase();\n        var url;\n\n        if (element[NAMESPACE]) {\n          return;\n        }\n\n        element[NAMESPACE] = this;\n\n        if (tagName === 'img') {\n          this.isImg = true; // e.g.: \"img/picture.jpg\"\n\n          url = element.getAttribute('src') || '';\n          this.originalUrl = url; // Stop when it's a blank image\n\n          if (!url) {\n            return;\n          } // e.g.: \"http://example.com/img/picture.jpg\"\n\n\n          url = element.src;\n        } else if (tagName === 'canvas' && window.HTMLCanvasElement) {\n          url = element.toDataURL();\n        }\n\n        this.load(url);\n      }\n    }, {\n      key: \"load\",\n      value: function load(url) {\n        var _this = this;\n\n        if (!url) {\n          return;\n        }\n\n        this.url = url;\n        this.imageData = {};\n        var element = this.element,\n            options = this.options;\n\n        if (!options.rotatable && !options.scalable) {\n          options.checkOrientation = false;\n        } // Only IE10+ supports Typed Arrays\n\n\n        if (!options.checkOrientation || !window.ArrayBuffer) {\n          this.clone();\n          return;\n        } // Detect the mime type of the image directly if it is a Data URL\n\n\n        if (REGEXP_DATA_URL.test(url)) {\n          // Read ArrayBuffer from Data URL of JPEG images directly for better performance\n          if (REGEXP_DATA_URL_JPEG.test(url)) {\n            this.read(dataURLToArrayBuffer(url));\n          } else {\n            // Only a JPEG image may contains Exif Orientation information,\n            // the rest types of Data URLs are not necessary to check orientation at all.\n            this.clone();\n          }\n\n          return;\n        } // 1. Detect the mime type of the image by a XMLHttpRequest.\n        // 2. Load the image as ArrayBuffer for reading orientation if its a JPEG image.\n\n\n        var xhr = new XMLHttpRequest();\n        var clone = this.clone.bind(this);\n        this.reloading = true;\n        this.xhr = xhr; // 1. Cross origin requests are only supported for protocol schemes:\n        // http, https, data, chrome, chrome-extension.\n        // 2. Access to XMLHttpRequest from a Data URL will be blocked by CORS policy\n        // in some browsers as IE11 and Safari.\n\n        xhr.onabort = clone;\n        xhr.onerror = clone;\n        xhr.ontimeout = clone;\n\n        xhr.onprogress = function () {\n          // Abort the request directly if it not a JPEG image for better performance\n          if (xhr.getResponseHeader('content-type') !== MIME_TYPE_JPEG) {\n            xhr.abort();\n          }\n        };\n\n        xhr.onload = function () {\n          _this.read(xhr.response);\n        };\n\n        xhr.onloadend = function () {\n          _this.reloading = false;\n          _this.xhr = null;\n        }; // Bust cache when there is a \"crossOrigin\" property to avoid browser cache error\n\n\n        if (options.checkCrossOrigin && isCrossOriginURL(url) && element.crossOrigin) {\n          url = addTimestamp(url);\n        }\n\n        xhr.open('GET', url);\n        xhr.responseType = 'arraybuffer';\n        xhr.withCredentials = element.crossOrigin === 'use-credentials';\n        xhr.send();\n      }\n    }, {\n      key: \"read\",\n      value: function read(arrayBuffer) {\n        var options = this.options,\n            imageData = this.imageData; // Reset the orientation value to its default value 1\n        // as some iOS browsers will render image with its orientation\n\n        var orientation = resetAndGetOrientation(arrayBuffer);\n        var rotate = 0;\n        var scaleX = 1;\n        var scaleY = 1;\n\n        if (orientation > 1) {\n          // Generate a new URL which has the default orientation value\n          this.url = arrayBufferToDataURL(arrayBuffer, MIME_TYPE_JPEG);\n\n          var _parseOrientation = parseOrientation(orientation);\n\n          rotate = _parseOrientation.rotate;\n          scaleX = _parseOrientation.scaleX;\n          scaleY = _parseOrientation.scaleY;\n        }\n\n        if (options.rotatable) {\n          imageData.rotate = rotate;\n        }\n\n        if (options.scalable) {\n          imageData.scaleX = scaleX;\n          imageData.scaleY = scaleY;\n        }\n\n        this.clone();\n      }\n    }, {\n      key: \"clone\",\n      value: function clone() {\n        var element = this.element,\n            url = this.url;\n        var crossOrigin = element.crossOrigin;\n        var crossOriginUrl = url;\n\n        if (this.options.checkCrossOrigin && isCrossOriginURL(url)) {\n          if (!crossOrigin) {\n            crossOrigin = 'anonymous';\n          } // Bust cache when there is not a \"crossOrigin\" property (#519)\n\n\n          crossOriginUrl = addTimestamp(url);\n        }\n\n        this.crossOrigin = crossOrigin;\n        this.crossOriginUrl = crossOriginUrl;\n        var image = document.createElement('img');\n\n        if (crossOrigin) {\n          image.crossOrigin = crossOrigin;\n        }\n\n        image.src = crossOriginUrl || url;\n        image.alt = element.alt || 'The image to crop';\n        this.image = image;\n        image.onload = this.start.bind(this);\n        image.onerror = this.stop.bind(this);\n        addClass(image, CLASS_HIDE);\n        element.parentNode.insertBefore(image, element.nextSibling);\n      }\n    }, {\n      key: \"start\",\n      value: function start() {\n        var _this2 = this;\n\n        var image = this.image;\n        image.onload = null;\n        image.onerror = null;\n        this.sizing = true; // Match all browsers that use WebKit as the layout engine in iOS devices,\n        // such as Safari for iOS, Chrome for iOS, and in-app browsers.\n\n        var isIOSWebKit = WINDOW.navigator && /(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(WINDOW.navigator.userAgent);\n\n        var done = function done(naturalWidth, naturalHeight) {\n          assign(_this2.imageData, {\n            naturalWidth: naturalWidth,\n            naturalHeight: naturalHeight,\n            aspectRatio: naturalWidth / naturalHeight\n          });\n          _this2.sizing = false;\n          _this2.sized = true;\n\n          _this2.build();\n        }; // Most modern browsers (excepts iOS WebKit)\n\n\n        if (image.naturalWidth && !isIOSWebKit) {\n          done(image.naturalWidth, image.naturalHeight);\n          return;\n        }\n\n        var sizingImage = document.createElement('img');\n        var body = document.body || document.documentElement;\n        this.sizingImage = sizingImage;\n\n        sizingImage.onload = function () {\n          done(sizingImage.width, sizingImage.height);\n\n          if (!isIOSWebKit) {\n            body.removeChild(sizingImage);\n          }\n        };\n\n        sizingImage.src = image.src; // iOS WebKit will convert the image automatically\n        // with its orientation once append it into DOM (#279)\n\n        if (!isIOSWebKit) {\n          sizingImage.style.cssText = 'left:0;' + 'max-height:none!important;' + 'max-width:none!important;' + 'min-height:0!important;' + 'min-width:0!important;' + 'opacity:0;' + 'position:absolute;' + 'top:0;' + 'z-index:-1;';\n          body.appendChild(sizingImage);\n        }\n      }\n    }, {\n      key: \"stop\",\n      value: function stop() {\n        var image = this.image;\n        image.onload = null;\n        image.onerror = null;\n        image.parentNode.removeChild(image);\n        this.image = null;\n      }\n    }, {\n      key: \"build\",\n      value: function build() {\n        if (!this.sized || this.ready) {\n          return;\n        }\n\n        var element = this.element,\n            options = this.options,\n            image = this.image; // Create cropper elements\n\n        var container = element.parentNode;\n        var template = document.createElement('div');\n        template.innerHTML = TEMPLATE;\n        var cropper = template.querySelector(\".\".concat(NAMESPACE, \"-container\"));\n        var canvas = cropper.querySelector(\".\".concat(NAMESPACE, \"-canvas\"));\n        var dragBox = cropper.querySelector(\".\".concat(NAMESPACE, \"-drag-box\"));\n        var cropBox = cropper.querySelector(\".\".concat(NAMESPACE, \"-crop-box\"));\n        var face = cropBox.querySelector(\".\".concat(NAMESPACE, \"-face\"));\n        this.container = container;\n        this.cropper = cropper;\n        this.canvas = canvas;\n        this.dragBox = dragBox;\n        this.cropBox = cropBox;\n        this.viewBox = cropper.querySelector(\".\".concat(NAMESPACE, \"-view-box\"));\n        this.face = face;\n        canvas.appendChild(image); // Hide the original image\n\n        addClass(element, CLASS_HIDDEN); // Inserts the cropper after to the current image\n\n        container.insertBefore(cropper, element.nextSibling); // Show the image if is hidden\n\n        if (!this.isImg) {\n          removeClass(image, CLASS_HIDE);\n        }\n\n        this.initPreview();\n        this.bind();\n        options.initialAspectRatio = Math.max(0, options.initialAspectRatio) || NaN;\n        options.aspectRatio = Math.max(0, options.aspectRatio) || NaN;\n        options.viewMode = Math.max(0, Math.min(3, Math.round(options.viewMode))) || 0;\n        addClass(cropBox, CLASS_HIDDEN);\n\n        if (!options.guides) {\n          addClass(cropBox.getElementsByClassName(\"\".concat(NAMESPACE, \"-dashed\")), CLASS_HIDDEN);\n        }\n\n        if (!options.center) {\n          addClass(cropBox.getElementsByClassName(\"\".concat(NAMESPACE, \"-center\")), CLASS_HIDDEN);\n        }\n\n        if (options.background) {\n          addClass(cropper, \"\".concat(NAMESPACE, \"-bg\"));\n        }\n\n        if (!options.highlight) {\n          addClass(face, CLASS_INVISIBLE);\n        }\n\n        if (options.cropBoxMovable) {\n          addClass(face, CLASS_MOVE);\n          setData(face, DATA_ACTION, ACTION_ALL);\n        }\n\n        if (!options.cropBoxResizable) {\n          addClass(cropBox.getElementsByClassName(\"\".concat(NAMESPACE, \"-line\")), CLASS_HIDDEN);\n          addClass(cropBox.getElementsByClassName(\"\".concat(NAMESPACE, \"-point\")), CLASS_HIDDEN);\n        }\n\n        this.render();\n        this.ready = true;\n        this.setDragMode(options.dragMode);\n\n        if (options.autoCrop) {\n          this.crop();\n        }\n\n        this.setData(options.data);\n\n        if (isFunction(options.ready)) {\n          addListener(element, EVENT_READY, options.ready, {\n            once: true\n          });\n        }\n\n        dispatchEvent(element, EVENT_READY);\n      }\n    }, {\n      key: \"unbuild\",\n      value: function unbuild() {\n        if (!this.ready) {\n          return;\n        }\n\n        this.ready = false;\n        this.unbind();\n        this.resetPreview();\n        this.cropper.parentNode.removeChild(this.cropper);\n        removeClass(this.element, CLASS_HIDDEN);\n      }\n    }, {\n      key: \"uncreate\",\n      value: function uncreate() {\n        if (this.ready) {\n          this.unbuild();\n          this.ready = false;\n          this.cropped = false;\n        } else if (this.sizing) {\n          this.sizingImage.onload = null;\n          this.sizing = false;\n          this.sized = false;\n        } else if (this.reloading) {\n          this.xhr.onabort = null;\n          this.xhr.abort();\n        } else if (this.image) {\n          this.stop();\n        }\n      }\n      /**\n       * Get the no conflict cropper class.\n       * @returns {Cropper} The cropper class.\n       */\n\n    }], [{\n      key: \"noConflict\",\n      value: function noConflict() {\n        window.Cropper = AnotherCropper;\n        return Cropper;\n      }\n      /**\n       * Change the default options.\n       * @param {Object} options - The new default options.\n       */\n\n    }, {\n      key: \"setDefaults\",\n      value: function setDefaults(options) {\n        assign(DEFAULTS, isPlainObject(options) && options);\n      }\n    }]);\n\n    return Cropper;\n  }();\n\n  assign(Cropper.prototype, render, preview, events, handlers, change, methods);\n\n  return Cropper;\n\n}));\n","<script>\n    import {afterUpdate, getContext, onMount} from \"svelte\";\n    import {fade} from 'svelte/transition';\n    import MyModal from \"svelte-mymodal\";\n    import jsx from \"js-extension-ling\";\n    import Cropper from \"cropperjs\";\n    import DropZoneHandler from \"js-dropzone-handler\";\n\n\n    //----------------------------------------\n    // PROPS\n    //----------------------------------------\n    export let isOpen = false;\n    export let uFile = {};\n    export let title = \"FileEditor\";\n    export let errors = [];\n\n\n    //----------------------------------------\n    // STATE\n    //----------------------------------------\n    let useOriginalImageChecked = false;\n    let stateCpt = 0;\n\n\n    //----------------------------------------\n    // CONTEXT\n    //----------------------------------------\n    const {\n        onCloseFileEditorBtnClicked,\n        onFileEditorFileDropped,\n        onFileEditorUpdated,\n        fileEditorOptions,\n    } = getContext(\"fileUploader\");\n    const feo = fileEditorOptions;\n\n\n    //----------------------------------------\n    // HTML THEME\n    //----------------------------------------\n    let styleBtnCancel = 'btn-cancel';\n    let styleBtnUpdate = 'btn-update';\n    if (true === feo.useBootstrap) {\n        styleBtnCancel = 'btn btn-danger mr-2';\n        styleBtnUpdate = 'btn btn-success';\n    }\n\n\n    //----------------------------------------\n    // OTHER VARS\n    //----------------------------------------\n    let cssIdCounter = jsx.cssId();\n    let isImage = false;\n    let initialCropData = null;\n    let newDrop = false;\n    let originalBlob = null;\n    let pendingOriginalBlob = false;\n\n\n    //----------------------------------------\n    // JS LIBS STUFF\n    //----------------------------------------\n    let jDialog;\n    let jSelect;\n    let cropper = null;\n    let dropZoneHandler = null;\n\n\n    //----------------------------------------\n    // LIFECYCLE\n    //----------------------------------------\n    afterUpdate(() => {\n\n\n        if (true === isOpen) {\n\n\n            jDialog = jQuery(`#file-editor-dialog-${cssIdCounter}`);\n\n            //----------------------------------------\n            // TAGS\n            //----------------------------------------\n            if (true === feo.useTags) {\n                jSelect = jQuery(`#id-fileuploader-tags-${cssIdCounter}`);\n                let select2Options = {\n                    // multiple: true,\n                };\n                if (feo.availableTags.length > 0) {\n                    select2Options.data = _toSelect2Data(feo.availableTags);\n                }\n                if (true === feo.allowCustomTags) {\n                    select2Options[\"tags\"] = true;\n                }\n                select2Options[\"maximumSelectionLength\"] = feo.nbTagsAllowed;\n                jSelect.select2(select2Options);\n            }\n\n\n            //----------------------------------------\n            // IMAGE EDITOR\n            //----------------------------------------\n            isImage = jsx.mimeIsImage(uFile.type);\n            if (false === pendingOriginalBlob) {\n\n\n                if (true === isImage) {\n\n\n                    setTimeout(() => {\n\n\n                        let jImageOriginal = jDialog.find('.image-original');\n                        if (jImageOriginal.length) {\n\n                            let cropperImgRef = jImageOriginal[0];\n\n\n                            //----------------------------------------\n                            // CROPPER\n                            //----------------------------------------\n\n                            let theUrl;\n                            if (\n                                    true === useOriginalImageChecked &&\n                                    null !== originalBlob\n                            ) {\n                                theUrl = URL.createObjectURL(originalBlob);\n                            } else {\n                                theUrl = URL.createObjectURL(uFile.file);\n                            }\n\n                            cropperImgRef.src = theUrl;\n                            let cropperOptions = {\n                                preview: '.img-preview',\n                                viewMode: 1,\n                                autoCropArea: 1,\n                                ready() {\n                                    initialCropData = cropper.getData();\n                                },\n                            };\n\n\n                            cropper = new Cropper(cropperImgRef, cropperOptions);\n\n\n                            //----------------------------------------\n                            // CROPPER TOOLBAR\n                            //----------------------------------------\n                            jDialog.find('.image-editor-toolbar').off(\"click\").on('click', '[data-method]', function () {\n                                var that = jQuery(this);\n                                var data = that.data();\n\n                                var cropped;\n                                var $target;\n                                var result;\n\n                                if (that.prop('disabled') || that.hasClass('disabled')) {\n                                    return;\n                                }\n\n                                if (cropper && data.method) {\n                                    data = jQuery.extend({}, data); // Clone a new one\n\n                                    if (typeof data.target !== 'undefined') {\n                                        $target = jQuery(data.target);\n\n                                        if (typeof data.option === 'undefined') {\n                                            try {\n                                                data.option = JSON.parse($target.val());\n                                            } catch (e) {\n                                                console.log(e.message);\n                                            }\n                                        }\n                                    }\n                                    cropped = cropper.cropped;\n\n\n                                    switch (data.method) {\n                                        case 'rotate':\n                                            if (cropped) {\n                                                cropper.clear();\n                                            }\n\n                                            break;\n                                    }\n\n                                    result = cropper[data.method](data.option, data.secondOption);\n\n                                    switch (data.method) {\n                                        case 'rotate':\n                                            if (cropped) {\n                                                cropper.crop();\n                                            }\n\n                                            break;\n\n                                        case 'scaleX':\n                                        case 'scaleY':\n                                            jQuery(this).data('option', -data.option);\n                                            break;\n                                    }\n                                }\n                            });\n                        }\n\n\n                    }, 1);\n                } else {\n                    /**\n                     * Required when the user first upload a non image, and then uploads an image again\n                     * (otherwise the cropper isn't initialized properly).\n                     */\n                    destroyCropper();\n                }\n            }\n\n\n            //----------------------------------------\n            // DROP ZONE\n            //----------------------------------------\n            if (null === dropZoneHandler) {\n                dropZoneHandler = new DropZoneHandler({\n                    container: jDialog[0],\n                    cssClass: feo.dropzoneOverClass || \"dropzone-hover\",\n                    onDrop: (files) => {\n                        useOriginalImageChecked = false;\n                        originalBlob = null;\n                        onFileEditorFileDropped(uFile, files[0]);\n                    },\n                });\n                dropZoneHandler.start();\n            }\n        } else {\n            destroyCropper();\n            dropZoneHandler = null;\n        }\n    });\n\n\n    //----------------------------------------\n    // FUNCTIONS\n    //----------------------------------------\n    /**\n     * https://select2.org/data-sources/arrays\n     */\n    function _toSelect2Data(tags) {\n        var arr = [];\n        for (var i in tags) {\n            var tag = tags[i];\n            arr.push({\n                \"id\": tag,\n                \"text\": tag,\n            })\n        }\n        return arr;\n    }\n\n    function removeError(e) {\n        e.target.closest(\".file-editor-error\").remove();\n    }\n\n\n    function destroyCropper() {\n        if (null !== cropper) {\n            cropper.destroy();\n        }\n        cropper = null;\n    }\n\n    async function onUpdateBtnClicked() {\n\n\n        let hasBeenCropped = false;\n        if (null !== cropper) {\n            hasBeenCropped = (false === jsx.compareObjects(initialCropData, cropper.getData()));\n        }\n\n\n        await onFileEditorUpdated(uFile, await getFileEditorData(), {\n            cropped: hasBeenCropped,\n            dropped: newDrop,\n            original: useOriginalImageChecked,\n        });\n\n        if (0 === errors.length) {\n            close();\n            useOriginalImageChecked = false; // make sure the user opens his files (and not the original) next time he opens the dialog\n        }\n    }\n\n\n    function close() {\n        originalBlob = null;\n        onCloseFileEditorBtnClicked();\n    }\n\n    async function getFileEditorData() {\n\n\n        let ret = {};\n        let directory;\n\n\n        if (true === feo.useDirectory) {\n            if (true === feo.directoryCanBeUpdated) {\n                directory = jDialog.find(\".input-dirname\").val();\n            } else {\n                directory = feo.directory;\n            }\n            ret.directory = directory;\n        }\n\n\n        ret.name = jDialog.find(\".input-basename\").val() + \".\" + jDialog.find(\".input-extension\").val();\n\n\n        if (true === feo.usePrivacy) {\n            let isPrivate = jsx.toInt(jDialog.find('.input-privacy').prop('checked'));\n            ret.is_private = isPrivate;\n        }\n\n\n        if (true === feo.useTags) {\n            let tags = jDialog.find('.select-tags').val();\n            ret.tags = tags;\n        }\n\n\n        let file = uFile.file;\n        if (null !== cropper) {\n            file = await getFileEditorBlob(cropper);\n        }\n        ret.file = file;\n        return ret;\n    }\n\n    async function getFileEditorBlob(cropper) {\n        return new Promise((resolve, reject) => {\n            cropper.getCroppedCanvas().toBlob((blob) => {\n                resolve(blob);\n            });\n        });\n    }\n\n    async function toggleOriginal(e) {\n\n        destroyCropper();\n\n        if (true === e.target.checked) {\n            useOriginalImageChecked = true;\n            if (null !== uFile.original_url) {\n\n                if (null === originalBlob) {\n\n                    pendingOriginalBlob = true;\n\n\n                    let response = await fetch(uFile.original_url).catch(e => {\n                        addError(\"Server error: \" + e.message);\n                    });\n                    if (true === response.ok) {\n\n                        let blob = await response.blob().catch(e => {\n                            addError(\"Blob error: could not convert the url into a blob (\" + uFile.original_url + \")\");\n                        });\n\n\n                        setTimeout(function () {\n                            originalBlob = blob;\n                            pendingOriginalBlob = false;\n                        }, 1);\n\n\n                    } else {\n                        addError(\"Server error: \" + response.statusText);\n                    }\n                } else {\n                    pendingOriginalBlob = false;\n                    stateCpt++;\n                }\n            }\n        } else {\n            useOriginalImageChecked = false;\n            pendingOriginalBlob = false;\n            stateCpt++;\n        }\n\n    }\n\n    function addError(errMsg) {\n        errors = [...errors, errMsg];\n    }\n\n\n</script>\n\n\n{#if null !== uFile && true === isOpen}\n    <div class=\"overlay\" transition:fade>\n        <MyModal open={isOpen} options={{dragHandle: \".header\"}}>\n            <div class=\"container file-editor-container\" id=\"file-editor-dialog-{cssIdCounter}\">\n\n                <div style=\"display:none\">{stateCpt}</div>\n                <div class=\"header\">\n                    <span class=\"title\">{title}</span>\n                    <span on:click={close} class=\"close-modal-btn far fa-times-circle\"></span>\n                </div>\n\n                <div class=\"body file-editor\">\n\n\n                    <div title=\"File Editor\" class=\"dialog-file-editor\">\n                        <div class=\"file-editor-error-container\">\n                            {#each errors as errMsg}\n                                <div class=\"file-editor-error\">\n                                    <span>{@html errMsg}</span>\n                                    <span on:click={removeError} class=\"btn-close-error\"><i\n                                            class=\"btn-close-error far fa-window-close\"></i></span>\n                                </div>\n                            {/each}\n                        </div>\n\n\n                        <form action=\"\" method=\"post\">\n\n\n                            <div class=\"file-editor-block-1\">\n\n\n                                <div class=\"control-group control-dirname\">\n\n\n                                    {#if true === feo.useDirectory}\n                                        <label for=\"id-fileuploader-dirname-{cssIdCounter}\">Parent dir: </label>\n                                        {#if true === feo.directoryCanBeUpdated}\n                                            <input id=\"id-fileuploader-dirname-{cssIdCounter}\" type=\"text\"\n                                                   name=\"dirname\"\n                                                   value={uFile.directory}\n                                                   class=\"input-dirname\"/>\n                                        {:else}\n                                            <span class=\"element-dirname\">{feo.directory}</span>\n                                        {/if}\n                                    {/if}\n\n                                </div>\n\n\n                                {#if true === feo.usePrivacy}\n                                    <div class=\"control-group control-privacy\">\n                                        <label for=\"id-fileuploader-privacy-{cssIdCounter}\">Is private</label>\n                                        <input id=\"id-fileuploader-privacy-{cssIdCounter}\" type=\"checkbox\"\n                                               name=\"is_private\"\n                                               value=\"1\"\n                                               class=\"input-privacy\"\n                                               checked={jsx.toBool(uFile.is_private)}\n                                        />\n                                    </div>\n                                {/if}\n\n\n                            </div>\n\n\n                            <div class=\"control-group control-filename\">\n\n                                <label for=\"id-fileuploader-filename-{cssIdCounter}\">File name</label>\n\n                                <div class=\"filename-inputs-container\">\n                                    <input id=\"id-fileuploader-filename-{cssIdCounter}\" type=\"text\" name=\"basename\"\n                                           value={jsx.basename(uFile.name, false)}\n                                           class=\"input-basename\"/>\n                                    <input type=\"text\" name=\"extension\" value={jsx.getFileExtension(uFile.name)}\n                                           class=\"input-extension\" disabled={false === feo.fileExtensionCanBeUpdated}/>\n\n                                </div>\n                            </div>\n\n\n                            {#if true === feo.useTags}\n                                <div class=\"control-group control-tags\">\n                                    <label for=\"id-fileuploader-tags-{cssIdCounter}\">Tags</label>\n                                    <select class=\"select-tags\" id=\"id-fileuploader-tags-{cssIdCounter}\" name=\"tags[]\"\n                                            multiple>\n                                        {#each uFile.tags as tag}\n                                            <option value={tag} selected=\"selected\">{tag}</option>\n                                        {/each}\n                                    </select>\n                                </div>\n                            {/if}\n\n\n                            {#if true === feo.useImageEditor && true === isImage}\n                                <div class=\"control-group image-editor-container\">\n                                    <div class=\"image-editor-header\">\n                                        <label>Image Editor</label>\n                                        {#if true === feo.useKeepOriginalImage && null !== uFile.original_url}\n                                            <div class=\"control-original-toggle\">\n                                                <label for=\"id-fileuploader-original-toggle-{cssIdCounter}\">Use original\n                                                    image</label>\n                                                <input id=\"id-fileuploader-original-toggle-{cssIdCounter}\"\n                                                       type=\"checkbox\" value=\"1\"\n                                                       on:change={toggleOriginal}\n                                                       checked={useOriginalImageChecked}\n                                                       class=\"input-original-toggle\"/>\n                                            </div>\n                                        {/if}\n                                    </div>\n\n\n                                    <div class=\"image-editor-body\">\n\n                                        {#if true === uFile.is_loading || true === pendingOriginalBlob}\n                                            <div class=\"left\">\n                                                <div class=\"img-container is-loading\">\n                                                    <div class=\"spinner\">\n                                                        <i class=\"fas fa-cog fa-spin fa-5x\"></i>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        {:else}\n                                            <div class=\"left\">\n\n                                                <div class=\"img-container\">\n                                                    <img\n                                                            class=\"image-original\" src=\"\"\n                                                            alt=\"Canvas for the cropper editor\">\n                                                </div>\n\n\n                                                <div class=\"image-editor-toolbar\">\n                                                    <div class=\"btn-group\">\n                                                        <button type=\"button\" class=\"btn btn-primary\" data-method=\"zoom\"\n                                                                data-option=\"0.1\"\n                                                                title=\"Zoom In\">\n                                                            <span class=\"fa fa-search-plus\"></span>\n                                                        </button>\n                                                        <button type=\"button\" class=\"btn btn-primary\" data-method=\"zoom\"\n                                                                data-option=\"-0.1\"\n                                                                title=\"Zoom Out\">\n                                                            <span class=\"fa fa-search-minus\"></span>\n                                                        </button>\n                                                    </div>\n\n                                                    <div class=\"btn-group\">\n                                                        <button type=\"button\" class=\"btn btn-primary\"\n                                                                data-method=\"rotate\"\n                                                                data-option=\"-45\"\n                                                                title=\"Rotate Left\">\n                                                            <span class=\"fa fa-undo-alt\"></span>\n                                                        </button>\n\n                                                        <button type=\"button\" class=\"btn btn-primary\"\n                                                                data-method=\"rotate\"\n                                                                data-option=\"45\"\n                                                                title=\"Rotate Right\">\n                                                            <span class=\"fa fa-redo-alt\"></span>\n                                                        </button>\n                                                    </div>\n\n                                                    <div class=\"btn-group\">\n                                                        <button type=\"button\" class=\"btn btn-primary\"\n                                                                data-method=\"scaleX\"\n                                                                data-option=\"-1\"\n                                                                title=\"Flip Horizontal\">\n                                                            <span class=\"fa fa-arrows-alt-h\"></span>\n                                                        </button>\n\n                                                        <button type=\"button\" class=\"btn btn-primary\"\n                                                                data-method=\"scaleY\"\n                                                                data-option=\"-1\"\n                                                                title=\"Flip Vertical\">\n                                                            <span class=\"fa fa-arrows-alt-v\"></span>\n                                                        </button>\n                                                    </div>\n\n                                                    <div class=\"btn-group\">\n                                                        <button type=\"button\" class=\"btn btn-primary\"\n                                                                data-method=\"reset\"\n                                                                title=\"Reset\">\n                                                            <span class=\"fa fa-sync-alt\"></span>\n                                                        </button>\n                                                    </div>\n                                                </div>\n                                            </div>\n\n                                            <div class=\"img-preview-container\">\n                                                <div class=\"img-preview preview-lg\"></div>\n                                            </div>\n                                        {/if}\n                                    </div>\n\n\n                                </div>\n                            {/if}\n                        </form>\n\n\n                        <div class=\"buttons-bar\">\n\n\n                            {#if\n                            true === uFile.is_loading &&\n                            false === (true === feo.useImageEditor && true === isImage)\n                            }\n                                <div class=\"spinner\">\n                                    <i class=\"fas fa-circle-notch fa-spin fa-2x\"></i>\n                                </div>\n                            {/if}\n                            <div class=\"progress-bar\" class:show={uFile.progress > 0 && uFile.progress < 100}>\n                                Uploading... {uFile.progress}%\n                            </div>\n                            <button on:click|preventDefault={close} class={styleBtnCancel}>Cancel</button>\n                            <button on:click|preventDefault={onUpdateBtnClicked} class={styleBtnUpdate}>Update</button>\n                        </div>\n\n                    </div>\n\n\n                </div>\n            </div>\n        </MyModal>\n    </div>\n{/if}\n\n\n<style type=\"text/sass\" lang=\"scss\">\n\n\n    $errorColor: #cd0a0a;\n\n\n    :global(.file-editor-container.dropzone-hover) {\n        background-color: #f3f7ff !important;\n    }\n\n\n    .overlay {\n        position: fixed;\n        top: 0;\n        bottom: 0;\n        left: 0;\n        right: 0;\n        background: rgba(0, 0, 0, 0.2);\n        z-index: 1000000000; // move over the text items\n    }\n\n    .container {\n        min-width: 60%;\n        width: 60%;\n        margin: 0 auto;\n        margin-top: 10px;\n        padding: 10px;\n        border: 1px solid #fafafa;\n        background-color: white;\n\n\n        .header {\n            background: #ddd;\n            cursor: move;\n            padding: 6px;\n            display: flex;\n\n            .close-modal-btn {\n                cursor: pointer;\n                margin-left: auto;\n            }\n        }\n\n\n        .file-editor {\n\n\n            .file-editor-error-container {\n\n                .file-editor-error {\n\n                    color: white;\n                    padding: 10px;\n                    border: 1px solid $errorColor;\n                    background: $errorColor;\n                    margin-bottom: 2px;\n\n                    position: relative;\n\n                    .btn-close-error {\n\n                        position: absolute;\n                        top: 3px;\n                        right: 4px;\n\n                        cursor: pointer;\n\n                    }\n\n                }\n\n            }\n\n            .file-editor-block-1 {\n\n                display: flex;\n\n\n                .control-privacy {\n\n                    margin-left: auto;\n\n                }\n\n            }\n\n\n            .control-group {\n\n                margin-bottom: 0px;\n                border-bottom: 1px solid #fdfdfd;\n                padding-bottom: 10px;\n                padding-top: 10px;\n\n\n                &.control-basename, &.control-tags {\n\n                    display: flex;\n\n                    align-items: baseline;\n\n                    label {\n                        margin-right: 5px;\n\n                        white-space: nowrap;\n\n                    }\n\n                }\n\n                &.control-tags {\n\n                    align-items: flex-end;\n\n                }\n\n\n                &.control-dirname {\n\n                    display: flex;\n                    flex: 1;\n\n                    align-items: baseline;\n\n                    .input-dirname {\n                        flex: 1;\n                        margin-right: 10px;\n\n                    }\n\n                    .element-dirname {\n                        background: #ececec;\n                        padding: 5px;\n\n                    }\n\n                }\n\n\n                .filename-inputs-container {\n\n                    display: flex;\n                    width: 100%;\n\n                    box-sizing: border-box;\n\n                    .input-basename, .input-filename {\n                        flex: 1;\n                        margin-top: 7px;\n\n                    }\n\n\n                    .input-extension {\n                        width: 50px;\n                        margin-top: 7px;\n\n                    }\n\n                }\n\n\n                &.control-tags {\n\n                    label {\n\n                        display: block;\n                        margin-bottom: 10px;\n\n                    }\n\n                    .select-tags {\n\n                        display: block;\n                        width: 100%;\n\n                    }\n\n                }\n\n            }\n\n\n            //.img-container {\n            //  /* Never limit the container height here */\n            //  max-width: 100%;\n            //}\n            //\n            //.img-container img {\n            //  /* This is important */\n            //  width: 100%;\n            //}\n\n\n            .image-editor-container {\n                margin-top: 10px;\n                padding-top: 0px;\n                padding-bottom: 0px;\n\n            }\n\n            .image-editor-header {\n                display: flex;\n\n                .control-original-toggle {\n                    margin-left: auto;\n                }\n            }\n\n            .image-editor-body {\n                display: flex;\n\n                .left {\n                    flex: 1;\n                }\n            }\n\n            .img-container {\n                margin-top: 10px;\n                margin-bottom: 0px;\n                max-height: 497px;\n                min-height: 200px;\n\n                & > img {\n                    max-width: 100%;\n                    max-height: 290px;\n\n                }\n\n                &.is-loading {\n                    display: flex;\n                    justify-content: center;\n                    align-items: center;\n\n                    i {\n                        color: #a9bcea;\n                    }\n\n                }\n\n            }\n\n            @media (min-width: 768px) {\n\n                .img-container {\n                    min-height: 300px;\n\n                }\n            }\n\n\n            .image-editor-toolbar {\n\n                display: flex;\n\n                flex-wrap: wrap;\n                background: #d9d9d9;\n                padding: 10px;\n\n                justify-content: flex-start;\n\n\n                button {\n                    padding: 6px 4px 4px 4px;\n                    border-radius: 7px;\n                    border-color: #ececec;\n\n                }\n\n            }\n\n\n            .img-preview-container {\n                margin-top: 10px;\n                width: 100px;\n                display: flex;\n\n                justify-content: center;\n\n                .img-preview {\n\n                    float: left;\n                    margin-bottom: .5rem;\n                    margin-right: .5rem;\n                    border: 1px solid #ccc;\n\n                    overflow: hidden;\n\n                    &.preview-lg {\n                        height: 9rem;\n                        width: 16rem;\n\n                    }\n\n                    & > img {\n                        max-width: 100%;\n\n                    }\n\n                }\n\n            }\n\n\n            @media (min-width: 768px) {\n\n                .img-preview-container {\n                    width: 250px;\n\n                }\n            }\n\n\n            .buttons-bar {\n                text-align: right;\n                padding: 20px;\n                display: flex;\n                justify-content: flex-end;\n                align-items: center;\n\n                button {\n                    padding: 10px;\n                    font-size: 1.5em;\n                    cursor: pointer;\n                }\n\n\n                .btn-cancel {\n                    background: #f4dada;\n                }\n\n                .btn-update {\n                    background: #8bf27c;\n                }\n\n                .spinner {\n                    margin-right: 10px;\n\n                    i {\n                        color: #8e8e8e;\n                    }\n                }\n\n                .progress-bar {\n                    display: none;\n                    font-size: 1.4em;\n                    color: #b30f0f;\n                    margin-right: 30px;\n                    padding: 20px;\n                    position: static;\n                    overflow: hidden;\n                    animation: loadingShimmer 2s linear;\n                    animation-iteration-count: infinite;\n                    background-color: #fff;\n                    background-image: linear-gradient(to right, rgba(0, 0, 0, 0.03) 0, rgba(0, 0, 0, 0.1) 50%, rgba(0, 0, 0, 0.03) 60%) !important;\n                    background-size: 1200px 100% !important;\n\n                    &.show {\n                        display: block;\n                    }\n                }\n\n\n                @keyframes loadingShimmer {\n                    0% {\n                        background-position: -1200px 0\n                    }\n                    100% {\n                        background-position: 1200px 0\n                    }\n                }\n\n            }\n\n\n            .the-submit-button {\n                background: #0064ff;\n\n                color: white;\n\n            }\n\n            .fileeditor-uploader-progress {\n\n                display: none;\n\n                background: transparent;\n                color: #333;\n\n                border: none;\n                cursor: default !important;\n\n                &:active {\n\n                    background: transparent;\n                    color: #333;\n\n                }\n\n            }\n\n        }\n    }\n\n</style>","<script>\n\n\n    import {onMount, setContext, tick} from 'svelte';\n    import jsx from 'js-extension-ling';\n    import panda from \"panda-headers\";\n    import Validator from \"./modules/Validator\";\n    import GlobalProgressTracker from './modules/GlobalProgressTracker';\n    import Translatee from \"translatee\";\n    import DropZoneHandler from \"js-dropzone-handler\";\n    import ChunkUploader from \"chunk-uploader\";\n    import dragula from \"dragula\";\n    import {fade} from 'svelte/transition';\n    import FileEditor from \"./components/DefaultFileEditor.svelte\";\n\n\n    //----------------------------------------\n    // EXPORT OPTIONS\n    //----------------------------------------\n    export let options = {};\n\n    //----------------------------------------\n    // SCRIPT VARIABLES\n    //----------------------------------------\n    options = jsx.extend(true, {\n        /**\n         * bool=false.\n         * If true, this will add some bootstrap markup, mainly for buttons (things like btn btn-primary).\n         * Note: you will still an external style sheet of yours to customize further, this is just to lay down the\n         * basic html markup which is the first step to the bootstrapization of this widget.\n         *\n         */\n        useBootstrap: false,\n        /**\n         * string=eng.\n         *\n         * The language used in the gui.\n         *\n         * Possible values are:\n         * - eng\n         * - fra\n         *\n         * To add your own, start with a copy/paste and adapt of the **lang/lang-fra.js** file.\n         *\n         *\n         */\n        lang: \"eng\",\n        /**\n         * int=1.\n         * The maximum number of files that this widget will handle.\n         * If the value is -1, then it can handle any number of files.\n         *\n         * If the value is 1, the widget will create an input (html element) that results in a scalar when the form is posted.\n         * If the value is more than 1, the widget creates inputs of that results in an array when the form is posted.\n         *\n         */\n        maxFile: 1,\n        /**\n         * string=dropzone-hover.\n         * The css class added to the dropzone when the user's mouse is over the dropzone of the widget while he's dragging\n         * a file from his OS.\n         */\n        dropzoneOverClass: \"dropzone-hover\",\n        /**\n         * array of strings=[].\n         * An array of the urls to initialize the widget with.\n         * Those urls will be loaded in the widget at startup.\n         *\n         */\n        urls: [],\n        /**\n         * string=the_file.\n         * The name attribute of the input html element(s) generated by this widget.\n         */\n        name: \"the_file\",\n        /**\n         * int=-1.\n         * The maximum file size allowed for uploaded files.\n         * The size format is the one used by the [convertHumanSizeToBytes method](https://github.com/lingtalfi/Bat/blob/master/ConvertTool.md#converthumansizetobytes)\n         * If -1, then any size is allowed.\n         */\n        maxFileSize: -1,\n        /**\n         * int=64.\n         * The maximum length allowed for the filename of the uploaded files.\n         */\n        maxFileNameLength: 64,\n        /**\n         * array|string=null.\n         *\n         * The list of allowed file mime types for uploaded files.\n         * null means every mime type is allowed.\n         */\n        mimeType: null,\n        /**\n         * array|string=null.\n         *\n         * The list of allowed file extensions for uploaded files.\n         * null means every extension is allowed.\n         */\n        allowedFileExtension: null,\n        /**\n         * string=file.\n         * The name of the uploaded file when sent to the server (via post).\n         */\n        uploadItemName: \"file\",\n        /**\n         * callback=the callback below.\n         * When there is a problem with the server's response, this callback is called.\n         * Note, it's called in addition to the default error handling system of this widget (i.e. it doesn't override\n         * the widget's default behaviour).\n         */\n        onServerError: function (errorMessage) {\n            console.log(errorMessage);\n        },\n        /**\n         * callback=the callback below.\n         *\n         *\n         * This callback returns whether the given url is external or internal.\n         *\n         * External means it's not recognized by the server (i.e. the server can't identify a file from that url).\n         * Internal means it's recognized by the server.\n         *\n         * The behaviour of the server when an external urls is given depends on the server.\n         * Some server will reject the request, some others will create a new internal url and return it to the client\n         * so that the file can be handled correctly on the subsequent requests.\n         *\n         * Client side (this script), we have our own problems to solve.\n         * The problem that we have which requires this callback occurs in the following situation:\n         *\n         *\n         * update\n         * ----------\n         *\n         * When the page starts, and an external url is given, the file item is displayed normally,\n         * then when the user edits the file by opening the file editor dialog, when he clicks the update button,\n         * that's where the problem begin, because our script sends the binary file only if the file has been modified\n         * (image cropped, or new file dropped on the file editor dialog).\n         * However if the user just changes the name of the file and click the update button, then our script\n         * by default won't send the binary file, and so the server will be missing this information.\n         *\n         * In order for our script to send the binary file while preserving our optimized system,\n         * we use this callback, which returns whether the given url is external or internal.\n         *\n         *\n         * Note: you could make this work all the time by making this callback return true all the time,\n         * but then the binary file would be sent on every update, that would defeat the purpose of our optimization.\n         *\n         * If you don't use external urls at all, then you don't need to worry about this callback at all.\n         * If your application potentially uses external urls and you want your server to handle them (assuming it can),\n         * then we recommend that you set this callback accordingly.\n         *\n         * By default, we return false, which means that there will be some potential problem if you try to send\n         * an external url. But the intent of this choice is that you become aware of this problem and fix it to benefit\n         * the optimized version of our script.\n         *\n         * If you're lazy and don't care of perfs, return true (not recommended).\n         *\n         *\n         * Also, note that usually, if the server handles external urls, it will return an internal url,\n         * so the isExternalUrl callback is just used the on the first update of an external url.\n         *\n         *\n         *\n         * delete\n         * ----------\n         * Also, the externalUrl is used with the delete action.\n         * Since the server won't be able an external url, when we delete an external url's file, we simply\n         * don't ask the confirmation from the server.\n         *\n         *\n         */\n        isExternalUrl: function (url) {\n            return false;\n        },\n        /**\n         * string=/upload.php\n         * The url of the server.\n         */\n        serverUrl: \"/upload.php\",\n        /**\n         * map={}.\n         * A map of extra parameters to pass (via post) with the server requests.\n         */\n        payload: {},\n        /**\n         * bool=false.\n         * If true, the \"upload files\" button won't show up, and the files are automatically uploaded\n         * as soon as the users adds them (either using the \"add file\" button, or by dropping them into the dropzone).\n         */\n        immediateUpload: false,\n        /**\n         * bool=false.\n         * Whether to communicate with a virtual server like this one: https://github.com/lingtalfi/Light_UserData/blob/master/doc/pages/conception-notes.md\n         * If true, the reset action of the [file manager protocol](https://github.com/lingtalfi/TheBar/blob/master/discussions/file-manager-protocol.md)\n         * will be sent when the widget is first initialized, or when the wrapping form (if any) is reset.\n         *\n         * Also, when the wrapping form is submitted, this widget will trigger the \"commit\" action\n         * on the server.\n         *\n         * Also, when accessing a file by its url, we add the v=1 flag, as recommended by the file manager protocol.\n         *\n         */\n        useVirtualServer: false,\n\n        /**\n         * bool=false.\n         * Whether to show the delete button on uploaded files.\n         */\n        useDelete: false,\n\n\n        /**\n         * bool=false.\n         * Whether to use the keepOriginalUrl system of the [file manager protocol](https://github.com/lingtalfi/TheBar/blob/master/discussions/file-manager-protocol.md).\n         * If true, when the file is uploaded, this widget also sends the keep_original flag to the server.\n         * Also, it displays and handles the behaviour of a show original toggle button, so that the user can revert back to the original image if necessary.\n         * Note: every time the user uploads a new file, the keep_original flag is resent to the server (so that the original image is the last image\n         * uploaded by the user).\n         */\n        useKeepOriginalImage: false,\n\n        /**\n         * bool=false.\n         * Whether to show the open file editor dialog button.\n         */\n        useFileEditor: false,\n        /**\n         * map={}.\n         * The options for the file editor.\n         */\n        fileEditor: {\n\n            //----------------------------------------\n            // file\n            //----------------------------------------\n            /**\n             * bool=false.\n             * Whether the user can update the file extension.\n             */\n            fileExtensionCanBeUpdated: false,\n\n\n            //----------------------------------------\n            // directory\n            //----------------------------------------\n            /**\n             * bool=false.\n             * Whether to show the directory control.\n             */\n            useDirectory: false,\n\n            /**\n             * string=\"\".\n             * The default value of the directory control.\n             */\n            directory: \"\",\n            /**\n             *\n             * bool=true.\n             * Whether the directory can be updated.\n             * It's generally a good idea to let the directory not fixed to a certain value,\n             * as to sync the server with the gui,\n             * as the server might change the directory defined by the user.\n             */\n            directoryCanBeUpdated: true,\n\n            //----------------------------------------\n            // visibility\n            //----------------------------------------\n            /**\n             * bool=false.\n             * Whether to show the visibility checkbox (private/public).\n             */\n            usePrivacy: false,\n\n            //----------------------------------------\n            // tags\n            //----------------------------------------\n            /**\n             * bool=false.\n             * Whether to show the tags control.\n             */\n            useTags: false,\n\n            /**\n             * bool=true.\n             * Whether the user is allowed to create new tags.\n             */\n            allowCustomTags: true,\n            /**\n             * array=[].\n             *\n             * The array of tag names the user can choose from.\n             *\n             * Note: if allowCustomTags is true, the user can create his own tags,\n             * otherwise his choice must be one of the available tags.\n             *\n             */\n            availableTags: [],\n            /**\n             * int=5.\n             * The number of tags the user can select/create.\n             * This cannot be infinite.\n             */\n            nbTagsAllowed: 5,\n\n            /**\n             * bool=false.\n             * Whether to show the image editor (if the file is an image).\n             */\n            useImageEditor: false,\n        },\n\n\n    }, options);\n\n    let uFileCounter = 1;\n    let testPartialSize = 0;\n    let inputName = options.name;\n    let isMultipleInput = false;\n    if (options.maxFile > 1) {\n        inputName += '[]';\n        isMultipleInput = true;\n    }\n\n    let hiddenAddFileBtn;\n    let elDropZone;\n    let elTextItemsContainer;\n    let elImageItemsContainer;\n\n\n    if (false === jsx.arrayKeyExists(options.lang, FileUploader._langs)) {\n        throw new Error(\"Lang not available: \" + options.lang);\n    }\n\n    let dictionary = FileUploader._langs[options.lang];\n\n    let translator = new Translatee();\n    translator.setDefaultLang(options.lang);\n    translator.addDictionary(options.lang, dictionary);\n    let validator = new Validator();\n    validator.setTranslator(translator);\n    validator.init(options);\n    let globalProgressTracker = new GlobalProgressTracker();\n    let chunkUploader = null;\n\n\n    //----------------------------------------\n    // HTML THEME\n    //----------------------------------------\n    let styleBtnAddFile = 'btn-add-file';\n    let styleBtnStartUpload = 'btn-start-upload';\n    let styleBtnViewText = 'btn-view-text';\n    let styleBtnViewImage = 'btn-view-image';\n    if (true === options.useBootstrap) {\n        styleBtnAddFile += ' btn btn-outline-dark btn-sm';\n        styleBtnStartUpload += ' btn btn-outline-dark btn-sm';\n        styleBtnViewText += ' btn btn-info btn-sm';\n        styleBtnViewImage += ' btn btn-info btn-sm';\n    }\n\n\n    //----------------------------------------\n    // STATE\n    //----------------------------------------\n    /**\n     * each uFile:\n     *\n     * - id: string, the file id\n     * - url: string=null, the file url. Note: if a file is dragged or selected via input, it doesn't have url yet.\n     *\n     * - directory: false|string.\n     *      The default value depends on the configuration of this component (see the doc for more info).\n     *      the base directory used for this file. This is used by some protocols.\n     *      false means that the directory is not used at all (the user can't define one).\n     *\n     *\n     * - name: string, the relative file path, from the base directory.\n     *\n     * - status: int=0\n     *      The status of the file. Can be one of:\n     *      - 0: initialized at startup (when the page refreshed), but the meta/blob are not ready (they need to be fetched from the server)\n     *      - 1: same as 0, but the meta/blob are ready\n     *      - 2: added by the user but not uploaded yet (url=null)\n     *      - 3: added by the user and uploaded\n     *\n     *\n     * - file: the js File object. This is not available with status=0.\n     * - is_private: bool=false, whether the file is private or public\n     * - is_user_data: bool=false\n     *      experimental flag...\n     *\n     * - progress: the current percentage of the file loaded (for progress bar live display)\n     * - tags: array of tags associated with this file\n     * - keep_original: 0|1=0.\n     *      A flag to indicate to the server whether to keep this file as an original source (to recall later).\n     *      See more info in the properties description of this widget.\n     *\n     * - is_loading: bool=false.\n     *      If true, a loader shall appear in the file item to indicate that an ajax action is pending in the background.\n     *\n     *\n     */\n    let uFiles = [];\n    let editedUFile = null;\n    let viewMode = 'image';\n    let fileEditorIsOpen = false;\n    let globalPercent = 0;\n    let abortBtnVisible = false;\n    let userErrors = [];\n    let fileEditorErrors = [];\n    let urls = options.urls;\n\n    // global percent text transition vars\n    let aIsVisible = true;\n    let bIsVisible = false;\n\n    $: totalSize = getTotalSize(uFiles);\n    $: nbQueuedFiles = getNbQueuedFiles(uFiles);\n    $: startUploadBtnEnabled = (false === options.immediateUpload && nbQueuedFiles > 0);\n\n\n    //----------------------------------------\n    // LIFE CYCLE\n    //----------------------------------------\n    onMount(async () => {\n\n\n        //----------------------------------------\n        // DROPZONE\n        //----------------------------------------\n        let dropZoneHandler = new DropZoneHandler({\n            container: elDropZone,\n            cssClass: options.dropzoneOverClass,\n            onDrop: (files) => {\n                addUserFiles(files);\n            },\n        });\n        dropZoneHandler.start();\n\n\n        //----------------------------------------\n        // DRAGULA\n        //----------------------------------------\n        let drakeImg = dragula([elImageItemsContainer]);\n        let drakeText = dragula([elTextItemsContainer]);\n        drakeImg.on('drop', () => {\n            let ids = getCurrentOrder(elImageItemsContainer);\n            updateUFileOrder(ids);\n        });\n\n\n        drakeText.on('drop', () => {\n            let ids = getCurrentOrder(elTextItemsContainer);\n            updateUFileOrder(ids);\n        });\n\n\n        //----------------------------------------\n        // VIRTUAL FILE SYSTEM\n        //----------------------------------------\n        if (true === options.useVirtualServer) {\n            await reset();\n\n            let dForm = elDropZone.closest('form');\n            if (null !== dForm) {\n                dForm.addEventListener('reset', async () => {\n                    await reset();\n                });\n            }\n\n\n        } else {\n            resetUrls();\n        }\n\n    });\n\n    //----------------------------------------\n    // CONTEXT\n    //----------------------------------------\n    setContext(\"fileUploader\", {\n        onCloseFileEditorBtnClicked: closeFileEditor,\n        onFileEditorFileDropped: updateUFileBinaryData,\n        onFileEditorUpdated: updateUFileByFileEditor,\n        fileEditorOptions: Object.assign(options.fileEditor, {\n            dropzoneOverClass: options.dropzoneOverClass,\n            useKeepOriginalImage: options.useKeepOriginalImage,\n            useBootstrap: options.useBootstrap,\n        }),\n    });\n\n    //----------------------------------------\n    // FUNCTIONS\n    //----------------------------------------\n    function changeViewMode(mode) {\n        viewMode = mode;\n    }\n\n\n    /**\n     * Returns an uFile from the given js File.\n     *\n     * At its minimum, the uFile has the following properties:\n     * - id\n     * - url\n     * - status\n     * - directory\n     * - name\n     *\n     */\n    function createUFile(oFile, _options) {\n\n        // null means do not display it at all\n        let feo = options.fileEditor;\n        let directory = '';\n\n\n        if ('tags' in options) {\n            while (options.tags.length > feo.nbTagsAllowed) {\n                options.tags.pop();\n            }\n        }\n\n\n        return jsx.extend({\n            id: getNewFileId(),\n            url: null,\n            name: oFile.name,\n            directory: feo.directory,\n            file: oFile,\n            status: 0,\n            size: oFile.size,\n            type: oFile.type,\n            progress: 0,\n            is_private: false,\n            is_user_data: false,\n            tags: [],\n            keep_original: jsx.toInt(options.useKeepOriginalImage),\n            is_loading: false,\n        }, _options);\n    }\n\n    function getNewFileId() {\n        return 'id' + uFileCounter++;\n    }\n\n    function addUFile(uFile) {\n        uFiles = [...uFiles, uFile];\n    }\n\n    function updateUFile(uFile) {\n        for (let i in uFiles) {\n            let curUFile = uFiles[i];\n            if (uFile.id === curUFile.id) {\n                uFiles[i] = uFile;\n                break;\n            }\n        }\n    }\n\n\n    function updateUFileBinaryData(uFile, oFile) {\n\n        let res = validator.test(oFile);\n        if (true === res) {\n            uFile.file = oFile;\n            uFile.size = oFile.size;\n            uFile.type = oFile.type;\n            uFile.name = oFile.name;\n            uFile.status = 2;\n\n            uFile.keep_original = jsx.toInt(options.useKeepOriginalImage);\n\n            // special internal flag\n            uFile.__preserveOriginalUrl = true;\n\n\n            editedUFile = uFile;\n            updateUFile(uFile);\n\n\n            if (true === options.immediateUpload) {\n                setTimeout(async function () {\n                    await uploadQueuedFiles({\n                        action: \"update\",\n                        url: uFile.url,\n                        original_url: uFile.original_url,\n                    });\n\n                    let updatedEditedFile = _getUFileById(editedUFile.id);\n                    editedUFile = updatedEditedFile;\n\n                }, 1);\n            }\n\n        } else {\n            addFileEditorError(res);\n        }\n    }\n\n\n    async function updateUFileByFileEditor(uFile, postedData, flags) {\n\n\n        let {cropped, dropped, original} = flags;\n\n        uFile.is_loading = true;\n        editedUFile = uFile;\n\n        let fileHasChanged = (true === cropped || true === dropped);\n        uFile.keep_original = jsx.toInt((true === dropped && false === original && false === cropped));\n\n        let isExternalUrl = options.isExternalUrl(uFile.url);\n\n\n        uFile = jsx.extend(uFile, postedData);\n\n        let newUFile;\n        if (true === isExternalUrl || true === fileHasChanged) {\n            abortBtnVisible = true;\n            newUFile = await uploadFile(uFile, {\n                action: \"update\",\n                url: uFile.url,\n            }, {\n                singleFile: true,\n            });\n            abortBtnVisible = false;\n            refreshGlobalPercentText();\n        } else {\n\n            var data = jsx.extend({}, options.payload, {\n                action: 'update',\n                url: uFile.url,\n                filename: uFile.name,\n                directory: uFile.directory,\n                tags: uFile.tags,\n                is_private: jsx.toInt(uFile.is_private),\n            });\n\n            let jsonResponse = await callService(data);\n            newUFile = await handleAddUpdateResponse(uFile, jsonResponse);\n\n            /**\n             * Preserving the old data since we didn't send the file (to save cpu work)\n             */\n            newUFile.file = uFile.file;\n            newUFile.original_url = uFile.original_url;\n            newUFile.type = uFile.type;\n            newUFile.size = uFile.size;\n\n        }\n\n\n        if (false !== newUFile) {\n            newUFile.is_loading = false;\n            updateUFile(newUFile);\n        }\n    }\n\n\n    async function removeUFile(id, serverCheck = true) {\n        for (let i in uFiles) {\n            let uFile = uFiles[i];\n            if (id === uFile.id) {\n\n                if (\n                        true === serverCheck &&\n                        false === options.isExternalUrl(uFile.url)\n                ) {\n\n                    uFile.is_loading = true;\n                    uFiles = uFiles;\n\n\n                    let response = await callService({\n                        \"action\": \"delete\",\n                        \"url\": uFile.url,\n                    });\n                    uFile.is_loading = false;\n                    if (true === checkAcpResponse(response)) {\n                        jsx.removeEntryByIndex(uFiles, i);\n                        uFiles = uFiles;\n                        break;\n                    }\n                } else {\n                    jsx.removeEntryByIndex(uFiles, i);\n                    uFiles = uFiles;\n                    break;\n                }\n\n            }\n        }\n    }\n\n\n    /**\n     * Used at startup, to initialize the widget with some default urls.\n     */\n    function loadUrl(url) {\n\n\n        let originalUrl = url;\n        let fileName = url.split(\"/\").pop();\n        let fileId = getNewFileId();\n        let uFile = {\n            id: fileId,\n            status: 0,\n            url: url,\n            name: fileName,\n        };\n        addUFile(uFile);\n\n        if (true === options.useFileEditor) {\n            url = jsx.url_merge_params(url, {\n                \"m\": 1\n            });\n        }\n\n\n        fetch(url).then(response => {\n            if (response.ok) {\n                response.blob().then(blob => {\n\n                    /**\n                     * create the uFile\n                     */\n                    let file = blobToFile(blob, fileName);\n\n\n                    let moreHeaders = {};\n                    if (true === options.useFileEditor) {\n                        moreHeaders = panda.getPandaHeaders(response.headers);\n                    }\n\n                    let updatedUFile = createUFile(file, jsx.extend(moreHeaders, {\n                        status: 1,\n                        url: originalUrl,\n                        id: uFile.id\n                    }));\n                    updateUFile(updatedUFile);\n                });\n\n            } else {\n                addServerError(`An error occurred with the request for url ${url}`);\n            }\n        });\n\n    }\n\n    function blobToFile(blob, name) {\n        // https://stackoverflow.com/questions/27159179/how-to-convert-blob-to-file-in-javascript\n        blob.lastModifiedDate = new Date();\n        blob.name = name;\n        return blob;\n    }\n\n\n    function getTotalSize(_uFiles) {\n        let total = 0;\n        _uFiles.forEach(uFile => {\n            if (uFile.size) {\n                total += uFile.size;\n            }\n        })\n        return total;\n    }\n\n\n    function getNbQueuedFiles(_uFiles) {\n        let total = 0;\n        _uFiles.forEach(uFile => {\n            if (2 === uFile.status) {\n                total++;\n            }\n        })\n        return total;\n    }\n\n\n    async function addUserFiles(files) {\n        hiddenAddFileBtn.disabled = true;\n\n\n        var numFiles = files.length;\n        for (let i = 0; i < numFiles; i++) {\n\n            let oFile = files[i];\n\n\n            let res = validator.test(oFile);\n            if (true === res) {\n                let uFile = createUFile(oFile, {\n                    status: 2,\n                });\n                addUFile(uFile);\n                await applyFileRotation();\n            } else {\n                addUserError(res);\n            }\n        }\n\n        if (true === options.immediateUpload) {\n            setTimeout(function () {\n                uploadQueuedFiles();\n            }, 1);\n        }\n\n\n    }\n\n    async function applyFileRotation() {\n        if (-1 !== options.maxFile && uFiles.length > options.maxFile) {\n            let nbFilesToRemove = uFiles.length - options.maxFile;\n            while (nbFilesToRemove > 0) {\n                nbFilesToRemove--;\n                let uFile = uFiles[0];\n                await removeUFile(uFile.id);\n            }\n        }\n\n    }\n\n    function onAddFileButtonClicked() {\n        hiddenAddFileBtn.disabled = false;\n        hiddenAddFileBtn.click();\n    }\n\n\n    function addUserError(err) {\n        if (true === fileEditorIsOpen) {\n            addFileEditorError(err);\n        } else {\n            userErrors = [...userErrors, err];\n        }\n    }\n\n    function addFileEditorError(err) {\n        fileEditorErrors = [...fileEditorErrors, err];\n    }\n\n    function removeErrorItem(e) {\n        let el = e.target.closest(\".error-item\");\n        if (null !== el) {\n            el.remove();\n        }\n    }\n\n\n    function getCurrentOrder(container, key = 'id') {\n        let ret = [];\n        let children = container.children;\n        for (let child of children) {\n            let attrName = \"data-\" + key;\n\n            let id = child.getAttribute(attrName);\n            if (id) {\n                ret.push(id);\n            } else {\n                throw new Error(\"No element found with attribute \" + attrName + \". This is a setup error, please fix it now.\");\n            }\n        }\n\n        return ret;\n    }\n\n    function updateUFileOrder(ids) {\n        let newUFiles = [];\n        let tmpUFiles = {};\n        uFiles.forEach(uFile => {\n            tmpUFiles[uFile.id] = uFile;\n        });\n        ids.forEach(id => {\n            newUFiles.push(tmpUFiles[id]);\n        });\n        uFiles = newUFiles;\n    }\n\n    /**\n     * Returns the [acp](https://github.com/lingtalfi/AjaxCommunicationProtocol) json response from the server.\n     *\n     */\n    async function callService(payload, returnOriginalResponse = false) {\n\n        payload = jsx.extend({}, options.payload, payload);\n\n        var response = await jsx.post(options.serverUrl, payload).catch(reason => {\n            var errMsg = \"An error occurred with the request: \" + reason;\n            addServerError(errMsg);\n        });\n        if (true === response.ok) {\n            if (true === returnOriginalResponse) {\n                return response;\n            }\n            return await response.json().catch((e) => {\n                addUserError(e.toString());\n            });\n        } else {\n            addServerError(\"The server status code was \" + response.status);\n        }\n    }\n\n    async function reset() {\n\n\n        var response = await callService({\n            \"action\": \"reset\",\n        });\n\n        if (true === checkAcpResponse(response)) {\n            resetUrls();\n            return true;\n        }\n        return false;\n    }\n\n\n    function checkAcpResponse(response) {\n        if (true === isSuccessfulResponse(response)) {\n            return true;\n        } else {\n            addServerError(response.error);\n            return false;\n        }\n    }\n\n    function isSuccessfulResponse(jsonResponse) {\n        if (jsx.isPlainObject(jsonResponse) && \"type\" in jsonResponse) {\n            if ('success' === jsonResponse.type) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n\n    function addServerError(err) {\n        addUserError(err);\n    }\n\n    function abort() {\n        if (null !== chunkUploader) {\n            chunkUploader.abort();\n            refreshGlobalPercentText();\n        }\n    }\n\n    function resetUrls() {\n        uFiles = [];\n        let x = options.maxFile;\n        urls.forEach(url => {\n            if (x > 0) {\n                loadUrl(url);\n                x--;\n            }\n        });\n    }\n\n    async function uploadQueuedFiles(params = {}) {\n\n        if (nbQueuedFiles > 0) {\n\n            abortBtnVisible = true;\n\n            globalProgressTracker.registerItems(uFiles);\n\n            for (let [i, uFile] of uFiles.entries()) {\n\n                let fileId = uFile.id;\n                if (2 === uFile.status) {\n\n\n                    uFile.is_loading = true;\n                    uFiles = uFiles;\n\n                    /**\n                     * Note that the process will not go beyond this line if the user\n                     * aborts the chunk upload.\n                     */\n                    let newUFile = await uploadFile(uFile, params);\n\n\n                    if (false !== newUFile) {\n\n                        newUFile.is_loading = false;\n                        // update the file\n                        uFiles[i] = newUFile;\n\n                    } else {\n                        removeUFile(fileId, false);\n                    }\n                }\n            }\n\n            abortBtnVisible = false;\n            refreshGlobalPercentText();\n\n\n        }\n\n    }\n\n\n    /**\n     * Returns a promise that resolves to either:\n     *\n     * - uFile: the uFile corresponding to the successfully uploaded file, based on the given uFile\n     * - false (bool): in case of error\n     *\n     */\n    async function uploadFile(uFile, params = {}, _options = {}) {\n\n        let useChunks = true;\n        let jsonResponse = null;\n\n        let singleFile = _options['singleFile'] || false;\n\n\n        var data = jsx.extend({}, options.payload, {\n            action: 'add',\n            filename: uFile.name,\n            directory: uFile.directory,\n            tags: uFile.tags,\n            is_private: jsx.toInt(uFile.is_private),\n            keep_original: jsx.toInt(uFile.keep_original),\n        }, params);\n\n\n        // make sure you don't keep original for non images.\n        if (false === jsx.mimeIsImage(uFile.type)) {\n            data.keep_original = 0;\n        }\n\n\n        //----------------------------------------\n        // USING CHUNKS (always a better idea)\n        //----------------------------------------\n        if (true === useChunks) {\n            data.useChunks = 1;\n\n            chunkUploader = new ChunkUploader({\n                serverUrl: options.serverUrl,\n                // chunkSize: 5 * 1024 * 1024,\n                onChunkAborted: (start, end, isLastChunk) => {\n                    abortUpload(uFile);\n                },\n                onChunkLoaded: (start, end, size, isLastChunk) => {\n                    let percent = Math.round(end / size * 100, 2);\n                    let id = uFile.id;\n                    if (false === singleFile) {\n                        globalProgressTracker.addProgress(id, percent);\n                        globalPercent = globalProgressTracker.getPercent().toFixed(2);\n                    } else {\n                        globalPercent = percent;\n                    }\n                    updateUFileProgress(id, percent);\n                },\n                onChunkResponseReceived: async function (response) {\n                    try {\n                        jsonResponse = await response.json();\n                        if (true === isSuccessfulResponse(jsonResponse)) {\n                            return true;\n                        } else {\n                            return jsonResponse.error;\n                        }\n                    } catch (e) {\n                        return e.toString();\n                    }\n                }\n            });\n\n            try {\n\n                let response = await chunkUploader.sendByChunks(uFile.file, data, {\n                    start: testPartialSize,\n                });\n                jsonResponse = await response.json();\n\n            } catch (e) {\n                jsonResponse = {\n                    type: \"error\",\n                    error: e,\n                };\n            }\n        } else {\n            //----------------------------------------\n            // USING REGULAR UPLOAD\n            //----------------------------------------\n            data[options.uploadItemName] = uFile.file;\n            let ajax = await jsx.uploadFileProgress(options.serverUrl, data, (e, percent, loaded, total) => {\n\n                let id = uFile.id;\n                globalProgressTracker.addProgress(id, percent);\n                globalPercent = globalProgressTracker.getPercent().toFixed(2);\n                updateUFileProgress(id, percent);\n\n            });\n\n\n            jsonResponse = JSON.parse(ajax.response);\n        }\n\n        return await handleAddUpdateResponse(uFile, jsonResponse);\n\n    }\n\n    async function handleAddUpdateResponse(uFile, jsonResponse) {\n        if (true === checkAcpResponse(jsonResponse)) {\n\n            // eliminate conflict of ajaxCommunicationProtocol.type (success|error) and our uFile.type (mime type)\n            delete jsonResponse.type;\n\n\n            if (true === uFile.__preserveOriginalUrl) {\n                /**\n                 * Needed this in the case of an update, using the virtual server, which didn't know the original url\n                 * and returned original_url=null, but we want to keep the old original url (since the vfs doesn't\n                 * know anything about whether the real original url exists or not).\n                 */\n                let originalUrl = uFile.original_url;\n                uFile = jsx.extend(uFile, jsonResponse);\n                uFile.original_url = originalUrl;\n                delete uFile.__preserveOriginalUrl;\n            } else {\n                uFile = jsx.extend(uFile, jsonResponse);\n            }\n\n\n            if (true === jsx.mimeIsImage(uFile.type)) {\n                /**\n                 * We download the blob so that we can update the image (if ever the server changed it).\n                 * Note that the server might not alter any other type of files, just images.\n                 */\n                let fileUrl = uFile.url;\n                if (true === options.useVirtualServer) {\n                    fileUrl += '&v=1';\n                }\n\n                let blob = await jsx.fetchBlob(fileUrl);\n                uFile.file = blob;\n                uFile.size = blob.size;\n                uFile.type = blob.type;\n            }\n\n\n            /**\n             * Note: the server's response will at least contain the url.\n             * In the case of the fileManager protocol, it might have other properties as well, such\n             * as:\n             * - name (will override current uFile name)\n             * - directory\n             *\n             */\n            uFile.status = 3;\n\n            if (null !== uFile.original_url) {\n\n                if (true === options.useVirtualServer) {\n                    uFile.original_url = jsx.url_merge_params(uFile.original_url, {v: 1});\n                }\n                uFile.keep_original = 0;\n            }\n\n\n            return uFile;\n        }\n        return false;\n    }\n\n\n    function updateUFileProgress(id, percent) {\n\n        let bk = 2;\n\n        for (let i in uFiles) {\n            let uFile = uFiles[i];\n            if (id === uFile.id) {\n                uFile.progress = percent;\n                uFiles = uFiles;\n                bk--;\n                if (0 === bk) {\n                    break;\n                }\n            }\n\n            if (null !== editedUFile && id === editedUFile.id) {\n                editedUFile.progress = percent; // redundant? but seems to be required\n                editedUFile = editedUFile;\n                bk--;\n                if (0 === bk) {\n                    break;\n                }\n            }\n\n        }\n    }\n\n    function abortUpload(uFile) {\n        removeUFile(uFile.id)\n    }\n\n    function openFileEditor(id) {\n        let uFile = _getUFileById(id);\n        editedUFile = uFile;\n        fileEditorIsOpen = true;\n    }\n\n    function closeFileEditor() {\n        fileEditorIsOpen = false;\n    }\n\n\n    function refreshGlobalPercentText() {\n        setTimeout(() => {\n            if (true === aIsVisible) {\n                aIsVisible = false;\n                setTimeout(() => {\n                    globalPercent = 0;\n                    abortBtnVisible = false;\n                    bIsVisible = true;\n                }, 500);\n            } else {\n                bIsVisible = false;\n                setTimeout(() => {\n                    globalPercent = 0;\n                    abortBtnVisible = false;\n                    aIsVisible = true;\n                }, 500);\n            }\n        }, 2000);\n    }\n\n    //----------------------------------------\n    //\n    //----------------------------------------\n    function _getUFileById(id) {\n        for (let uFile of uFiles) {\n            if (id === uFile.id) {\n                return uFile;\n            }\n        }\n        throw new Error(\"uFile not found with id: \" + id);\n    }\n\n    // function testLoader(id) {\n    //     for (let i in uFiles) {\n    //         let uFile = uFiles[i];\n    //         if (id === uFile.id) {\n    //             uFile.is_loading = true;\n    //             uFiles = uFiles;\n    //             break;\n    //         }\n    //     }\n    // }\n\n\n</script>\n\n\n<div class=\"fileuploader-container\">\n    <div class=\"hidden-inputs\" style=\"display: none\">\n        {#each uFiles as uFile (uFile.id)}\n            <input type=\"text\" readOnly name={inputName} value={uFile.url}/>\n        {/each}\n    </div>\n    <div class=\"error-container\">\n        <div class=\"error-container-item\">\n            {#each userErrors as userError}\n                <div class=\"error-item\">\n                    <span>{@html userError}</span>\n                    <button on:click|preventDefault={removeErrorItem} class=\"btn-remove-error\"><i\n                            class=\"fas fa-times-circle btn-remove-error\"></i></button>\n                </div>\n            {/each}\n        </div>\n    </div>\n    <div class=\"header\">\n        <div class=\"left\">{translator._(\"Select files\")}</div>\n        <div class=\"right\">\n            <button on:click|preventDefault={() => changeViewMode(\"text\")}\n                    class={styleBtnViewText}\n\n            ><i\n                    class=\"fas fa-list-ul btn-view-text\"></i></button>\n            <button on:click|preventDefault={() => changeViewMode(\"image\")} class={styleBtnViewImage}><i\n                    class=\"far fa-image btn-view-image\"></i></button>\n        </div>\n    </div>\n    <div class=\"dropzone\" bind:this={elDropZone}>\n        <div class=\"dropzone-text\" class:visible={\"text\"===viewMode}>\n            <div class=\"dropzone-text-header\">\n                <div class=\"cell-name\">{translator._(\"Filename\")}</div>\n                <div class=\"cell-status\">{translator._(\"Status\")}</div>\n                <div class=\"cell-size\">{translator._(\"Size\")}</div>\n                <div class=\"cell-action\"></div>\n            </div>\n            <div class=\"dropzone-text-container\">\n                <div class=\"dropzone-droptext\">{translator._(\"Drag files here.\")}</div>\n                <ul class=\"fileuploader-item-container\" bind:this={elTextItemsContainer}>\n                    {#each uFiles as uFile (uFile.id)}\n\n                        {#if 0 === uFile.status}\n                            <li class=\"dropzone-text-item-container fileuploader-item ui-placeholder\"\n                                data-id=\"{uFile.id}\">\n                                <div class=\"cell-name\">{uFile.name}</div>\n                                <div class=\"cell-status\">{translator._(\"Loading...\")}</div>\n                                <div class=\"cell-size\">&nbsp</div>\n                                <div class=\"cell-action gu-hide\">&nbsp;</div>\n                            </li>\n                        {:else}\n                            <li class=\"dropzone-text-item-container fileuploader-item\" data-id=\"{uFile.id}\">\n                                <div class=\"cell-name\">\n                                    {uFile.name}\n                                    {#if true=== uFile.is_loading}\n                                        <i class=\"fas fa-circle-notch fa-spin\"></i>\n                                    {/if}\n                                </div>\n                                <div class=\"cell-status\">\n                                    {#if uFile.status < 2}\n                                        -\n                                    {:else}\n                                        {uFile.progress}%\n                                    {/if}\n\n                                </div>\n                                <div class=\"cell-size\">{jsx.humanSize(uFile.size)}</div>\n                                <div class=\"cell-action gu-hide\">\n                                    {#if true === options.useFileEditor}\n                                        <button on:click|preventDefault={() => openFileEditor(uFile.id)}\n                                                class=\"btn-edit-file\"><i\n                                                class=\"btn-edit-file fas fa-edit\"></i></button>\n                                    {/if}\n                                    {#if true === options.useDelete}\n                                        <button on:click|preventDefault={() => removeUFile(uFile.id)}\n                                                class=\"btn-remove-file\"><i\n                                                class=\"fas fa-minus-circle btn-remove-file\"></i>\n                                        </button>\n                                    {/if}\n                                </div>\n                            </li>\n                        {/if}\n                    {/each}\n                </ul>\n            </div>\n        </div>\n        <div class=\"dropzone-image\" class:visible={\"image\"===viewMode}>\n            <div class=\"dropzone-droptext\">{translator._(\"Drag files here.\")}</div>\n            <div class=\"filelist fileuploader-item-container\" bind:this={elImageItemsContainer}>\n                {#each uFiles as uFile (uFile.id)}\n\n                    {#if 0 === uFile.status}\n                        <div class=\"dropzone-image-item-container fileuploader-item\"\n                             data-id={uFile.id}>\n                            <div class=\"cell-content\">\n                                <div class=\"cell-image\">\n                                    <span class=\"cell-image-img\">\n<!--                                        <i class=\"fas fa-circle-notch fa-spin loading-image\"></i>-->\n                                    </span>\n                                </div>\n                                <div class=\"cell-name\">{uFile.name}</div>\n                                <div class=\"cell-size\"></div>\n                            </div>\n                            <div class=\"image-overlay\">\n                                <i class=\"fas fa-circle-notch fa-spin fa-2x\"></i>\n                            </div>\n                        </div>\n                    {:else}\n                        <div class=\"dropzone-image-item-container fileuploader-item\" data-id={uFile.id}>\n                            <div class=\"cell-content\">\n                                <div class=\"cell-image\">\n                                    {#if true === jsx.mimeIsImage(uFile.type)}\n                                        <img class=\"cell-image-img\" src={URL.createObjectURL(uFile.file)}\n                                             alt={uFile.name}/>\n                                    {:else}\n                                        <span class=\"cell-image-img\"><i class=\"far fa-file\"></i></span>\n                                    {/if}\n                                </div>\n                                <div class=\"cell-name\">{uFile.name}</div>\n                                <div class=\"cell-size\">{jsx.humanSize(uFile.size)}</div>\n                            </div>\n                            <div class=\"cell-action gu-hide\">\n                                {#if true === options.useFileEditor}\n                                    <button on:click|preventDefault={() => openFileEditor(uFile.id)}\n                                            class=\"btn-edit-file\"><i\n                                            class=\"btn-edit-file fas fa-edit\"></i></button>\n                                {/if}\n                                {#if true === options.useDelete}\n                                    <button on:click|preventDefault={() => removeUFile(uFile.id)}\n                                            class=\"btn-remove-file\"><i\n                                            class=\"fas fa-minus-circle btn-remove-file\"></i>\n                                    </button>\n                                {/if}\n                            </div>\n                            {#if true=== uFile.is_loading}\n                                <div class=\"image-overlay\">\n                                    <i class=\"fas fa-circle-notch fa-spin fa-2x\"></i>\n                                </div>\n                            {/if}\n                        </div>\n                    {/if}\n                {/each}\n\n            </div>\n        </div>\n    </div>\n    <div class=\"footer\">\n        <div class=\"left\">\n            <button on:click|preventDefault={onAddFileButtonClicked}\n                    class={styleBtnAddFile}\n            ><i\n                    class=\"btn-add-file fas fa-plus-circle\"></i> <span\n                    class=\"btn-add-file\">{\n            0 === nbQueuedFiles?\n            translator._(\"Add files\"):\n            translator._n(\"x files queued\", nbQueuedFiles)\n            }\n\n                </span>\n            </button>\n            {#if false === options.immediateUpload}\n                <button on:click|preventDefault={uploadQueuedFiles}\n                        class={styleBtnStartUpload}\n                        disabled={!startUploadBtnEnabled}><i\n                        class=\"btn-start-upload fas fa-arrow-circle-right\"></i> <span\n                        class=\"btn-start-upload\">{translator._(\"Start upload\")}</span></button>\n            {/if}\n        </div>\n        <div class=\"right\">\n            <span class=\"footer-info\"><span class=\"text-file\">{translator._n(\"x files\", uFiles.length)}</span></span>\n            <span class=\"footer-info global-percent-upload\">\n                {#if true === aIsVisible}\n                    <span transition:fade>{globalPercent}%</span>\n                {/if}\n                {#if true === bIsVisible}\n                    <span transition:fade>{globalPercent}%</span>\n                {/if}\n            </span>\n            <button on:click|preventDefault={abort} class=\"btn-abort-upload\"\n                    style=\"display: {abortBtnVisible?'inline-block':'none'}\">\n                <i\n                        class=\"fas fa-ban btn-abort-upload\"></i> {translator._(\"Abort\")}\n            </button>\n            <span class=\"footer-info global-size\">\n                {jsx.humanSize(totalSize)}\n            </span>\n        </div>\n    </div>\n    <div class=\"hidden\" style=\"display: none\">\n        <input bind:this={hiddenAddFileBtn} on:change={(e) => addUserFiles(e.target.files)}\n               class=\"input-file\"\n               disabled\n               type=\"file\" name={inputName}\n                multiple={isMultipleInput}\n                />\n    </div>\n\n\n</div>\n\n\n<FileEditor isOpen={fileEditorIsOpen} uFile={editedUFile} errors={fileEditorErrors}></FileEditor>\n\n\n<style type=\"text/sass\" lang=\"scss\">\n\n    $padding: 10px;\n    $bgColor: #eee;\n    $dropzoneTextHeaderHeight: 20px;\n    $errorColor: #cd0a0a;\n    $imgWidthHeight: 80px;\n\n\n    .fileuploader-container {\n\n\n        .hidden-inputs {\n\n            input { // ease debugging\n                display: block;\n                width: 100%;\n            }\n        }\n\n        position: relative;\n        border: 1px solid #999;\n\n        button {\n\n            cursor: pointer;\n\n            &.btn-start-upload:disabled {\n                cursor: not-allowed;\n            }\n\n        }\n\n\n        .error-container {\n            color: #cd0a0a;\n\n            position: absolute;\n            top: 0;\n            left: 0;\n            right: 0;\n            z-index: 1;\n\n            .error-container-item {\n\n                position: relative;\n                height: 100%;\n\n\n                .error-item {\n\n                    position: absolute;\n                    top: 0;\n                    left: 0;\n                    right: 0;\n                    border: 1px solid $errorColor;\n                    background: rgb(255, 232, 232);\n                    padding: 10px;\n                    background: linear-gradient(0deg, rgba(255, 232, 232, 1) 46%, rgba(255, 239, 239, 1) 56%, rgba(255, 239, 239, 1) 63%);\n\n\n                    button.btn-remove-error {\n\n                        position: absolute;\n                        top: 4px;\n                        right: 0px;\n\n                        background: transparent;\n\n                        border: none;\n                        color: $errorColor;\n\n                        cursor: pointer;\n\n                    }\n\n                }\n\n            }\n\n        }\n\n        .header {\n            background: $bgColor;\n\n            display: flex;\n            padding: $padding;\n\n            .right {\n\n                margin-left: auto;\n\n            }\n\n        }\n\n        @keyframes placeholderShimmer {\n            0% {\n                background-position: -1200px 0\n            }\n            100% {\n                background-position: 1200px 0\n            }\n        }\n\n\n        .ui-placeholder {\n            position: static;\n            overflow: hidden;\n            animation: placeholderShimmer 2s linear;\n            animation-iteration-count: infinite;\n            background-color: #fff;\n            background-image: linear-gradient(to right, rgba(0, 0, 0, 0.03) 0, rgba(0, 0, 0, 0.1) 50%, rgba(0, 0, 0, 0.03) 60%) !important;\n\n            background-size: 1200px 100% !important;;\n\n        }\n\n\n        .dropzone {\n\n            background: white;\n            min-height: 150px;\n\n            position: relative;\n\n            &.dropzone-hover {\n                background: #fafafa;\n\n            }\n\n\n            .dropzone-text, .dropzone-image {\n\n                display: none;\n\n                &.visible {\n\n                    display: block;\n\n                }\n\n            }\n\n            .dropzone-text {\n\n                .dropzone-text-header {\n\n                    display: flex;\n                    padding: 10px;\n\n\n                    background: rgb(209, 209, 209);\n                    background: linear-gradient(0deg, rgba(209, 209, 209, 1) 0%, rgba(227, 227, 227, 1) 100%);\n\n                }\n\n                .dropzone-text-item-container {\n\n                    display: flex;\n                    padding: 6px;\n                    margin: 0;\n\n                    position: relative;\n                    z-index: 1;\n\n                    background: rgb(228, 228, 228);\n                    background: linear-gradient(0deg, rgba(228, 228, 228, 1) 46%, rgba(238, 238, 238, 1) 56%);\n\n                }\n\n\n                .cell-status {\n\n                    margin-left: auto;\n                    width: 80px;\n\n                }\n\n                .cell-size {\n                    width: 70px;\n\n                    white-space: nowrap;\n\n                    overflow: hidden;\n\n                    text-overflow: ellipsis;\n\n                }\n\n                .cell-action {\n                    width: 30px;\n                }\n\n\n                .dropzone-text-container {\n\n                    position: absolute;\n                    top: 39px;\n                    left: 0;\n                    right: 0;\n                    bottom: 0;\n\n                    overflow-y: auto;\n\n                    font: normal 11px Verdana, sans-serif;\n\n                    ul {\n                        margin: 0;\n                        padding: 0;\n\n\n                        .cell-name {\n                            padding-left: 10px;\n\n                        }\n\n                        button.btn-remove-file, button.btn-edit-file {\n\n                            border: none;\n                            margin: 0;\n                            padding: 0;\n\n                            cursor: pointer;\n                            color: #919191;\n\n                        }\n\n                    }\n\n                }\n\n            }\n\n            .dropzone-image {\n\n                .filelist {\n\n                    display: flex;\n\n                    flex-wrap: wrap;\n\n                    position: absolute;\n                    top: 0px;\n                    left: 0;\n                    right: 0;\n                    bottom: 0;\n\n                    overflow-y: auto;\n\n\n                    .dropzone-image-item-container {\n\n                        position: relative;\n                        padding: 5px;\n                        background: #f0f0f0;\n                        margin: 5px;\n                        max-width: 80px;\n                        max-height: 120px;\n\n                        overflow: hidden;\n\n\n                        .cell-content {\n\n                            .cell-image {\n\n                                height: 80px;\n                                text-align: center;\n                                display: flex;\n                                justify-content: center;\n                                align-items: center;\n\n                                img {\n                                    max-height: 80px;\n                                    max-width: 80px;\n\n                                }\n\n                                i {\n                                    color: #c2c2c2;\n                                    font-size: 80px;\n\n                                    &.loading-image {\n                                        font-size: 50px;\n                                    }\n                                }\n\n                            }\n\n\n                            .cell-name {\n\n                                font: bold 11px Verdana, sans-serif;\n\n                            }\n\n                            .cell-size {\n\n                                font: normal 9px Verdana, sans-serif;\n\n                            }\n\n\n                            .cell-status {\n                                margin-top: 5px;\n                                font-size: 0.8em;\n                                text-align: center;\n\n                            }\n                        }\n\n\n                        .cell-action {\n\n                            position: absolute;\n                            top: 1px;\n                            right: 1px;\n\n                            button.btn-remove-file, button.btn-edit-file {\n\n                                border: none;\n                                margin: 0;\n                                padding: 0;\n\n                                cursor: pointer;\n                                color: #919191;\n\n                                background: transparent;\n\n                            }\n                        }\n\n\n                        .image-overlay {\n                            position: absolute;\n                            top: 0;\n                            left: 0;\n                            right: 0;\n                            bottom: 0;\n                            background: rgba(0, 0, 0, 0.2);\n                            display: flex;\n                            justify-content: center;\n                            align-items: center;\n\n                            i {\n                                color: white;\n                            }\n                        }\n\n                    }\n\n                }\n\n            }\n\n            .dropzone-droptext {\n\n                position: absolute;\n                top: 0;\n                left: 0;\n                right: 0;\n                bottom: 0;\n\n                background: transparent;\n\n                text-align: center;\n\n                display: flex;\n\n                justify-content: center;\n\n                align-items: center;\n\n                font: normal 11px Verdana, sans-serif;\n\n            }\n\n        }\n\n\n        .footer {\n            background: $bgColor;\n\n            display: flex;\n            padding: $padding;\n\n            .right {\n\n                margin-left: auto;\n\n                font: bold 11px Verdana, sans-serif;\n                color: #222;\n\n                .footer-info:not(:last-child) {\n                    border-right: 1px solid #aaa;\n                    padding-right: 7px;\n                    margin-right: 7px;\n\n                }\n\n            }\n\n        }\n\n    }\n\n\n    /*------------------------------------\n    - DRAGULA\n    ------------------------------------*/\n    :global(.gu-mirror) {\n        position: fixed !important;\n        margin: 0 !important;\n        z-index: 9999 !important;\n        opacity: 0.8;\n        -ms-filter: \"progid:DXImageTransform.Microsoft.Alpha(Opacity=80)\";\n        filter: alpha(opacity=80);\n\n        img {\n            width: $imgWidthHeight;\n            height: $imgWidthHeight;\n        }\n    }\n\n\n    :global(.gu-unselectable) {\n        -webkit-user-select: none !important;\n        -moz-user-select: none !important;\n        -ms-user-select: none !important;\n        user-select: none !important;\n\n        .gu-hide {\n            display: none !important;\n        }\n    }\n\n\n    :global(.gu-transit) {\n        opacity: 0.2;\n        -ms-filter: \"progid:DXImageTransform.Microsoft.Alpha(Opacity=20)\";\n        filter: alpha(opacity=20);\n    }\n\n</style>","import SomeComponent from './DefaultFileUploader.svelte';\n\n\nwindow.FileUploader = function (options) {\n    return new SomeComponent(options);\n};\n\n//----------------------------------------\n// LANG HOOK\n//----------------------------------------\nFileUploader._langs = {};\nFileUploader.hasLang = function (lang) {\n    return (lang in FileUploader._langs);\n};\nFileUploader.addLang = function (lang, dict) {\n    FileUploader._langs[lang] = dict;\n};"],"names":["noop","identity","x","run","fn","blank_object","Object","create","run_all","fns","forEach","is_function","thing","safe_not_equal","a","b","component_subscribe","component","store","callback","$$","on_destroy","push","callbacks","unsub","subscribe","unsubscribe","get_slot_context","definition","ctx","$$scope","tar","src","k","assign","slice","null_to_empty","value","is_client","window","now","performance","Date","raf","cb","requestAnimationFrame","tasks","Set","run_tasks","task","c","delete","f","size","append","target","node","appendChild","insert","anchor","insertBefore","detach","parentNode","removeChild","destroy_each","iterations","detaching","i","length","d","element","name","document","createElement","text","data","createTextNode","space","empty","listen","event","handler","options","addEventListener","removeEventListener","prevent_default","preventDefault","call","this","attr","attribute","removeAttribute","getAttribute","setAttribute","set_data","set_style","key","important","style","setProperty","toggle_class","toggle","classList","custom_event","type","detail","e","createEvent","initCustomEvent","active_docs","current_component","active","create_rule","duration","delay","ease","uid","step","keyframes","p","t","rule","str","hash","charCodeAt","doc","ownerDocument","add","stylesheet","__svelte_stylesheet","head","sheet","current_rules","__svelte_rules","insertRule","cssRules","animation","delete_rule","previous","split","next","filter","anim","indexOf","deleted","join","deleteRule","clear","set_current_component","get_current_component","Error","dirty_components","binding_callbacks","render_callbacks","flush_callbacks","resolved_promise","Promise","resolve","update_scheduled","add_render_callback","flushing","seen_callbacks","flush","update","pop","has","fragment","before_update","dirty","after_update","promise","dispatch","direction","kind","dispatchEvent","outroing","outros","group_outros","r","check_outros","transition_in","block","local","transition_out","o","null_transition","create_bidirectional_transition","params","intro","config","running_program","pending_program","animation_name","clear_animation","init","program","Math","abs","start","end","group","go","easing","tick","css","fulfill","loop","[object Object]","then","destroy_block","lookup","update_keyed_each","old_blocks","get_key","dynamic","list","destroy","create_each_block","get_context","n","old_indexes","new_blocks","new_lookup","Map","deltas","child_ctx","get","set","will_move","did_move","m","first","new_block","old_block","new_key","old_key","create_component","mount_component","on_mount","new_on_destroy","map","destroy_component","make_dirty","fill","instance","create_fragment","not_equal","props","parent_component","prop_values","bound","context","ready","ret","rest","hydrate","nodes","Array","from","childNodes","children","l","SvelteComponent","$destroy","index","splice","arrayKeyExists","object","b64toBlob","b64Data","contentType","sliceSize","byteCharacters","atob","byteArrays","offset","byteNumbers","byteArray","Uint8Array","Blob","basename","path","returnExtension","str_contains","compareBlobs","async","blob1","blob2","useTrick","buffer","arrayBuffer","buffer2","_compareBuffers","compareObjects","y","constructor","Function","RegExp","valueOf","isArray","keys","every","convertHumanSizeToBytes","cssId","prefix","getRandomNumber","dirname","replace","charAt","substr","escapeHtml","&","<",">","\"","'","extend","extended","deep","arguments","prototype","toString","merge","obj","prop","hasOwnProperty","fetchBlob","url","fetchInit","response","fetch","ok","status","statusText","blob","fetchJson","json","getFileExtension","min","max","floor","random","humanSize","bytes","decimals","log","parseFloat","pow","toFixed","inArray","needle","haystack","isEmptyObject","isPlainObject","isFunction","mimeIsImage","mime","match","objectToQueryString","encodeParams","_serialize","payload","body","FormData","console","error","post","files","url_merge_params","toFormData","method","queryStringToObject","queryString","q","_parse_str","reindex","array","item","undefined","removeEntryByIndex","startsWith","substring","toBool","fd","h","pk","v","File","toInt","res","parseInt","isNaN","uploadFileProgress","onProgress","decorator","reject","formdata","ajax","XMLHttpRequest","upload","percent","round","loaded","total","stopPropagation","open","onreadystatechange","readyState","send","qs","baseUrl","shift","urlParams","allParams","useEncoder","encodeURIComponent","_testTypes","buf1","buf2","byteLength","d1","DataView","d2","getUint8","j","ct","lastObj","chr","tmp","postLeftBracketPos","keysLen","strArr","String","sal","_fixStr","decodeURIComponent","$global","global","$locutus","php","escapeCommaAndTrim","trim","_getPandaHeaders","headers","arrays","jsx","values","val","getPandaHeaders","getPandaHeadersByXMLHttpRequest","request","arr","getAllResponseHeaders","headerMap","line","parts","header","entries","Validator","events","rules","translatee","translator","oFile","errMsg","maxFileSize","bytesMaxFileSize","addRule","tags","fileName","maxSize","fileSize","_","maxFileNameLength","maxLength","mimeType","allowedMimeTypes","fileMimeType","allowedFileExtension","allowedFileExtensions","extension","fileExtension","GlobalProgressTracker","nbItems","totalWeight","slots","uFiles","uFile","id","maxPercentPerSlot","dictionaries","pluralSelectors","defaultLang","strictMode","langId","bool","dictionary","pluralSelector","_getDefaultPluralSelector","msgId","dict","msg","_error","number","pluralIndex","container","cssClass","onDrop","elDropZone","dataTransfer","effectAllowed","dropEffect","remove","contains","filesArray","timer","chunkSize","serverUrl","onChunkLoaded","isLastChunk","onChunkAborted","onChunkResponseReceived","_xhr","controller","AbortController","_is_aborted","_chunkFailed","abort","file","$this","setTimeout","s","_slice","_send","piece","userData","_sendViaFetch","mozSlice","webkitSlice","_noop","bind","_resolve","_reject","signal","catch","clone","setImmediate","args","ticky","apply","opts","evt","on","once","_once","off","et","emit","atoa","emitterSnapshot","throws","debounce","NativeCustomEvent","CustomEvent","foo","useNative","bubbles","cancelable","createEventObject","Boolean","eventmap","eventname","ron","test","addEvent","el","capturing","removeEvent","hardCache","attachEvent","wrapper","unwrap","originalEvent","srcElement","returnValue","cancelBubble","which","keyCode","wrapperFactory","wrap","listener","detachEvent","fabricate","model","customEvent","initEvent","makeClassicEvent","fireEvent","find","cache","lookupClass","className","cached","lastIndex","current","rm","documentElement","touchy","op","navigator","pointerEnabled","crossvent","mouseup","mousedown","mousemove","msPointerEnabled","whichMouseButton","touches","buttons","button","getOffset","rect","getBoundingClientRect","left","getScroll","top","scrollProp","offsetProp","clientHeight","getElementBehindPoint","point","state","elementFromPoint","never","always","getRectWidth","width","right","getRectHeight","height","bottom","getParent","isInput","tagName","isEditable","contentEditable","nextEl","nextElementSibling","sibling","nextSibling","nodeType","manually","getCoord","coord","host","targetTouches","changedTouches","getEventHost","missMap","pageX","pageY","initialContainers","_mirror","_source","_item","_offsetX","_offsetY","_moveX","_moveY","_initialSibling","_currentSibling","_copy","_renderTimer","len","_grabbed","_lastDropTarget","moves","accepts","invalid","invalidTarget","containers","isContainer","copy","copySortSource","revertOnSpill","removeOnSpill","ignoreInputTextSelection","mirrorContainer","drake","emitter","manualStart","cancel","canMove","dragging","spillOver","spillOut","grab","release","eventualMovements","startBecauseMouseMoved","movements","preventGrabbed","clientX","clientY","metaKey","ctrlKey","canStart","focus","grabbed","classes","renderMirrorImage","drag","handle","source","isCopy","cloneNode","drop","ungrab","dropTarget","findDropTarget","parent","isInitialPlacement","cleanup","revert","reverts","initial","removeMirrorImage","clearTimeout","elementBehindCursor","accepted","immediate","getImmediateChild","reference","getReference","changed","moved","horizontal","inside","outside","after","fade","linear","getComputedStyle","opacity","subscriber_queue","draggable","_options","startClick","onStartDragBefore","isDragging","handleMousedown","btn","includes","handleMousemove","handleMouseup","dx","dy","slot_ctx","action_result","handleDragEnd","lets","merged","styleId","elStyle","getElementById","maxTop","maxRight","maxBottom","maxLeft","coords","stop","subscribers","new_value","run_queue","invalidate","subscriber","writable","createEventDispatcher","draggableOptions","modalOptions","dragHandle","closest","displayStyle","keepInViewport","$coords","newX","newY","elHead","getElementsByTagName","innerHTML","firstChild","innerWidth","innerHeight","module","_typeof","Symbol","iterator","_classCallCheck","Constructor","TypeError","_defineProperties","descriptor","enumerable","configurable","defineProperty","_defineProperty","ownKeys","enumerableOnly","getOwnPropertySymbols","symbols","sym","getOwnPropertyDescriptor","_objectSpread2","getOwnPropertyDescriptors","defineProperties","_toConsumableArray","arr2","_arrayWithoutHoles","iter","_iterableToArray","_nonIterableSpread","IS_BROWSER","WINDOW","IS_TOUCH_DEVICE","HAS_POINTER_EVENT","CLASS_CROP","concat","CLASS_DISABLED","CLASS_HIDDEN","CLASS_HIDE","CLASS_INVISIBLE","CLASS_MODAL","CLASS_MOVE","DATA_ACTION","DATA_PREVIEW","EVENT_TOUCH_START","EVENT_TOUCH_MOVE","EVENT_TOUCH_END","EVENT_POINTER_DOWN","EVENT_POINTER_MOVE","EVENT_POINTER_UP","REGEXP_ACTIONS","REGEXP_DATA_URL","REGEXP_DATA_URL_JPEG","REGEXP_TAG_NAME","DEFAULTS","viewMode","dragMode","initialAspectRatio","NaN","aspectRatio","preview","responsive","restore","checkCrossOrigin","checkOrientation","modal","guides","center","highlight","background","autoCrop","autoCropArea","movable","rotatable","scalable","zoomable","zoomOnTouch","zoomOnWheel","wheelZoomRatio","cropBoxMovable","cropBoxResizable","toggleDragModeOnDblclick","minCanvasWidth","minCanvasHeight","minCropBoxWidth","minCropBoxHeight","minContainerWidth","minContainerHeight","cropstart","cropmove","cropend","crop","zoom","Number","isNumber","isPositiveNumber","Infinity","isUndefined","isObject","_constructor","toArray","_len","_key","arg","REGEXP_DECIMALS","normalizeDecimalNumber","times","REGEXP_SUFFIX","setStyle","styles","property","addClass","elem","removeClass","toggleClass","added","REGEXP_CAMEL_CASE","toParamCase","toLowerCase","getData","dataset","setData","REGEXP_SPACES","onceSupported","supported","removeListener","listeners","addListener","_handler","_element$listeners","_len2","_key2","Event","box","pageXOffset","clientLeft","pageYOffset","clientTop","location","REGEXP_ORIGINS","isCrossOriginURL","protocol","hostname","port","addTimestamp","timestamp","getTime","getTransforms","_ref","rotate","scaleX","scaleY","translateX","translateY","transform","WebkitTransform","msTransform","getPointer","_ref2","endOnly","endX","endY","startX","startY","getAdjustedSizes","_ref4","isValidWidth","isValidHeight","adjustedWidth","getSourceCanvas","image","_ref6","_ref7","_ref8","imageAspectRatio","imageNaturalWidth","naturalWidth","imageNaturalHeight","naturalHeight","_ref6$rotate","_ref6$scaleX","_ref6$scaleY","_ref8$fillColor","fillColor","_ref8$imageSmoothingE","imageSmoothingEnabled","_ref8$imageSmoothingQ","imageSmoothingQuality","_ref8$maxWidth","maxWidth","_ref8$maxHeight","maxHeight","_ref8$minWidth","minWidth","_ref8$minHeight","minHeight","canvas","getContext","maxSizes","minSizes","destMaxSizes","destMinSizes","destWidth","destHeight","fillStyle","fillRect","save","translate","PI","scale","drawImage","param","fromCharCode","REGEXP_DATA_URL_HEAD","resetAndGetOrientation","orientation","dataView","littleEndian","app1Start","ifdStart","tiffOffset","getStringFromCharCode","endianness","getUint16","firstIFDOffset","getUint32","_offset","_length","setUint16","render","initContainer","initCanvas","initCropBox","renderCanvas","cropped","renderCropBox","cropper","containerData","offsetWidth","offsetHeight","imageData","rotated","canvasWidth","canvasHeight","canvasData","oldLeft","oldTop","limited","limitCanvas","initialImageData","initialCanvasData","sizeLimited","positionLimited","cropBoxData","_getAdjustedSizes","newCanvasLeft","newCanvasTop","minLeft","minTop","transformed","_getRotatedSizes","_ref5","degree","arc","sinArc","sin","cosArc","cos","newWidth","newHeight","getRotatedSizes","renderImage","limitCropBox","output","initialCropBoxData","maxCropBoxWidth","maxCropBoxHeight","face","cropBox","disabled","initPreview","crossOrigin","crossOriginUrl","alt","viewBox","viewBoxImage","previews","querySelectorAll","querySelector","img","html","cssText","resetPreview","removeData","cropBoxWidth","cropBoxHeight","originalWidth","originalHeight","ratio","onCropStart","cropStart","onWheel","wheel","passive","capture","onDblclick","dblclick","onCropMove","cropMove","onCropEnd","cropEnd","onResize","resize","unbind","handlers","getCanvasData","getCropBoxData","setCanvasData","setCropBoxData","setDragMode","hasClass","dragBox","_this","delta","wheeling","deltaY","wheelDelta","pointerType","action","pointers","touch","identifier","pointerId","cropping","change","renderable","shiftKey","pointer","range","check","side","move","pointers2","ratios","pointer2","x1","y1","x2","y2","z1","sqrt","sort","getMaxZoomRatio","methods","reset","hasSameSize","isImg","replaced","uncreate","load","enable","disable","originalUrl","offsetX","offsetY","_this$canvasData","moveTo","_originalEvent","zoomTo","pivot","oldRatio","count","_ref3","getPointersCenter","rotateTo","_scaleX","_scaleY","rounded","getContainerData","getImageData","sized","widthChanged","heightChanged","getCroppedCanvas","HTMLCanvasElement","_this$getData","initialX","initialY","initialWidth","initialHeight","_options$imageSmoothi","srcWidth","srcHeight","dstX","dstY","dstWidth","dstHeight","sourceWidth","sourceHeight","srcX","srcY","setAspectRatio","mode","croppable","AnotherCropper","Cropper","reloading","sizing","protoProps","staticProps","toDataURL","ArrayBuffer","read","base64","binary","uint8","xhr","onabort","onerror","ontimeout","onprogress","getResponseHeader","onload","onloadend","responseType","withCredentials","chunks","subarray","btoa","arrayBufferToDataURL","_parseOrientation","parseOrientation","_this2","isIOSWebKit","userAgent","done","build","sizingImage","template","getElementsByClassName","unbuild","factory","removeError","directory","useKeepOriginalImage","original_url","is_loading","progress","useDirectory","directoryCanBeUpdated","usePrivacy","is_private","useTags","useImageEditor","fileExtensionCanBeUpdated","isOpen","title","errors","useOriginalImageChecked","stateCpt","onCloseFileEditorBtnClicked","onFileEditorFileDropped","onFileEditorUpdated","fileEditorOptions","feo","styleBtnCancel","styleBtnUpdate","useBootstrap","jDialog","jSelect","cssIdCounter","isImage","initialCropData","originalBlob","pendingOriginalBlob","dropZoneHandler","destroyCropper","close","addError","jQuery","select2Options","availableTags","tag","_toSelect2Data","allowCustomTags","nbTagsAllowed","select2","jImageOriginal","theUrl","cropperImgRef","URL","createObjectURL","cropperOptions","$target","that","option","JSON","parse","message","secondOption","DropZoneHandler","dropzoneOverClass","hasBeenCropped","isPrivate","toBlob","getFileEditorBlob","getFileEditorData","dropped","original","checked","removeErrorItem","useFileEditor","useDelete","_n","immediateUpload","getCurrentOrder","child","attrName","lang","maxFile","urls","uploadItemName","errorMessage","isExternalUrl","useVirtualServer","fileEditor","hiddenAddFileBtn","elTextItemsContainer","elImageItemsContainer","uFileCounter","inputName","isMultipleInput","FileUploader","_langs","Translatee","setDefaultLang","addDictionary","validator","setTranslator","globalProgressTracker","chunkUploader","styleBtnAddFile","styleBtnStartUpload","styleBtnViewText","styleBtnViewImage","editedUFile","fileEditorIsOpen","globalPercent","abortBtnVisible","userErrors","fileEditorErrors","aIsVisible","bIsVisible","changeViewMode","createUFile","getNewFileId","is_user_data","keep_original","addUFile","updateUFile","curUFile","updateUFileBinaryData","__preserveOriginalUrl","uploadQueuedFiles","updatedEditedFile","_getUFileById","addFileEditorError","updateUFileByFileEditor","postedData","flags","fileHasChanged","newUFile","uploadFile","singleFile","refreshGlobalPercentText","filename","jsonResponse","callService","handleAddUpdateResponse","removeUFile","serverCheck","checkAcpResponse","loadUrl","lastModifiedDate","blobToFile","moreHeaders","panda","addServerError","addUserFiles","numFiles","applyFileRotation","addUserError","nbFilesToRemove","err","updateUFileOrder","ids","newUFiles","tmpUFiles","returnOriginalResponse","reason","resetUrls","isSuccessfulResponse","nbQueuedFiles","registerItems","fileId","useChunks","ChunkUploader","abortUpload","addProgress","getPercent","updateUFileProgress","sendByChunks","fileUrl","bk","openFileEditor","closeFileEditor","drakeImg","dragula","drakeText","dForm","totalSize","_uFiles","getTotalSize","getNbQueuedFiles","startUploadBtnEnabled","click","SomeComponent","hasLang","addLang"],"mappings":"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"}